(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))u(h);new MutationObserver(h=>{for(const d of h)if(d.type==="childList")for(const m of d.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&u(m)}).observe(document,{childList:!0,subtree:!0});function o(h){const d={};return h.integrity&&(d.integrity=h.integrity),h.referrerPolicy&&(d.referrerPolicy=h.referrerPolicy),h.crossOrigin==="use-credentials"?d.credentials="include":h.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function u(h){if(h.ep)return;h.ep=!0;const d=o(h);fetch(h.href,d)}})();function fr(i,r){const o=Object.create(null),u=i.split(",");for(let h=0;h<u.length;h++)o[u[h]]=!0;return r?h=>!!o[h.toLowerCase()]:h=>!!o[h]}const Me={},Di=[],lt=()=>{},Pl=()=>!1,wl=/^on[^a-z]/,Ss=i=>wl.test(i),mr=i=>i.startsWith("onUpdate:"),De=Object.assign,pr=(i,r)=>{const o=i.indexOf(r);o>-1&&i.splice(o,1)},vl=Object.prototype.hasOwnProperty,ge=(i,r)=>vl.call(i,r),se=Array.isArray,Oi=i=>Cs(i)==="[object Map]",Il=i=>Cs(i)==="[object Set]",oe=i=>typeof i=="function",Oe=i=>typeof i=="string",yr=i=>typeof i=="symbol",Ve=i=>i!==null&&typeof i=="object",Ya=i=>Ve(i)&&oe(i.then)&&oe(i.catch),Tl=Object.prototype.toString,Cs=i=>Tl.call(i),El=i=>Cs(i).slice(8,-1),Rl=i=>Cs(i)==="[object Object]",xr=i=>Oe(i)&&i!=="NaN"&&i[0]!=="-"&&""+parseInt(i,10)===i,cs=fr(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),bs=i=>{const r=Object.create(null);return o=>r[o]||(r[o]=i(o))},Fl=/-(\w)/g,fi=bs(i=>i.replace(Fl,(r,o)=>o?o.toUpperCase():"")),Vl=/\B([A-Z])/g,yi=bs(i=>i.replace(Vl,"-$1").toLowerCase()),Ga=bs(i=>i.charAt(0).toUpperCase()+i.slice(1)),Ws=bs(i=>i?`on${Ga(i)}`:""),fs=(i,r)=>!Object.is(i,r),$s=(i,r)=>{for(let o=0;o<i.length;o++)i[o](r)},ms=(i,r,o)=>{Object.defineProperty(i,r,{configurable:!0,enumerable:!1,value:o})},Al=i=>{const r=parseFloat(i);return isNaN(r)?i:r};let ma;const ir=()=>ma||(ma=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Sr(i){if(se(i)){const r={};for(let o=0;o<i.length;o++){const u=i[o],h=Oe(u)?kl(u):Sr(u);if(h)for(const d in h)r[d]=h[d]}return r}else{if(Oe(i))return i;if(Ve(i))return i}}const Ll=/;(?![^(]*\))/g,Dl=/:([^]+)/,Ol=/\/\*[^]*?\*\//g;function kl(i){const r={};return i.replace(Ol,"").split(Ll).forEach(o=>{if(o){const u=o.split(Dl);u.length>1&&(r[u[0].trim()]=u[1].trim())}}),r}function Cr(i){let r="";if(Oe(i))r=i;else if(se(i))for(let o=0;o<i.length;o++){const u=Cr(i[o]);u&&(r+=u+" ")}else if(Ve(i))for(const o in i)i[o]&&(r+=o+" ");return r.trim()}const Nl="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Ul=fr(Nl);function qa(i){return!!i||i===""}let at;class zl{constructor(r=!1){this.detached=r,this._active=!0,this.effects=[],this.cleanups=[],this.parent=at,!r&&at&&(this.index=(at.scopes||(at.scopes=[])).push(this)-1)}get active(){return this._active}run(r){if(this._active){const o=at;try{return at=this,r()}finally{at=o}}}on(){at=this}off(){at=this.parent}stop(r){if(this._active){let o,u;for(o=0,u=this.effects.length;o<u;o++)this.effects[o].stop();for(o=0,u=this.cleanups.length;o<u;o++)this.cleanups[o]();if(this.scopes)for(o=0,u=this.scopes.length;o<u;o++)this.scopes[o].stop(!0);if(!this.detached&&this.parent&&!r){const h=this.parent.scopes.pop();h&&h!==this&&(this.parent.scopes[this.index]=h,h.index=this.index)}this.parent=void 0,this._active=!1}}}function jl(i,r=at){r&&r.active&&r.effects.push(i)}function Xl(){return at}const br=i=>{const r=new Set(i);return r.w=0,r.n=0,r},Wa=i=>(i.w&Nt)>0,$a=i=>(i.n&Nt)>0,Hl=({deps:i})=>{if(i.length)for(let r=0;r<i.length;r++)i[r].w|=Nt},Yl=i=>{const{deps:r}=i;if(r.length){let o=0;for(let u=0;u<r.length;u++){const h=r[u];Wa(h)&&!$a(h)?h.delete(i):r[o++]=h,h.w&=~Nt,h.n&=~Nt}r.length=o}},sr=new WeakMap;let Ai=0,Nt=1;const rr=30;let ot;const Jt=Symbol(""),nr=Symbol("");class Br{constructor(r,o=null,u){this.fn=r,this.scheduler=o,this.active=!0,this.deps=[],this.parent=void 0,jl(this,u)}run(){if(!this.active)return this.fn();let r=ot,o=Ot;for(;r;){if(r===this)return;r=r.parent}try{return this.parent=ot,ot=this,Ot=!0,Nt=1<<++Ai,Ai<=rr?Hl(this):pa(this),this.fn()}finally{Ai<=rr&&Yl(this),Nt=1<<--Ai,ot=this.parent,Ot=o,this.parent=void 0,this.deferStop&&this.stop()}}stop(){ot===this?this.deferStop=!0:this.active&&(pa(this),this.onStop&&this.onStop(),this.active=!1)}}function pa(i){const{deps:r}=i;if(r.length){for(let o=0;o<r.length;o++)r[o].delete(i);r.length=0}}let Ot=!0;const Ka=[];function xi(){Ka.push(Ot),Ot=!1}function Si(){const i=Ka.pop();Ot=i===void 0?!0:i}function We(i,r,o){if(Ot&&ot){let u=sr.get(i);u||sr.set(i,u=new Map);let h=u.get(o);h||u.set(o,h=br()),Ja(h)}}function Ja(i,r){let o=!1;Ai<=rr?$a(i)||(i.n|=Nt,o=!Wa(i)):o=!i.has(ot),o&&(i.add(ot),ot.deps.push(i))}function vt(i,r,o,u,h,d){const m=sr.get(i);if(!m)return;let C=[];if(r==="clear")C=[...m.values()];else if(o==="length"&&se(i)){const b=Number(u);m.forEach((S,R)=>{(R==="length"||R>=b)&&C.push(S)})}else switch(o!==void 0&&C.push(m.get(o)),r){case"add":se(i)?xr(o)&&C.push(m.get("length")):(C.push(m.get(Jt)),Oi(i)&&C.push(m.get(nr)));break;case"delete":se(i)||(C.push(m.get(Jt)),Oi(i)&&C.push(m.get(nr)));break;case"set":Oi(i)&&C.push(m.get(Jt));break}if(C.length===1)C[0]&&ar(C[0]);else{const b=[];for(const S of C)S&&b.push(...S);ar(br(b))}}function ar(i,r){const o=se(i)?i:[...i];for(const u of o)u.computed&&ya(u);for(const u of o)u.computed||ya(u)}function ya(i,r){(i!==ot||i.allowRecurse)&&(i.scheduler?i.scheduler():i.run())}const Gl=fr("__proto__,__v_isRef,__isVue"),Za=new Set(Object.getOwnPropertyNames(Symbol).filter(i=>i!=="arguments"&&i!=="caller").map(i=>Symbol[i]).filter(yr)),ql=Mr(),Wl=Mr(!1,!0),$l=Mr(!0),xa=Kl();function Kl(){const i={};return["includes","indexOf","lastIndexOf"].forEach(r=>{i[r]=function(...o){const u=xe(this);for(let d=0,m=this.length;d<m;d++)We(u,"get",d+"");const h=u[r](...o);return h===-1||h===!1?u[r](...o.map(xe)):h}}),["push","pop","shift","unshift","splice"].forEach(r=>{i[r]=function(...o){xi();const u=xe(this)[r].apply(this,o);return Si(),u}}),i}function Jl(i){const r=xe(this);return We(r,"has",i),r.hasOwnProperty(i)}function Mr(i=!1,r=!1){return function(u,h,d){if(h==="__v_isReactive")return!i;if(h==="__v_isReadonly")return i;if(h==="__v_isShallow")return r;if(h==="__v_raw"&&d===(i?r?gu:so:r?io:to).get(u))return u;const m=se(u);if(!i){if(m&&ge(xa,h))return Reflect.get(xa,h,d);if(h==="hasOwnProperty")return Jl}const C=Reflect.get(u,h,d);return(yr(h)?Za.has(h):Gl(h))||(i||We(u,"get",h),r)?C:ze(C)?m&&xr(h)?C:C.value:Ve(C)?i?ro(C):vr(C):C}}const Zl=Qa(),Ql=Qa(!0);function Qa(i=!1){return function(o,u,h,d){let m=o[u];if(Ni(m)&&ze(m)&&!ze(h))return!1;if(!i&&(!or(h)&&!Ni(h)&&(m=xe(m),h=xe(h)),!se(o)&&ze(m)&&!ze(h)))return m.value=h,!0;const C=se(o)&&xr(u)?Number(u)<o.length:ge(o,u),b=Reflect.set(o,u,h,d);return o===xe(d)&&(C?fs(h,m)&&vt(o,"set",u,h):vt(o,"add",u,h)),b}}function eu(i,r){const o=ge(i,r);i[r];const u=Reflect.deleteProperty(i,r);return u&&o&&vt(i,"delete",r,void 0),u}function tu(i,r){const o=Reflect.has(i,r);return(!yr(r)||!Za.has(r))&&We(i,"has",r),o}function iu(i){return We(i,"iterate",se(i)?"length":Jt),Reflect.ownKeys(i)}const eo={get:ql,set:Zl,deleteProperty:eu,has:tu,ownKeys:iu},su={get:$l,set(i,r){return!0},deleteProperty(i,r){return!0}},ru=De({},eo,{get:Wl,set:Ql}),Pr=i=>i,Bs=i=>Reflect.getPrototypeOf(i);function ns(i,r,o=!1,u=!1){i=i.__v_raw;const h=xe(i),d=xe(r);o||(r!==d&&We(h,"get",r),We(h,"get",d));const{has:m}=Bs(h),C=u?Pr:o?Er:Tr;if(m.call(h,r))return C(i.get(r));if(m.call(h,d))return C(i.get(d));i!==h&&i.get(r)}function as(i,r=!1){const o=this.__v_raw,u=xe(o),h=xe(i);return r||(i!==h&&We(u,"has",i),We(u,"has",h)),i===h?o.has(i):o.has(i)||o.has(h)}function os(i,r=!1){return i=i.__v_raw,!r&&We(xe(i),"iterate",Jt),Reflect.get(i,"size",i)}function Sa(i){i=xe(i);const r=xe(this);return Bs(r).has.call(r,i)||(r.add(i),vt(r,"add",i,i)),this}function Ca(i,r){r=xe(r);const o=xe(this),{has:u,get:h}=Bs(o);let d=u.call(o,i);d||(i=xe(i),d=u.call(o,i));const m=h.call(o,i);return o.set(i,r),d?fs(r,m)&&vt(o,"set",i,r):vt(o,"add",i,r),this}function ba(i){const r=xe(this),{has:o,get:u}=Bs(r);let h=o.call(r,i);h||(i=xe(i),h=o.call(r,i)),u&&u.call(r,i);const d=r.delete(i);return h&&vt(r,"delete",i,void 0),d}function Ba(){const i=xe(this),r=i.size!==0,o=i.clear();return r&&vt(i,"clear",void 0,void 0),o}function ls(i,r){return function(u,h){const d=this,m=d.__v_raw,C=xe(m),b=r?Pr:i?Er:Tr;return!i&&We(C,"iterate",Jt),m.forEach((S,R)=>u.call(h,b(S),b(R),d))}}function us(i,r,o){return function(...u){const h=this.__v_raw,d=xe(h),m=Oi(d),C=i==="entries"||i===Symbol.iterator&&m,b=i==="keys"&&m,S=h[i](...u),R=o?Pr:r?Er:Tr;return!r&&We(d,"iterate",b?nr:Jt),{next(){const{value:L,done:z}=S.next();return z?{value:L,done:z}:{value:C?[R(L[0]),R(L[1])]:R(L),done:z}},[Symbol.iterator](){return this}}}}function Lt(i){return function(...r){return i==="delete"?!1:this}}function nu(){const i={get(d){return ns(this,d)},get size(){return os(this)},has:as,add:Sa,set:Ca,delete:ba,clear:Ba,forEach:ls(!1,!1)},r={get(d){return ns(this,d,!1,!0)},get size(){return os(this)},has:as,add:Sa,set:Ca,delete:ba,clear:Ba,forEach:ls(!1,!0)},o={get(d){return ns(this,d,!0)},get size(){return os(this,!0)},has(d){return as.call(this,d,!0)},add:Lt("add"),set:Lt("set"),delete:Lt("delete"),clear:Lt("clear"),forEach:ls(!0,!1)},u={get(d){return ns(this,d,!0,!0)},get size(){return os(this,!0)},has(d){return as.call(this,d,!0)},add:Lt("add"),set:Lt("set"),delete:Lt("delete"),clear:Lt("clear"),forEach:ls(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(d=>{i[d]=us(d,!1,!1),o[d]=us(d,!0,!1),r[d]=us(d,!1,!0),u[d]=us(d,!0,!0)}),[i,o,r,u]}const[au,ou,lu,uu]=nu();function wr(i,r){const o=r?i?uu:lu:i?ou:au;return(u,h,d)=>h==="__v_isReactive"?!i:h==="__v_isReadonly"?i:h==="__v_raw"?u:Reflect.get(ge(o,h)&&h in u?o:u,h,d)}const hu={get:wr(!1,!1)},cu={get:wr(!1,!0)},du={get:wr(!0,!1)},to=new WeakMap,io=new WeakMap,so=new WeakMap,gu=new WeakMap;function _u(i){switch(i){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function fu(i){return i.__v_skip||!Object.isExtensible(i)?0:_u(El(i))}function vr(i){return Ni(i)?i:Ir(i,!1,eo,hu,to)}function mu(i){return Ir(i,!1,ru,cu,io)}function ro(i){return Ir(i,!0,su,du,so)}function Ir(i,r,o,u,h){if(!Ve(i)||i.__v_raw&&!(r&&i.__v_isReactive))return i;const d=h.get(i);if(d)return d;const m=fu(i);if(m===0)return i;const C=new Proxy(i,m===2?u:o);return h.set(i,C),C}function gi(i){return Ni(i)?gi(i.__v_raw):!!(i&&i.__v_isReactive)}function Ni(i){return!!(i&&i.__v_isReadonly)}function or(i){return!!(i&&i.__v_isShallow)}function no(i){return gi(i)||Ni(i)}function xe(i){const r=i&&i.__v_raw;return r?xe(r):i}function ao(i){return ms(i,"__v_skip",!0),i}const Tr=i=>Ve(i)?vr(i):i,Er=i=>Ve(i)?ro(i):i;function pu(i){Ot&&ot&&(i=xe(i),Ja(i.dep||(i.dep=br())))}function yu(i,r){i=xe(i);const o=i.dep;o&&ar(o)}function ze(i){return!!(i&&i.__v_isRef===!0)}function xu(i){return ze(i)?i.value:i}const Su={get:(i,r,o)=>xu(Reflect.get(i,r,o)),set:(i,r,o,u)=>{const h=i[r];return ze(h)&&!ze(o)?(h.value=o,!0):Reflect.set(i,r,o,u)}};function oo(i){return gi(i)?i:new Proxy(i,Su)}class Cu{constructor(r,o,u,h){this._setter=o,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this._dirty=!0,this.effect=new Br(r,()=>{this._dirty||(this._dirty=!0,yu(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!h,this.__v_isReadonly=u}get value(){const r=xe(this);return pu(r),(r._dirty||!r._cacheable)&&(r._dirty=!1,r._value=r.effect.run()),r._value}set value(r){this._setter(r)}}function bu(i,r,o=!1){let u,h;const d=oe(i);return d?(u=i,h=lt):(u=i.get,h=i.set),new Cu(u,h,d||!h,o)}function kt(i,r,o,u){let h;try{h=u?i(...u):i()}catch(d){Ms(d,r,o)}return h}function ut(i,r,o,u){if(oe(i)){const d=kt(i,r,o,u);return d&&Ya(d)&&d.catch(m=>{Ms(m,r,o)}),d}const h=[];for(let d=0;d<i.length;d++)h.push(ut(i[d],r,o,u));return h}function Ms(i,r,o,u=!0){const h=r?r.vnode:null;if(r){let d=r.parent;const m=r.proxy,C=o;for(;d;){const S=d.ec;if(S){for(let R=0;R<S.length;R++)if(S[R](i,m,C)===!1)return}d=d.parent}const b=r.appContext.config.errorHandler;if(b){kt(b,null,10,[i,m,C]);return}}Bu(i,o,h,u)}function Bu(i,r,o,u=!0){console.error(i)}let Ui=!1,lr=!1;const ke=[];let pt=0;const _i=[];let Pt=null,$t=0;const lo=Promise.resolve();let Rr=null;function Mu(i){const r=Rr||lo;return i?r.then(this?i.bind(this):i):r}function Pu(i){let r=pt+1,o=ke.length;for(;r<o;){const u=r+o>>>1;zi(ke[u])<i?r=u+1:o=u}return r}function Fr(i){(!ke.length||!ke.includes(i,Ui&&i.allowRecurse?pt+1:pt))&&(i.id==null?ke.push(i):ke.splice(Pu(i.id),0,i),uo())}function uo(){!Ui&&!lr&&(lr=!0,Rr=lo.then(co))}function wu(i){const r=ke.indexOf(i);r>pt&&ke.splice(r,1)}function vu(i){se(i)?_i.push(...i):(!Pt||!Pt.includes(i,i.allowRecurse?$t+1:$t))&&_i.push(i),uo()}function Ma(i,r=Ui?pt+1:0){for(;r<ke.length;r++){const o=ke[r];o&&o.pre&&(ke.splice(r,1),r--,o())}}function ho(i){if(_i.length){const r=[...new Set(_i)];if(_i.length=0,Pt){Pt.push(...r);return}for(Pt=r,Pt.sort((o,u)=>zi(o)-zi(u)),$t=0;$t<Pt.length;$t++)Pt[$t]();Pt=null,$t=0}}const zi=i=>i.id==null?1/0:i.id,Iu=(i,r)=>{const o=zi(i)-zi(r);if(o===0){if(i.pre&&!r.pre)return-1;if(r.pre&&!i.pre)return 1}return o};function co(i){lr=!1,Ui=!0,ke.sort(Iu);const r=lt;try{for(pt=0;pt<ke.length;pt++){const o=ke[pt];o&&o.active!==!1&&kt(o,null,14)}}finally{pt=0,ke.length=0,ho(),Ui=!1,Rr=null,(ke.length||_i.length)&&co()}}function Tu(i,r,...o){if(i.isUnmounted)return;const u=i.vnode.props||Me;let h=o;const d=r.startsWith("update:"),m=d&&r.slice(7);if(m&&m in u){const R=`${m==="modelValue"?"model":m}Modifiers`,{number:L,trim:z}=u[R]||Me;z&&(h=o.map(te=>Oe(te)?te.trim():te)),L&&(h=o.map(Al))}let C,b=u[C=Ws(r)]||u[C=Ws(fi(r))];!b&&d&&(b=u[C=Ws(yi(r))]),b&&ut(b,i,6,h);const S=u[C+"Once"];if(S){if(!i.emitted)i.emitted={};else if(i.emitted[C])return;i.emitted[C]=!0,ut(S,i,6,h)}}function go(i,r,o=!1){const u=r.emitsCache,h=u.get(i);if(h!==void 0)return h;const d=i.emits;let m={},C=!1;if(!oe(i)){const b=S=>{const R=go(S,r,!0);R&&(C=!0,De(m,R))};!o&&r.mixins.length&&r.mixins.forEach(b),i.extends&&b(i.extends),i.mixins&&i.mixins.forEach(b)}return!d&&!C?(Ve(i)&&u.set(i,null),null):(se(d)?d.forEach(b=>m[b]=null):De(m,d),Ve(i)&&u.set(i,m),m)}function Ps(i,r){return!i||!Ss(r)?!1:(r=r.slice(2).replace(/Once$/,""),ge(i,r[0].toLowerCase()+r.slice(1))||ge(i,yi(r))||ge(i,r))}let yt=null,_o=null;function ps(i){const r=yt;return yt=i,_o=i&&i.type.__scopeId||null,r}function Eu(i,r=yt,o){if(!r||i._n)return i;const u=(...h)=>{u._d&&Aa(-1);const d=ps(r);let m;try{m=i(...h)}finally{ps(d),u._d&&Aa(1)}return m};return u._n=!0,u._c=!0,u._d=!0,u}function Ks(i){const{type:r,vnode:o,proxy:u,withProxy:h,props:d,propsOptions:[m],slots:C,attrs:b,emit:S,render:R,renderCache:L,data:z,setupState:te,ctx:ie,inheritAttrs:ne}=i;let ce,Ie;const Se=ps(i);try{if(o.shapeFlag&4){const K=h||u;ce=mt(R.call(K,K,L,d,te,z,ie)),Ie=b}else{const K=r;ce=mt(K.length>1?K(d,{attrs:b,slots:C,emit:S}):K(d,null)),Ie=r.props?b:Ru(b)}}catch(K){Ms(K,i,1),ce=Zt(ji)}let we=ce;if(Ie&&ne!==!1){const K=Object.keys(Ie),{shapeFlag:Ae}=we;K.length&&Ae&7&&(m&&K.some(mr)&&(Ie=Fu(Ie,m)),we=mi(we,Ie))}return o.dirs&&(we=mi(we),we.dirs=we.dirs?we.dirs.concat(o.dirs):o.dirs),o.transition&&(we.transition=o.transition),ce=we,ps(Se),ce}const Ru=i=>{let r;for(const o in i)(o==="class"||o==="style"||Ss(o))&&((r||(r={}))[o]=i[o]);return r},Fu=(i,r)=>{const o={};for(const u in i)(!mr(u)||!(u.slice(9)in r))&&(o[u]=i[u]);return o};function Vu(i,r,o){const{props:u,children:h,component:d}=i,{props:m,children:C,patchFlag:b}=r,S=d.emitsOptions;if(r.dirs||r.transition)return!0;if(o&&b>=0){if(b&1024)return!0;if(b&16)return u?Pa(u,m,S):!!m;if(b&8){const R=r.dynamicProps;for(let L=0;L<R.length;L++){const z=R[L];if(m[z]!==u[z]&&!Ps(S,z))return!0}}}else return(h||C)&&(!C||!C.$stable)?!0:u===m?!1:u?m?Pa(u,m,S):!0:!!m;return!1}function Pa(i,r,o){const u=Object.keys(r);if(u.length!==Object.keys(i).length)return!0;for(let h=0;h<u.length;h++){const d=u[h];if(r[d]!==i[d]&&!Ps(o,d))return!0}return!1}function Au({vnode:i,parent:r},o){for(;r&&r.subTree===i;)(i=r.vnode).el=o,r=r.parent}const Lu=i=>i.__isSuspense;function Du(i,r){r&&r.pendingBranch?se(i)?r.effects.push(...i):r.effects.push(i):vu(i)}const hs={};function Js(i,r,o){return fo(i,r,o)}function fo(i,r,{immediate:o,deep:u,flush:h,onTrack:d,onTrigger:m}=Me){var C;const b=Xl()===((C=Ne)==null?void 0:C.scope)?Ne:null;let S,R=!1,L=!1;if(ze(i)?(S=()=>i.value,R=or(i)):gi(i)?(S=()=>i,u=!0):se(i)?(L=!0,R=i.some(K=>gi(K)||or(K)),S=()=>i.map(K=>{if(ze(K))return K.value;if(gi(K))return ci(K);if(oe(K))return kt(K,b,2)})):oe(i)?r?S=()=>kt(i,b,2):S=()=>{if(!(b&&b.isUnmounted))return z&&z(),ut(i,b,3,[te])}:S=lt,r&&u){const K=S;S=()=>ci(K())}let z,te=K=>{z=Se.onStop=()=>{kt(K,b,4)}},ie;if(Xi)if(te=lt,r?o&&ut(r,b,3,[S(),L?[]:void 0,te]):S(),h==="sync"){const K=Eh();ie=K.__watcherHandles||(K.__watcherHandles=[])}else return lt;let ne=L?new Array(i.length).fill(hs):hs;const ce=()=>{if(Se.active)if(r){const K=Se.run();(u||R||(L?K.some((Ae,Te)=>fs(Ae,ne[Te])):fs(K,ne)))&&(z&&z(),ut(r,b,3,[K,ne===hs?void 0:L&&ne[0]===hs?[]:ne,te]),ne=K)}else Se.run()};ce.allowRecurse=!!r;let Ie;h==="sync"?Ie=ce:h==="post"?Ie=()=>qe(ce,b&&b.suspense):(ce.pre=!0,b&&(ce.id=b.uid),Ie=()=>Fr(ce));const Se=new Br(S,Ie);r?o?ce():ne=Se.run():h==="post"?qe(Se.run.bind(Se),b&&b.suspense):Se.run();const we=()=>{Se.stop(),b&&b.scope&&pr(b.scope.effects,Se)};return ie&&ie.push(we),we}function Ou(i,r,o){const u=this.proxy,h=Oe(i)?i.includes(".")?mo(u,i):()=>u[i]:i.bind(u,u);let d;oe(r)?d=r:(d=r.handler,o=r);const m=Ne;pi(this);const C=fo(h,d.bind(u),o);return m?pi(m):Qt(),C}function mo(i,r){const o=r.split(".");return()=>{let u=i;for(let h=0;h<o.length&&u;h++)u=u[o[h]];return u}}function ci(i,r){if(!Ve(i)||i.__v_skip||(r=r||new Set,r.has(i)))return i;if(r.add(i),ze(i))ci(i.value,r);else if(se(i))for(let o=0;o<i.length;o++)ci(i[o],r);else if(Il(i)||Oi(i))i.forEach(o=>{ci(o,r)});else if(Rl(i))for(const o in i)ci(i[o],r);return i}function qt(i,r,o,u){const h=i.dirs,d=r&&r.dirs;for(let m=0;m<h.length;m++){const C=h[m];d&&(C.oldValue=d[m].value);let b=C.dir[u];b&&(xi(),ut(b,o,8,[i.el,C,i,r]),Si())}}const ds=i=>!!i.type.__asyncLoader,po=i=>i.type.__isKeepAlive;function ku(i,r){yo(i,"a",r)}function Nu(i,r){yo(i,"da",r)}function yo(i,r,o=Ne){const u=i.__wdc||(i.__wdc=()=>{let h=o;for(;h;){if(h.isDeactivated)return;h=h.parent}return i()});if(ws(r,u,o),o){let h=o.parent;for(;h&&h.parent;)po(h.parent.vnode)&&Uu(u,r,o,h),h=h.parent}}function Uu(i,r,o,u){const h=ws(r,i,u,!0);So(()=>{pr(u[r],h)},o)}function ws(i,r,o=Ne,u=!1){if(o){const h=o[i]||(o[i]=[]),d=r.__weh||(r.__weh=(...m)=>{if(o.isUnmounted)return;xi(),pi(o);const C=ut(r,o,i,m);return Qt(),Si(),C});return u?h.unshift(d):h.push(d),d}}const It=i=>(r,o=Ne)=>(!Xi||i==="sp")&&ws(i,(...u)=>r(...u),o),zu=It("bm"),xo=It("m"),ju=It("bu"),Xu=It("u"),Hu=It("bum"),So=It("um"),Yu=It("sp"),Gu=It("rtg"),qu=It("rtc");function Wu(i,r=Ne){ws("ec",i,r)}const $u=Symbol.for("v-ndc"),ur=i=>i?Eo(i)?kr(i)||i.proxy:ur(i.parent):null,ki=De(Object.create(null),{$:i=>i,$el:i=>i.vnode.el,$data:i=>i.data,$props:i=>i.props,$attrs:i=>i.attrs,$slots:i=>i.slots,$refs:i=>i.refs,$parent:i=>ur(i.parent),$root:i=>ur(i.root),$emit:i=>i.emit,$options:i=>Vr(i),$forceUpdate:i=>i.f||(i.f=()=>Fr(i.update)),$nextTick:i=>i.n||(i.n=Mu.bind(i.proxy)),$watch:i=>Ou.bind(i)}),Zs=(i,r)=>i!==Me&&!i.__isScriptSetup&&ge(i,r),Ku={get({_:i},r){const{ctx:o,setupState:u,data:h,props:d,accessCache:m,type:C,appContext:b}=i;let S;if(r[0]!=="$"){const te=m[r];if(te!==void 0)switch(te){case 1:return u[r];case 2:return h[r];case 4:return o[r];case 3:return d[r]}else{if(Zs(u,r))return m[r]=1,u[r];if(h!==Me&&ge(h,r))return m[r]=2,h[r];if((S=i.propsOptions[0])&&ge(S,r))return m[r]=3,d[r];if(o!==Me&&ge(o,r))return m[r]=4,o[r];hr&&(m[r]=0)}}const R=ki[r];let L,z;if(R)return r==="$attrs"&&We(i,"get",r),R(i);if((L=C.__cssModules)&&(L=L[r]))return L;if(o!==Me&&ge(o,r))return m[r]=4,o[r];if(z=b.config.globalProperties,ge(z,r))return z[r]},set({_:i},r,o){const{data:u,setupState:h,ctx:d}=i;return Zs(h,r)?(h[r]=o,!0):u!==Me&&ge(u,r)?(u[r]=o,!0):ge(i.props,r)||r[0]==="$"&&r.slice(1)in i?!1:(d[r]=o,!0)},has({_:{data:i,setupState:r,accessCache:o,ctx:u,appContext:h,propsOptions:d}},m){let C;return!!o[m]||i!==Me&&ge(i,m)||Zs(r,m)||(C=d[0])&&ge(C,m)||ge(u,m)||ge(ki,m)||ge(h.config.globalProperties,m)},defineProperty(i,r,o){return o.get!=null?i._.accessCache[r]=0:ge(o,"value")&&this.set(i,r,o.value,null),Reflect.defineProperty(i,r,o)}};function wa(i){return se(i)?i.reduce((r,o)=>(r[o]=null,r),{}):i}let hr=!0;function Ju(i){const r=Vr(i),o=i.proxy,u=i.ctx;hr=!1,r.beforeCreate&&va(r.beforeCreate,i,"bc");const{data:h,computed:d,methods:m,watch:C,provide:b,inject:S,created:R,beforeMount:L,mounted:z,beforeUpdate:te,updated:ie,activated:ne,deactivated:ce,beforeDestroy:Ie,beforeUnmount:Se,destroyed:we,unmounted:K,render:Ae,renderTracked:Te,renderTriggered:Ut,errorCaptured:ht,serverPrefetch:ei,expose:ct,inheritAttrs:Ee,components:Qe,directives:xt,filters:Tt}=r;if(S&&Zu(S,u,null),m)for(const Ce in m){const ae=m[Ce];oe(ae)&&(u[Ce]=ae.bind(o))}if(h){const Ce=h.call(o,o);Ve(Ce)&&(i.data=vr(Ce))}if(hr=!0,d)for(const Ce in d){const ae=d[Ce],je=oe(ae)?ae.bind(o,o):oe(ae.get)?ae.get.bind(o,o):lt,dt=!oe(ae)&&oe(ae.set)?ae.set.bind(o):lt,Xe=Ih({get:je,set:dt});Object.defineProperty(u,Ce,{enumerable:!0,configurable:!0,get:()=>Xe.value,set:He=>Xe.value=He})}if(C)for(const Ce in C)Co(C[Ce],u,o,Ce);if(b){const Ce=oe(b)?b.call(o):b;Reflect.ownKeys(Ce).forEach(ae=>{rh(ae,Ce[ae])})}R&&va(R,i,"c");function de(Ce,ae){se(ae)?ae.forEach(je=>Ce(je.bind(o))):ae&&Ce(ae.bind(o))}if(de(zu,L),de(xo,z),de(ju,te),de(Xu,ie),de(ku,ne),de(Nu,ce),de(Wu,ht),de(qu,Te),de(Gu,Ut),de(Hu,Se),de(So,K),de(Yu,ei),se(ct))if(ct.length){const Ce=i.exposed||(i.exposed={});ct.forEach(ae=>{Object.defineProperty(Ce,ae,{get:()=>o[ae],set:je=>o[ae]=je})})}else i.exposed||(i.exposed={});Ae&&i.render===lt&&(i.render=Ae),Ee!=null&&(i.inheritAttrs=Ee),Qe&&(i.components=Qe),xt&&(i.directives=xt)}function Zu(i,r,o=lt){se(i)&&(i=cr(i));for(const u in i){const h=i[u];let d;Ve(h)?"default"in h?d=gs(h.from||u,h.default,!0):d=gs(h.from||u):d=gs(h),ze(d)?Object.defineProperty(r,u,{enumerable:!0,configurable:!0,get:()=>d.value,set:m=>d.value=m}):r[u]=d}}function va(i,r,o){ut(se(i)?i.map(u=>u.bind(r.proxy)):i.bind(r.proxy),r,o)}function Co(i,r,o,u){const h=u.includes(".")?mo(o,u):()=>o[u];if(Oe(i)){const d=r[i];oe(d)&&Js(h,d)}else if(oe(i))Js(h,i.bind(o));else if(Ve(i))if(se(i))i.forEach(d=>Co(d,r,o,u));else{const d=oe(i.handler)?i.handler.bind(o):r[i.handler];oe(d)&&Js(h,d,i)}}function Vr(i){const r=i.type,{mixins:o,extends:u}=r,{mixins:h,optionsCache:d,config:{optionMergeStrategies:m}}=i.appContext,C=d.get(r);let b;return C?b=C:!h.length&&!o&&!u?b=r:(b={},h.length&&h.forEach(S=>ys(b,S,m,!0)),ys(b,r,m)),Ve(r)&&d.set(r,b),b}function ys(i,r,o,u=!1){const{mixins:h,extends:d}=r;d&&ys(i,d,o,!0),h&&h.forEach(m=>ys(i,m,o,!0));for(const m in r)if(!(u&&m==="expose")){const C=Qu[m]||o&&o[m];i[m]=C?C(i[m],r[m]):r[m]}return i}const Qu={data:Ia,props:Ta,emits:Ta,methods:Li,computed:Li,beforeCreate:Ue,created:Ue,beforeMount:Ue,mounted:Ue,beforeUpdate:Ue,updated:Ue,beforeDestroy:Ue,beforeUnmount:Ue,destroyed:Ue,unmounted:Ue,activated:Ue,deactivated:Ue,errorCaptured:Ue,serverPrefetch:Ue,components:Li,directives:Li,watch:th,provide:Ia,inject:eh};function Ia(i,r){return r?i?function(){return De(oe(i)?i.call(this,this):i,oe(r)?r.call(this,this):r)}:r:i}function eh(i,r){return Li(cr(i),cr(r))}function cr(i){if(se(i)){const r={};for(let o=0;o<i.length;o++)r[i[o]]=i[o];return r}return i}function Ue(i,r){return i?[...new Set([].concat(i,r))]:r}function Li(i,r){return i?De(Object.create(null),i,r):r}function Ta(i,r){return i?se(i)&&se(r)?[...new Set([...i,...r])]:De(Object.create(null),wa(i),wa(r??{})):r}function th(i,r){if(!i)return r;if(!r)return i;const o=De(Object.create(null),i);for(const u in r)o[u]=Ue(i[u],r[u]);return o}function bo(){return{app:null,config:{isNativeTag:Pl,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let ih=0;function sh(i,r){return function(u,h=null){oe(u)||(u=De({},u)),h!=null&&!Ve(h)&&(h=null);const d=bo(),m=new Set;let C=!1;const b=d.app={_uid:ih++,_component:u,_props:h,_container:null,_context:d,_instance:null,version:Rh,get config(){return d.config},set config(S){},use(S,...R){return m.has(S)||(S&&oe(S.install)?(m.add(S),S.install(b,...R)):oe(S)&&(m.add(S),S(b,...R))),b},mixin(S){return d.mixins.includes(S)||d.mixins.push(S),b},component(S,R){return R?(d.components[S]=R,b):d.components[S]},directive(S,R){return R?(d.directives[S]=R,b):d.directives[S]},mount(S,R,L){if(!C){const z=Zt(u,h);return z.appContext=d,R&&r?r(z,S):i(z,S,L),C=!0,b._container=S,S.__vue_app__=b,kr(z.component)||z.component.proxy}},unmount(){C&&(i(null,b._container),delete b._container.__vue_app__)},provide(S,R){return d.provides[S]=R,b},runWithContext(S){xs=b;try{return S()}finally{xs=null}}};return b}}let xs=null;function rh(i,r){if(Ne){let o=Ne.provides;const u=Ne.parent&&Ne.parent.provides;u===o&&(o=Ne.provides=Object.create(u)),o[i]=r}}function gs(i,r,o=!1){const u=Ne||yt;if(u||xs){const h=u?u.parent==null?u.vnode.appContext&&u.vnode.appContext.provides:u.parent.provides:xs._context.provides;if(h&&i in h)return h[i];if(arguments.length>1)return o&&oe(r)?r.call(u&&u.proxy):r}}function nh(i,r,o,u=!1){const h={},d={};ms(d,Is,1),i.propsDefaults=Object.create(null),Bo(i,r,h,d);for(const m in i.propsOptions[0])m in h||(h[m]=void 0);o?i.props=u?h:mu(h):i.type.props?i.props=h:i.props=d,i.attrs=d}function ah(i,r,o,u){const{props:h,attrs:d,vnode:{patchFlag:m}}=i,C=xe(h),[b]=i.propsOptions;let S=!1;if((u||m>0)&&!(m&16)){if(m&8){const R=i.vnode.dynamicProps;for(let L=0;L<R.length;L++){let z=R[L];if(Ps(i.emitsOptions,z))continue;const te=r[z];if(b)if(ge(d,z))te!==d[z]&&(d[z]=te,S=!0);else{const ie=fi(z);h[ie]=dr(b,C,ie,te,i,!1)}else te!==d[z]&&(d[z]=te,S=!0)}}}else{Bo(i,r,h,d)&&(S=!0);let R;for(const L in C)(!r||!ge(r,L)&&((R=yi(L))===L||!ge(r,R)))&&(b?o&&(o[L]!==void 0||o[R]!==void 0)&&(h[L]=dr(b,C,L,void 0,i,!0)):delete h[L]);if(d!==C)for(const L in d)(!r||!ge(r,L))&&(delete d[L],S=!0)}S&&vt(i,"set","$attrs")}function Bo(i,r,o,u){const[h,d]=i.propsOptions;let m=!1,C;if(r)for(let b in r){if(cs(b))continue;const S=r[b];let R;h&&ge(h,R=fi(b))?!d||!d.includes(R)?o[R]=S:(C||(C={}))[R]=S:Ps(i.emitsOptions,b)||(!(b in u)||S!==u[b])&&(u[b]=S,m=!0)}if(d){const b=xe(o),S=C||Me;for(let R=0;R<d.length;R++){const L=d[R];o[L]=dr(h,b,L,S[L],i,!ge(S,L))}}return m}function dr(i,r,o,u,h,d){const m=i[o];if(m!=null){const C=ge(m,"default");if(C&&u===void 0){const b=m.default;if(m.type!==Function&&!m.skipFactory&&oe(b)){const{propsDefaults:S}=h;o in S?u=S[o]:(pi(h),u=S[o]=b.call(null,r),Qt())}else u=b}m[0]&&(d&&!C?u=!1:m[1]&&(u===""||u===yi(o))&&(u=!0))}return u}function Mo(i,r,o=!1){const u=r.propsCache,h=u.get(i);if(h)return h;const d=i.props,m={},C=[];let b=!1;if(!oe(i)){const R=L=>{b=!0;const[z,te]=Mo(L,r,!0);De(m,z),te&&C.push(...te)};!o&&r.mixins.length&&r.mixins.forEach(R),i.extends&&R(i.extends),i.mixins&&i.mixins.forEach(R)}if(!d&&!b)return Ve(i)&&u.set(i,Di),Di;if(se(d))for(let R=0;R<d.length;R++){const L=fi(d[R]);Ea(L)&&(m[L]=Me)}else if(d)for(const R in d){const L=fi(R);if(Ea(L)){const z=d[R],te=m[L]=se(z)||oe(z)?{type:z}:De({},z);if(te){const ie=Va(Boolean,te.type),ne=Va(String,te.type);te[0]=ie>-1,te[1]=ne<0||ie<ne,(ie>-1||ge(te,"default"))&&C.push(L)}}}const S=[m,C];return Ve(i)&&u.set(i,S),S}function Ea(i){return i[0]!=="$"}function Ra(i){const r=i&&i.toString().match(/^\s*(function|class) (\w+)/);return r?r[2]:i===null?"null":""}function Fa(i,r){return Ra(i)===Ra(r)}function Va(i,r){return se(r)?r.findIndex(o=>Fa(o,i)):oe(r)&&Fa(r,i)?0:-1}const Po=i=>i[0]==="_"||i==="$stable",Ar=i=>se(i)?i.map(mt):[mt(i)],oh=(i,r,o)=>{if(r._n)return r;const u=Eu((...h)=>Ar(r(...h)),o);return u._c=!1,u},wo=(i,r,o)=>{const u=i._ctx;for(const h in i){if(Po(h))continue;const d=i[h];if(oe(d))r[h]=oh(h,d,u);else if(d!=null){const m=Ar(d);r[h]=()=>m}}},vo=(i,r)=>{const o=Ar(r);i.slots.default=()=>o},lh=(i,r)=>{if(i.vnode.shapeFlag&32){const o=r._;o?(i.slots=xe(r),ms(r,"_",o)):wo(r,i.slots={})}else i.slots={},r&&vo(i,r);ms(i.slots,Is,1)},uh=(i,r,o)=>{const{vnode:u,slots:h}=i;let d=!0,m=Me;if(u.shapeFlag&32){const C=r._;C?o&&C===1?d=!1:(De(h,r),!o&&C===1&&delete h._):(d=!r.$stable,wo(r,h)),m=r}else r&&(vo(i,r),m={default:1});if(d)for(const C in h)!Po(C)&&!(C in m)&&delete h[C]};function gr(i,r,o,u,h=!1){if(se(i)){i.forEach((z,te)=>gr(z,r&&(se(r)?r[te]:r),o,u,h));return}if(ds(u)&&!h)return;const d=u.shapeFlag&4?kr(u.component)||u.component.proxy:u.el,m=h?null:d,{i:C,r:b}=i,S=r&&r.r,R=C.refs===Me?C.refs={}:C.refs,L=C.setupState;if(S!=null&&S!==b&&(Oe(S)?(R[S]=null,ge(L,S)&&(L[S]=null)):ze(S)&&(S.value=null)),oe(b))kt(b,C,12,[m,R]);else{const z=Oe(b),te=ze(b);if(z||te){const ie=()=>{if(i.f){const ne=z?ge(L,b)?L[b]:R[b]:b.value;h?se(ne)&&pr(ne,d):se(ne)?ne.includes(d)||ne.push(d):z?(R[b]=[d],ge(L,b)&&(L[b]=R[b])):(b.value=[d],i.k&&(R[i.k]=b.value))}else z?(R[b]=m,ge(L,b)&&(L[b]=m)):te&&(b.value=m,i.k&&(R[i.k]=m))};m?(ie.id=-1,qe(ie,o)):ie()}}}const qe=Du;function hh(i){return ch(i)}function ch(i,r){const o=ir();o.__VUE__=!0;const{insert:u,remove:h,patchProp:d,createElement:m,createText:C,createComment:b,setText:S,setElementText:R,parentNode:L,nextSibling:z,setScopeId:te=lt,insertStaticContent:ie}=i,ne=(_,x,w,T=null,P=null,E=null,N=!1,V=null,A=!!x.dynamicChildren)=>{if(_===x)return;_&&!Vi(_,x)&&(T=nt(_),He(_,P,E,!0),_=null),x.patchFlag===-2&&(A=!1,x.dynamicChildren=null);const{type:F,ref:X,shapeFlag:j}=x;switch(F){case vs:ce(_,x,w,T);break;case ji:Ie(_,x,w,T);break;case Qs:_==null&&Se(x,w,T,N);break;case wt:Qe(_,x,w,T,P,E,N,V,A);break;default:j&1?Ae(_,x,w,T,P,E,N,V,A):j&6?xt(_,x,w,T,P,E,N,V,A):(j&64||j&128)&&F.process(_,x,w,T,P,E,N,V,A,et)}X!=null&&P&&gr(X,_&&_.ref,E,x||_,!x)},ce=(_,x,w,T)=>{if(_==null)u(x.el=C(x.children),w,T);else{const P=x.el=_.el;x.children!==_.children&&S(P,x.children)}},Ie=(_,x,w,T)=>{_==null?u(x.el=b(x.children||""),w,T):x.el=_.el},Se=(_,x,w,T)=>{[_.el,_.anchor]=ie(_.children,x,w,T,_.el,_.anchor)},we=({el:_,anchor:x},w,T)=>{let P;for(;_&&_!==x;)P=z(_),u(_,w,T),_=P;u(x,w,T)},K=({el:_,anchor:x})=>{let w;for(;_&&_!==x;)w=z(_),h(_),_=w;h(x)},Ae=(_,x,w,T,P,E,N,V,A)=>{N=N||x.type==="svg",_==null?Te(x,w,T,P,E,N,V,A):ei(_,x,P,E,N,V,A)},Te=(_,x,w,T,P,E,N,V)=>{let A,F;const{type:X,props:j,shapeFlag:Y,transition:$,dirs:re}=_;if(A=_.el=m(_.type,E,j&&j.is,j),Y&8?R(A,_.children):Y&16&&ht(_.children,A,null,T,P,E&&X!=="foreignObject",N,V),re&&qt(_,null,T,"created"),Ut(A,_,_.scopeId,N,T),j){for(const Z in j)Z!=="value"&&!cs(Z)&&d(A,Z,null,j[Z],E,_.children,T,P,Re);"value"in j&&d(A,"value",null,j.value),(F=j.onVnodeBeforeMount)&&ft(F,T,_)}re&&qt(_,null,T,"beforeMount");const fe=(!P||P&&!P.pendingBranch)&&$&&!$.persisted;fe&&$.beforeEnter(A),u(A,x,w),((F=j&&j.onVnodeMounted)||fe||re)&&qe(()=>{F&&ft(F,T,_),fe&&$.enter(A),re&&qt(_,null,T,"mounted")},P)},Ut=(_,x,w,T,P)=>{if(w&&te(_,w),T)for(let E=0;E<T.length;E++)te(_,T[E]);if(P){let E=P.subTree;if(x===E){const N=P.vnode;Ut(_,N,N.scopeId,N.slotScopeIds,P.parent)}}},ht=(_,x,w,T,P,E,N,V,A=0)=>{for(let F=A;F<_.length;F++){const X=_[F]=V?Dt(_[F]):mt(_[F]);ne(null,X,x,w,T,P,E,N,V)}},ei=(_,x,w,T,P,E,N)=>{const V=x.el=_.el;let{patchFlag:A,dynamicChildren:F,dirs:X}=x;A|=_.patchFlag&16;const j=_.props||Me,Y=x.props||Me;let $;w&&Wt(w,!1),($=Y.onVnodeBeforeUpdate)&&ft($,w,x,_),X&&qt(x,_,w,"beforeUpdate"),w&&Wt(w,!0);const re=P&&x.type!=="foreignObject";if(F?ct(_.dynamicChildren,F,V,w,T,re,E):N||ae(_,x,V,null,w,T,re,E,!1),A>0){if(A&16)Ee(V,x,j,Y,w,T,P);else if(A&2&&j.class!==Y.class&&d(V,"class",null,Y.class,P),A&4&&d(V,"style",j.style,Y.style,P),A&8){const fe=x.dynamicProps;for(let Z=0;Z<fe.length;Z++){const Be=fe[Z],Ye=j[Be],Et=Y[Be];(Et!==Ye||Be==="value")&&d(V,Be,Ye,Et,P,_.children,w,T,Re)}}A&1&&_.children!==x.children&&R(V,x.children)}else!N&&F==null&&Ee(V,x,j,Y,w,T,P);(($=Y.onVnodeUpdated)||X)&&qe(()=>{$&&ft($,w,x,_),X&&qt(x,_,w,"updated")},T)},ct=(_,x,w,T,P,E,N)=>{for(let V=0;V<x.length;V++){const A=_[V],F=x[V],X=A.el&&(A.type===wt||!Vi(A,F)||A.shapeFlag&70)?L(A.el):w;ne(A,F,X,null,T,P,E,N,!0)}},Ee=(_,x,w,T,P,E,N)=>{if(w!==T){if(w!==Me)for(const V in w)!cs(V)&&!(V in T)&&d(_,V,w[V],null,N,x.children,P,E,Re);for(const V in T){if(cs(V))continue;const A=T[V],F=w[V];A!==F&&V!=="value"&&d(_,V,F,A,N,x.children,P,E,Re)}"value"in T&&d(_,"value",w.value,T.value)}},Qe=(_,x,w,T,P,E,N,V,A)=>{const F=x.el=_?_.el:C(""),X=x.anchor=_?_.anchor:C("");let{patchFlag:j,dynamicChildren:Y,slotScopeIds:$}=x;$&&(V=V?V.concat($):$),_==null?(u(F,w,T),u(X,w,T),ht(x.children,w,X,P,E,N,V,A)):j>0&&j&64&&Y&&_.dynamicChildren?(ct(_.dynamicChildren,Y,w,P,E,N,V),(x.key!=null||P&&x===P.subTree)&&Io(_,x,!0)):ae(_,x,w,X,P,E,N,V,A)},xt=(_,x,w,T,P,E,N,V,A)=>{x.slotScopeIds=V,_==null?x.shapeFlag&512?P.ctx.activate(x,w,T,N,A):Tt(x,w,T,P,E,N,A):ye(_,x,A)},Tt=(_,x,w,T,P,E,N)=>{const V=_.component=bh(_,T,P);if(po(_)&&(V.ctx.renderer=et),Bh(V),V.asyncDep){if(P&&P.registerDep(V,de),!_.el){const A=V.subTree=Zt(ji);Ie(null,A,x,w)}return}de(V,_,x,w,P,E,N)},ye=(_,x,w)=>{const T=x.component=_.component;if(Vu(_,x,w))if(T.asyncDep&&!T.asyncResolved){Ce(T,x,w);return}else T.next=x,wu(T.update),T.update();else x.el=_.el,T.vnode=x},de=(_,x,w,T,P,E,N)=>{const V=()=>{if(_.isMounted){let{next:X,bu:j,u:Y,parent:$,vnode:re}=_,fe=X,Z;Wt(_,!1),X?(X.el=re.el,Ce(_,X,N)):X=re,j&&$s(j),(Z=X.props&&X.props.onVnodeBeforeUpdate)&&ft(Z,$,X,re),Wt(_,!0);const Be=Ks(_),Ye=_.subTree;_.subTree=Be,ne(Ye,Be,L(Ye.el),nt(Ye),_,P,E),X.el=Be.el,fe===null&&Au(_,Be.el),Y&&qe(Y,P),(Z=X.props&&X.props.onVnodeUpdated)&&qe(()=>ft(Z,$,X,re),P)}else{let X;const{el:j,props:Y}=x,{bm:$,m:re,parent:fe}=_,Z=ds(x);if(Wt(_,!1),$&&$s($),!Z&&(X=Y&&Y.onVnodeBeforeMount)&&ft(X,fe,x),Wt(_,!0),j&&Ci){const Be=()=>{_.subTree=Ks(_),Ci(j,_.subTree,_,P,null)};Z?x.type.__asyncLoader().then(()=>!_.isUnmounted&&Be()):Be()}else{const Be=_.subTree=Ks(_);ne(null,Be,w,T,_,P,E),x.el=Be.el}if(re&&qe(re,P),!Z&&(X=Y&&Y.onVnodeMounted)){const Be=x;qe(()=>ft(X,fe,Be),P)}(x.shapeFlag&256||fe&&ds(fe.vnode)&&fe.vnode.shapeFlag&256)&&_.a&&qe(_.a,P),_.isMounted=!0,x=w=T=null}},A=_.effect=new Br(V,()=>Fr(F),_.scope),F=_.update=()=>A.run();F.id=_.uid,Wt(_,!0),F()},Ce=(_,x,w)=>{x.component=_;const T=_.vnode.props;_.vnode=x,_.next=null,ah(_,x.props,T,w),uh(_,x.children,w),xi(),Ma(),Si()},ae=(_,x,w,T,P,E,N,V,A=!1)=>{const F=_&&_.children,X=_?_.shapeFlag:0,j=x.children,{patchFlag:Y,shapeFlag:$}=x;if(Y>0){if(Y&128){dt(F,j,w,T,P,E,N,V,A);return}else if(Y&256){je(F,j,w,T,P,E,N,V,A);return}}$&8?(X&16&&Re(F,P,E),j!==F&&R(w,j)):X&16?$&16?dt(F,j,w,T,P,E,N,V,A):Re(F,P,E,!0):(X&8&&R(w,""),$&16&&ht(j,w,T,P,E,N,V,A))},je=(_,x,w,T,P,E,N,V,A)=>{_=_||Di,x=x||Di;const F=_.length,X=x.length,j=Math.min(F,X);let Y;for(Y=0;Y<j;Y++){const $=x[Y]=A?Dt(x[Y]):mt(x[Y]);ne(_[Y],$,w,null,P,E,N,V,A)}F>X?Re(_,P,E,!0,!1,j):ht(x,w,T,P,E,N,V,A,j)},dt=(_,x,w,T,P,E,N,V,A)=>{let F=0;const X=x.length;let j=_.length-1,Y=X-1;for(;F<=j&&F<=Y;){const $=_[F],re=x[F]=A?Dt(x[F]):mt(x[F]);if(Vi($,re))ne($,re,w,null,P,E,N,V,A);else break;F++}for(;F<=j&&F<=Y;){const $=_[j],re=x[Y]=A?Dt(x[Y]):mt(x[Y]);if(Vi($,re))ne($,re,w,null,P,E,N,V,A);else break;j--,Y--}if(F>j){if(F<=Y){const $=Y+1,re=$<X?x[$].el:T;for(;F<=Y;)ne(null,x[F]=A?Dt(x[F]):mt(x[F]),w,re,P,E,N,V,A),F++}}else if(F>Y)for(;F<=j;)He(_[F],P,E,!0),F++;else{const $=F,re=F,fe=new Map;for(F=re;F<=Y;F++){const Fe=x[F]=A?Dt(x[F]):mt(x[F]);Fe.key!=null&&fe.set(Fe.key,F)}let Z,Be=0;const Ye=Y-re+1;let Et=!1,bi=0;const Rt=new Array(Ye);for(F=0;F<Ye;F++)Rt[F]=0;for(F=$;F<=j;F++){const Fe=_[F];if(Be>=Ye){He(Fe,P,E,!0);continue}let it;if(Fe.key!=null)it=fe.get(Fe.key);else for(Z=re;Z<=Y;Z++)if(Rt[Z-re]===0&&Vi(Fe,x[Z])){it=Z;break}it===void 0?He(Fe,P,E,!0):(Rt[it-re]=F+1,it>=bi?bi=it:Et=!0,ne(Fe,x[it],w,null,P,E,N,V,A),Be++)}const Yi=Et?dh(Rt):Di;for(Z=Yi.length-1,F=Ye-1;F>=0;F--){const Fe=re+F,it=x[Fe],$e=Fe+1<X?x[Fe+1].el:T;Rt[F]===0?ne(null,it,w,$e,P,E,N,V,A):Et&&(Z<0||F!==Yi[Z]?Xe(it,w,$e,2):Z--)}}},Xe=(_,x,w,T,P=null)=>{const{el:E,type:N,transition:V,children:A,shapeFlag:F}=_;if(F&6){Xe(_.component.subTree,x,w,T);return}if(F&128){_.suspense.move(x,w,T);return}if(F&64){N.move(_,x,w,et);return}if(N===wt){u(E,x,w);for(let j=0;j<A.length;j++)Xe(A[j],x,w,T);u(_.anchor,x,w);return}if(N===Qs){we(_,x,w);return}if(T!==2&&F&1&&V)if(T===0)V.beforeEnter(E),u(E,x,w),qe(()=>V.enter(E),P);else{const{leave:j,delayLeave:Y,afterLeave:$}=V,re=()=>u(E,x,w),fe=()=>{j(E,()=>{re(),$&&$()})};Y?Y(E,re,fe):fe()}else u(E,x,w)},He=(_,x,w,T=!1,P=!1)=>{const{type:E,props:N,ref:V,children:A,dynamicChildren:F,shapeFlag:X,patchFlag:j,dirs:Y}=_;if(V!=null&&gr(V,null,w,_,!0),X&256){x.ctx.deactivate(_);return}const $=X&1&&Y,re=!ds(_);let fe;if(re&&(fe=N&&N.onVnodeBeforeUnmount)&&ft(fe,x,_),X&6)Ts(_.component,w,T);else{if(X&128){_.suspense.unmount(w,T);return}$&&qt(_,null,x,"beforeUnmount"),X&64?_.type.remove(_,x,w,P,et,T):F&&(E!==wt||j>0&&j&64)?Re(F,x,w,!1,!0):(E===wt&&j&384||!P&&X&16)&&Re(A,x,w),T&&St(_)}(re&&(fe=N&&N.onVnodeUnmounted)||$)&&qe(()=>{fe&&ft(fe,x,_),$&&qt(_,null,x,"unmounted")},w)},St=_=>{const{type:x,el:w,anchor:T,transition:P}=_;if(x===wt){Hi(w,T);return}if(x===Qs){K(_);return}const E=()=>{h(w),P&&!P.persisted&&P.afterLeave&&P.afterLeave()};if(_.shapeFlag&1&&P&&!P.persisted){const{leave:N,delayLeave:V}=P,A=()=>N(w,E);V?V(_.el,E,A):A()}else E()},Hi=(_,x)=>{let w;for(;_!==x;)w=z(_),h(_),_=w;h(x)},Ts=(_,x,w)=>{const{bum:T,scope:P,update:E,subTree:N,um:V}=_;T&&$s(T),P.stop(),E&&(E.active=!1,He(N,_,x,w)),V&&qe(V,x),qe(()=>{_.isUnmounted=!0},x),x&&x.pendingBranch&&!x.isUnmounted&&_.asyncDep&&!_.asyncResolved&&_.suspenseId===x.pendingId&&(x.deps--,x.deps===0&&x.resolve())},Re=(_,x,w,T=!1,P=!1,E=0)=>{for(let N=E;N<_.length;N++)He(_[N],x,w,T,P)},nt=_=>_.shapeFlag&6?nt(_.component.subTree):_.shapeFlag&128?_.suspense.next():z(_.anchor||_.el),Ct=(_,x,w)=>{_==null?x._vnode&&He(x._vnode,null,null,!0):ne(x._vnode||null,_,x,null,null,null,w),Ma(),ho(),x._vnode=_},et={p:ne,um:He,m:Xe,r:St,mt:Tt,mc:ht,pc:ae,pbc:ct,n:nt,o:i};let tt,Ci;return r&&([tt,Ci]=r(et)),{render:Ct,hydrate:tt,createApp:sh(Ct,tt)}}function Wt({effect:i,update:r},o){i.allowRecurse=r.allowRecurse=o}function Io(i,r,o=!1){const u=i.children,h=r.children;if(se(u)&&se(h))for(let d=0;d<u.length;d++){const m=u[d];let C=h[d];C.shapeFlag&1&&!C.dynamicChildren&&((C.patchFlag<=0||C.patchFlag===32)&&(C=h[d]=Dt(h[d]),C.el=m.el),o||Io(m,C)),C.type===vs&&(C.el=m.el)}}function dh(i){const r=i.slice(),o=[0];let u,h,d,m,C;const b=i.length;for(u=0;u<b;u++){const S=i[u];if(S!==0){if(h=o[o.length-1],i[h]<S){r[u]=h,o.push(u);continue}for(d=0,m=o.length-1;d<m;)C=d+m>>1,i[o[C]]<S?d=C+1:m=C;S<i[o[d]]&&(d>0&&(r[u]=o[d-1]),o[d]=u)}}for(d=o.length,m=o[d-1];d-- >0;)o[d]=m,m=r[m];return o}const gh=i=>i.__isTeleport,wt=Symbol.for("v-fgt"),vs=Symbol.for("v-txt"),ji=Symbol.for("v-cmt"),Qs=Symbol.for("v-stc");let di=null,Lr=1;function Aa(i){Lr+=i}function _h(i){return i?i.__v_isVNode===!0:!1}function Vi(i,r){return i.type===r.type&&i.key===r.key}const Is="__vInternal",To=({key:i})=>i??null,_s=({ref:i,ref_key:r,ref_for:o})=>(typeof i=="number"&&(i=""+i),i!=null?Oe(i)||ze(i)||oe(i)?{i:yt,r:i,k:r,f:!!o}:i:null);function fh(i,r=null,o=null,u=0,h=null,d=i===wt?0:1,m=!1,C=!1){const b={__v_isVNode:!0,__v_skip:!0,type:i,props:r,key:r&&To(r),ref:r&&_s(r),scopeId:_o,slotScopeIds:null,children:o,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:d,patchFlag:u,dynamicProps:h,dynamicChildren:null,appContext:null,ctx:yt};return C?(Dr(b,o),d&128&&i.normalize(b)):o&&(b.shapeFlag|=Oe(o)?8:16),Lr>0&&!m&&di&&(b.patchFlag>0||d&6)&&b.patchFlag!==32&&di.push(b),b}const Zt=mh;function mh(i,r=null,o=null,u=0,h=null,d=!1){if((!i||i===$u)&&(i=ji),_h(i)){const C=mi(i,r,!0);return o&&Dr(C,o),Lr>0&&!d&&di&&(C.shapeFlag&6?di[di.indexOf(i)]=C:di.push(C)),C.patchFlag|=-2,C}if(vh(i)&&(i=i.__vccOpts),r){r=ph(r);let{class:C,style:b}=r;C&&!Oe(C)&&(r.class=Cr(C)),Ve(b)&&(no(b)&&!se(b)&&(b=De({},b)),r.style=Sr(b))}const m=Oe(i)?1:Lu(i)?128:gh(i)?64:Ve(i)?4:oe(i)?2:0;return fh(i,r,o,u,h,m,d,!0)}function ph(i){return i?no(i)||Is in i?De({},i):i:null}function mi(i,r,o=!1){const{props:u,ref:h,patchFlag:d,children:m}=i,C=r?xh(u||{},r):u;return{__v_isVNode:!0,__v_skip:!0,type:i.type,props:C,key:C&&To(C),ref:r&&r.ref?o&&h?se(h)?h.concat(_s(r)):[h,_s(r)]:_s(r):h,scopeId:i.scopeId,slotScopeIds:i.slotScopeIds,children:m,target:i.target,targetAnchor:i.targetAnchor,staticCount:i.staticCount,shapeFlag:i.shapeFlag,patchFlag:r&&i.type!==wt?d===-1?16:d|16:d,dynamicProps:i.dynamicProps,dynamicChildren:i.dynamicChildren,appContext:i.appContext,dirs:i.dirs,transition:i.transition,component:i.component,suspense:i.suspense,ssContent:i.ssContent&&mi(i.ssContent),ssFallback:i.ssFallback&&mi(i.ssFallback),el:i.el,anchor:i.anchor,ctx:i.ctx,ce:i.ce}}function yh(i=" ",r=0){return Zt(vs,null,i,r)}function mt(i){return i==null||typeof i=="boolean"?Zt(ji):se(i)?Zt(wt,null,i.slice()):typeof i=="object"?Dt(i):Zt(vs,null,String(i))}function Dt(i){return i.el===null&&i.patchFlag!==-1||i.memo?i:mi(i)}function Dr(i,r){let o=0;const{shapeFlag:u}=i;if(r==null)r=null;else if(se(r))o=16;else if(typeof r=="object")if(u&65){const h=r.default;h&&(h._c&&(h._d=!1),Dr(i,h()),h._c&&(h._d=!0));return}else{o=32;const h=r._;!h&&!(Is in r)?r._ctx=yt:h===3&&yt&&(yt.slots._===1?r._=1:(r._=2,i.patchFlag|=1024))}else oe(r)?(r={default:r,_ctx:yt},o=32):(r=String(r),u&64?(o=16,r=[yh(r)]):o=8);i.children=r,i.shapeFlag|=o}function xh(...i){const r={};for(let o=0;o<i.length;o++){const u=i[o];for(const h in u)if(h==="class")r.class!==u.class&&(r.class=Cr([r.class,u.class]));else if(h==="style")r.style=Sr([r.style,u.style]);else if(Ss(h)){const d=r[h],m=u[h];m&&d!==m&&!(se(d)&&d.includes(m))&&(r[h]=d?[].concat(d,m):m)}else h!==""&&(r[h]=u[h])}return r}function ft(i,r,o,u=null){ut(i,r,7,[o,u])}const Sh=bo();let Ch=0;function bh(i,r,o){const u=i.type,h=(r?r.appContext:i.appContext)||Sh,d={uid:Ch++,vnode:i,type:u,parent:r,appContext:h,root:null,next:null,subTree:null,effect:null,update:null,scope:new zl(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:r?r.provides:Object.create(h.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Mo(u,h),emitsOptions:go(u,h),emit:null,emitted:null,propsDefaults:Me,inheritAttrs:u.inheritAttrs,ctx:Me,data:Me,props:Me,attrs:Me,slots:Me,refs:Me,setupState:Me,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:o,suspenseId:o?o.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return d.ctx={_:d},d.root=r?r.root:d,d.emit=Tu.bind(null,d),i.ce&&i.ce(d),d}let Ne=null,Or,hi,La="__VUE_INSTANCE_SETTERS__";(hi=ir()[La])||(hi=ir()[La]=[]),hi.push(i=>Ne=i),Or=i=>{hi.length>1?hi.forEach(r=>r(i)):hi[0](i)};const pi=i=>{Or(i),i.scope.on()},Qt=()=>{Ne&&Ne.scope.off(),Or(null)};function Eo(i){return i.vnode.shapeFlag&4}let Xi=!1;function Bh(i,r=!1){Xi=r;const{props:o,children:u}=i.vnode,h=Eo(i);nh(i,o,h,r),lh(i,u);const d=h?Mh(i,r):void 0;return Xi=!1,d}function Mh(i,r){const o=i.type;i.accessCache=Object.create(null),i.proxy=ao(new Proxy(i.ctx,Ku));const{setup:u}=o;if(u){const h=i.setupContext=u.length>1?wh(i):null;pi(i),xi();const d=kt(u,i,0,[i.props,h]);if(Si(),Qt(),Ya(d)){if(d.then(Qt,Qt),r)return d.then(m=>{Da(i,m,r)}).catch(m=>{Ms(m,i,0)});i.asyncDep=d}else Da(i,d,r)}else Ro(i,r)}function Da(i,r,o){oe(r)?i.type.__ssrInlineRender?i.ssrRender=r:i.render=r:Ve(r)&&(i.setupState=oo(r)),Ro(i,o)}let Oa;function Ro(i,r,o){const u=i.type;if(!i.render){if(!r&&Oa&&!u.render){const h=u.template||Vr(i).template;if(h){const{isCustomElement:d,compilerOptions:m}=i.appContext.config,{delimiters:C,compilerOptions:b}=u,S=De(De({isCustomElement:d,delimiters:C},m),b);u.render=Oa(h,S)}}i.render=u.render||lt}pi(i),xi(),Ju(i),Si(),Qt()}function Ph(i){return i.attrsProxy||(i.attrsProxy=new Proxy(i.attrs,{get(r,o){return We(i,"get","$attrs"),r[o]}}))}function wh(i){const r=o=>{i.exposed=o||{}};return{get attrs(){return Ph(i)},slots:i.slots,emit:i.emit,expose:r}}function kr(i){if(i.exposed)return i.exposeProxy||(i.exposeProxy=new Proxy(oo(ao(i.exposed)),{get(r,o){if(o in r)return r[o];if(o in ki)return ki[o](i)},has(r,o){return o in r||o in ki}}))}function vh(i){return oe(i)&&"__vccOpts"in i}const Ih=(i,r)=>bu(i,r,Xi),Th=Symbol.for("v-scx"),Eh=()=>gs(Th),Rh="3.3.4",Fh="http://www.w3.org/2000/svg",Kt=typeof document<"u"?document:null,ka=Kt&&Kt.createElement("template"),Vh={insert:(i,r,o)=>{r.insertBefore(i,o||null)},remove:i=>{const r=i.parentNode;r&&r.removeChild(i)},createElement:(i,r,o,u)=>{const h=r?Kt.createElementNS(Fh,i):Kt.createElement(i,o?{is:o}:void 0);return i==="select"&&u&&u.multiple!=null&&h.setAttribute("multiple",u.multiple),h},createText:i=>Kt.createTextNode(i),createComment:i=>Kt.createComment(i),setText:(i,r)=>{i.nodeValue=r},setElementText:(i,r)=>{i.textContent=r},parentNode:i=>i.parentNode,nextSibling:i=>i.nextSibling,querySelector:i=>Kt.querySelector(i),setScopeId(i,r){i.setAttribute(r,"")},insertStaticContent(i,r,o,u,h,d){const m=o?o.previousSibling:r.lastChild;if(h&&(h===d||h.nextSibling))for(;r.insertBefore(h.cloneNode(!0),o),!(h===d||!(h=h.nextSibling)););else{ka.innerHTML=u?`<svg>${i}</svg>`:i;const C=ka.content;if(u){const b=C.firstChild;for(;b.firstChild;)C.appendChild(b.firstChild);C.removeChild(b)}r.insertBefore(C,o)}return[m?m.nextSibling:r.firstChild,o?o.previousSibling:r.lastChild]}};function Ah(i,r,o){const u=i._vtc;u&&(r=(r?[r,...u]:[...u]).join(" ")),r==null?i.removeAttribute("class"):o?i.setAttribute("class",r):i.className=r}function Lh(i,r,o){const u=i.style,h=Oe(o);if(o&&!h){if(r&&!Oe(r))for(const d in r)o[d]==null&&_r(u,d,"");for(const d in o)_r(u,d,o[d])}else{const d=u.display;h?r!==o&&(u.cssText=o):r&&i.removeAttribute("style"),"_vod"in i&&(u.display=d)}}const Na=/\s*!important$/;function _r(i,r,o){if(se(o))o.forEach(u=>_r(i,r,u));else if(o==null&&(o=""),r.startsWith("--"))i.setProperty(r,o);else{const u=Dh(i,r);Na.test(o)?i.setProperty(yi(u),o.replace(Na,""),"important"):i[u]=o}}const Ua=["Webkit","Moz","ms"],er={};function Dh(i,r){const o=er[r];if(o)return o;let u=fi(r);if(u!=="filter"&&u in i)return er[r]=u;u=Ga(u);for(let h=0;h<Ua.length;h++){const d=Ua[h]+u;if(d in i)return er[r]=d}return r}const za="http://www.w3.org/1999/xlink";function Oh(i,r,o,u,h){if(u&&r.startsWith("xlink:"))o==null?i.removeAttributeNS(za,r.slice(6,r.length)):i.setAttributeNS(za,r,o);else{const d=Ul(r);o==null||d&&!qa(o)?i.removeAttribute(r):i.setAttribute(r,d?"":o)}}function kh(i,r,o,u,h,d,m){if(r==="innerHTML"||r==="textContent"){u&&m(u,h,d),i[r]=o??"";return}const C=i.tagName;if(r==="value"&&C!=="PROGRESS"&&!C.includes("-")){i._value=o;const S=C==="OPTION"?i.getAttribute("value"):i.value,R=o??"";S!==R&&(i.value=R),o==null&&i.removeAttribute(r);return}let b=!1;if(o===""||o==null){const S=typeof i[r];S==="boolean"?o=qa(o):o==null&&S==="string"?(o="",b=!0):S==="number"&&(o=0,b=!0)}try{i[r]=o}catch{}b&&i.removeAttribute(r)}function Nh(i,r,o,u){i.addEventListener(r,o,u)}function Uh(i,r,o,u){i.removeEventListener(r,o,u)}function zh(i,r,o,u,h=null){const d=i._vei||(i._vei={}),m=d[r];if(u&&m)m.value=u;else{const[C,b]=jh(r);if(u){const S=d[r]=Yh(u,h);Nh(i,C,S,b)}else m&&(Uh(i,C,m,b),d[r]=void 0)}}const ja=/(?:Once|Passive|Capture)$/;function jh(i){let r;if(ja.test(i)){r={};let u;for(;u=i.match(ja);)i=i.slice(0,i.length-u[0].length),r[u[0].toLowerCase()]=!0}return[i[2]===":"?i.slice(3):yi(i.slice(2)),r]}let tr=0;const Xh=Promise.resolve(),Hh=()=>tr||(Xh.then(()=>tr=0),tr=Date.now());function Yh(i,r){const o=u=>{if(!u._vts)u._vts=Date.now();else if(u._vts<=o.attached)return;ut(Gh(u,o.value),r,5,[u])};return o.value=i,o.attached=Hh(),o}function Gh(i,r){if(se(r)){const o=i.stopImmediatePropagation;return i.stopImmediatePropagation=()=>{o.call(i),i._stopped=!0},r.map(u=>h=>!h._stopped&&u&&u(h))}else return r}const Xa=/^on[a-z]/,qh=(i,r,o,u,h=!1,d,m,C,b)=>{r==="class"?Ah(i,u,h):r==="style"?Lh(i,o,u):Ss(r)?mr(r)||zh(i,r,o,u,m):(r[0]==="."?(r=r.slice(1),!0):r[0]==="^"?(r=r.slice(1),!1):Wh(i,r,u,h))?kh(i,r,u,d,m,C,b):(r==="true-value"?i._trueValue=u:r==="false-value"&&(i._falseValue=u),Oh(i,r,u,h))};function Wh(i,r,o,u){return u?!!(r==="innerHTML"||r==="textContent"||r in i&&Xa.test(r)&&oe(o)):r==="spellcheck"||r==="draggable"||r==="translate"||r==="form"||r==="list"&&i.tagName==="INPUT"||r==="type"&&i.tagName==="TEXTAREA"||Xa.test(r)&&Oe(o)?!1:r in i}const $h=De({patchProp:qh},Vh);let Ha;function Kh(){return Ha||(Ha=hh($h))}const Jh=(...i)=>{const r=Kh().createApp(...i),{mount:o}=r;return r.mount=u=>{const h=Zh(u);if(!h)return;const d=r._component;!oe(d)&&!d.render&&!d.template&&(d.template=h.innerHTML),h.innerHTML="";const m=o(h,!1,h instanceof SVGElement);return h instanceof Element&&(h.removeAttribute("v-cloak"),h.setAttribute("data-v-app","")),m},r};function Zh(i){return Oe(i)?document.querySelector(i):i}var Fo={exports:{}};(function(){var i,r,o,u,h,d,m,C={d:function(n,e){for(var t in e)C.o(e,t)&&!C.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})},o:function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},r:function(n){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})}},b={};C.r(b),C.d(b,{hideMessageBox:function(){return bl},initializeLive2D:function(){return Ml},revealMessageBox:function(){return Bl},setExpression:function(){return xl},setMessageBox:function(){return Cl},setRandomExpression:function(){return Sl}});class S{constructor(e=0){e<1?(this._ptr=[],this._capacity=0,this._size=0):(this._ptr=new Array(e),this._capacity=e,this._size=0)}at(e){return this._ptr[e]}set(e,t){this._ptr[e]=t}get(e=0){const t=new Array;for(let s=e;s<this._size;s++)t.push(this._ptr[s]);return t}pushBack(e){this._size>=this._capacity&&this.prepareCapacity(this._capacity==0?S.s_defaultSize:2*this._capacity),this._ptr[this._size++]=e}clear(){this._ptr.length=0,this._size=0}getSize(){return this._size}assign(e,t){this._size<e&&this.prepareCapacity(e);for(let s=0;s<e;s++)this._ptr[s]=t;this._size=e}resize(e,t=null){this.updateSize(e,t,!0)}updateSize(e,t=null,s=!0){if(this._size<e)if(this.prepareCapacity(e),s)for(let a=this._size;a<e;a++)this._ptr[a]=typeof t=="function"?JSON.parse(JSON.stringify(new t)):t;else for(let a=this._size;a<e;a++)this._ptr[a]=t;else{const a=this._size-e;this._ptr.splice(this._size-a,a)}this._size=e}insert(e,t,s){let a=e._index;const l=t._index,g=s._index,c=g-l;this.prepareCapacity(this._size+c);const f=this._size-a;if(f>0)for(let y=0;y<f;y++)this._ptr.splice(a+y,0,null);for(let y=l;y<g;y++,a++)this._ptr[a]=t._vector._ptr[y];this._size=this._size+c}remove(e){return!(e<0||this._size<=e||(this._ptr.splice(e,1),--this._size,0))}erase(e){const t=e._index;return t<0||this._size<=t?e:(this._ptr.splice(t,1),--this._size,new R(this,t))}prepareCapacity(e){e>this._capacity&&(this._capacity==0?(this._ptr=new Array(e),this._capacity=e):(this._ptr.length=e,this._capacity=e))}begin(){return this._size==0?this.end():new R(this,0)}end(){return new R(this,this._size)}getOffset(e){const t=new S;return t._ptr=this.get(e),t._size=this.get(e).length,t._capacity=this.get(e).length,t}}S.s_defaultSize=10;class R{constructor(e,t){this._vector=e??null,this._index=t??0}set(e){return this._index=e._index,this._vector=e._vector,this}preIncrement(){return++this._index,this}preDecrement(){return--this._index,this}increment(){return new R(this._vector,this._index++)}decrement(){return new R(this._vector,this._index--)}ptr(){return this._vector._ptr[this._index]}substitution(e){return this._index=e._index,this._vector=e._vector,this}notEqual(e){return this._index!=e._index||this._vector!=e._vector}}(function(n){n.csmVector=S,n.iterator=R})(i||(i={}));class L{append(e,t){return this.s+=t!==void 0?e.substr(0,t):e,this}expansion(e,t){for(let s=0;s<e;s++)this.append(t);return this}getBytes(){return encodeURIComponent(this.s).replace(/%../g,"x").length}getLength(){return this.s.length}isLess(e){return this.s<e.s}isGreat(e){return this.s>e.s}isEqual(e){return this.s==e}isEmpty(){return this.s.length==0}constructor(e){this.s=e}}(function(n){n.csmString=L})(r||(r={}));class z{getString(){return this._id}constructor(e){this._id=typeof e!="string"?e:new L(e)}isEqual(e){return typeof e=="string"?this._id.isEqual(e):e instanceof L?this._id.isEqual(e.s):e instanceof z&&this._id.isEqual(e._id.s)}isNotEqual(e){return typeof e=="string"?!this._id.isEqual(e):e instanceof L?!this._id.isEqual(e.s):e instanceof z&&!this._id.isEqual(e._id.s)}}(function(n){n.CubismId=z})(o||(o={}));class te{constructor(){this._ids=new S}release(){for(let e=0;e<this._ids.getSize();++e)this._ids.set(e,void 0);this._ids=null}registerIds(e){for(let t=0;t<e.length;t++)this.registerId(e[t])}registerId(e){let t=null;return typeof e!="string"?this.registerId(e.s):((t=this.findId(e))!=null||(t=new z(e),this._ids.pushBack(t)),t)}getId(e){return this.registerId(e)}isExist(e){return typeof e=="string"?this.findId(e)!=null:this.isExist(e.s)}findId(e){for(let t=0;t<this._ids.getSize();++t)if(this._ids.at(t).getString().isEqual(e))return this._ids.at(t);return null}}(function(n){n.CubismIdManager=te})(u||(u={}));class ie{constructor(){this._tr=new Float32Array(16),this.loadIdentity()}static multiply(e,t,s){const a=new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);for(let l=0;l<4;++l)for(let g=0;g<4;++g)for(let c=0;c<4;++c)a[g+4*l]+=e[c+4*l]*t[g+4*c];for(let l=0;l<16;++l)s[l]=a[l]}loadIdentity(){const e=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);this.setMatrix(e)}setMatrix(e){for(let t=0;t<16;++t)this._tr[t]=e[t]}getArray(){return this._tr}getScaleX(){return this._tr[0]}getScaleY(){return this._tr[5]}getTranslateX(){return this._tr[12]}getTranslateY(){return this._tr[13]}transformX(e){return this._tr[0]*e+this._tr[12]}transformY(e){return this._tr[5]*e+this._tr[13]}invertTransformX(e){return(e-this._tr[12])/this._tr[0]}invertTransformY(e){return(e-this._tr[13])/this._tr[5]}translateRelative(e,t){const s=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,e,t,0,1]);ie.multiply(s,this._tr,this._tr)}translate(e,t){this._tr[12]=e,this._tr[13]=t}translateX(e){this._tr[12]=e}translateY(e){this._tr[13]=e}scaleRelative(e,t){const s=new Float32Array([e,0,0,0,0,t,0,0,0,0,1,0,0,0,0,1]);ie.multiply(s,this._tr,this._tr)}scale(e,t){this._tr[0]=e,this._tr[5]=t}multiplyByMatrix(e){ie.multiply(e.getArray(),this._tr,this._tr)}clone(){const e=new ie;for(let t=0;t<this._tr.length;t++)e._tr[t]=this._tr[t];return e}}(function(n){n.CubismMatrix44=ie})(h||(h={}));class ne{static create(){return null}static delete(e){}initialize(e){this._model=e}drawModel(){this.getModel()!=null&&(this.saveProfile(),this.doDrawModel(),this.restoreProfile())}setMvpMatrix(e){this._mvpMatrix4x4.setMatrix(e.getArray())}getMvpMatrix(){return this._mvpMatrix4x4}setModelColor(e,t,s,a){e<0?e=0:e>1&&(e=1),t<0?t=0:t>1&&(t=1),s<0?s=0:s>1&&(s=1),a<0?a=0:a>1&&(a=1),this._modelColor.R=e,this._modelColor.G=t,this._modelColor.B=s,this._modelColor.A=a}getModelColor(){return JSON.parse(JSON.stringify(this._modelColor))}setIsPremultipliedAlpha(e){this._isPremultipliedAlpha=e}isPremultipliedAlpha(){return this._isPremultipliedAlpha}setIsCulling(e){this._isCulling=e}isCulling(){return this._isCulling}setAnisotropy(e){this._anisotropy=e}getAnisotropy(){return this._anisotropy}getModel(){return this._model}useHighPrecisionMask(e){this._useHighPrecisionMask=e}isUsingHighPrecisionMask(){return this._useHighPrecisionMask}constructor(){this._isCulling=!1,this._isPremultipliedAlpha=!1,this._anisotropy=0,this._model=null,this._modelColor=new ce,this._useHighPrecisionMask=!1,this._mvpMatrix4x4=new ie,this._mvpMatrix4x4.loadIdentity()}}(function(n){n[n.CubismBlendMode_Normal=0]="CubismBlendMode_Normal",n[n.CubismBlendMode_Additive=1]="CubismBlendMode_Additive",n[n.CubismBlendMode_Multiplicative=2]="CubismBlendMode_Multiplicative"})(d||(d={}));class ce{constructor(e=1,t=1,s=1,a=1){this.R=e,this.G=t,this.B=s,this.A=a}}(function(n){n.CubismBlendMode=d,n.CubismRenderer=ne,n.CubismTextureColor=ce})(m||(m={}));const Ie=(n,e,t)=>{((s,a,l)=>{Ut.print(s,"[CSM]"+a,l)})(n,e+`
`,t)},Se=n=>{console.assert(n)};let we,K,Ae,Te;we=(n,...e)=>{Ie(w.LogLevel_Debug,"[D]"+n,e)},K=(n,...e)=>{Ie(w.LogLevel_Info,"[I]"+n,e)},Ae=(n,...e)=>{Ie(w.LogLevel_Warning,"[W]"+n,e)},Te=(n,...e)=>{Ie(w.LogLevel_Error,"[E]"+n,e)};class Ut{static print(e,t,s){if(e<_.getLoggingLevel())return;const a=_.coreLogFunction;a&&a(t.replace(/\{(\d+)\}/g,(l,g)=>s[g]))}static dumpBytes(e,t,s){for(let a=0;a<s;a++)a%16==0&&a>0?this.print(e,`
`):a%8==0&&a>0&&this.print(e,"  "),this.print(e,"{0} ",[255&t[a]]);this.print(e,`
`)}constructor(){}}var ht,ei;(function(n){n.CubismDebug=Ut})(ht||(ht={}));class ct{constructor(e,t){this.first=e??null,this.second=t??null}}class Ee{constructor(e){e!=null?e<1?(this._keyValues=[],this._dummyValue=null,this._size=0):(this._keyValues=new Array(e),this._size=e):(this._keyValues=[],this._dummyValue=null,this._size=0)}release(){this.clear()}appendKey(e){this.prepareCapacity(this._size+1,!1),this._keyValues[this._size]=new ct(e),this._size+=1}getValue(e){let t=-1;for(let s=0;s<this._size;s++)if(this._keyValues[s].first==e){t=s;break}return t>=0?this._keyValues[t].second:(this.appendKey(e),this._keyValues[this._size-1].second)}setValue(e,t){let s=-1;for(let a=0;a<this._size;a++)if(this._keyValues[a].first==e){s=a;break}s>=0?this._keyValues[s].second=t:(this.appendKey(e),this._keyValues[this._size-1].second=t)}isExist(e){for(let t=0;t<this._size;t++)if(this._keyValues[t].first==e)return!0;return!1}clear(){this._keyValues=void 0,this._keyValues=null,this._keyValues=[],this._size=0}getSize(){return this._size}prepareCapacity(e,t){e>this._keyValues.length&&(this._keyValues.length==0?(!t&&e<Ee.DefaultSize&&(e=Ee.DefaultSize),this._keyValues.length=e):(!t&&e<2*this._keyValues.length&&(e=2*this._keyValues.length),this._keyValues.length=e))}begin(){return new Qe(this,0)}end(){return new Qe(this,this._size)}erase(e){const t=e._index;return t<0||this._size<=t?e:(this._keyValues.splice(t,1),--this._size,new Qe(this,t))}dumpAsInt(){for(let e=0;e<this._size;e++)we("{0} ,",this._keyValues[e]),we(`
`)}}Ee.DefaultSize=10;class Qe{constructor(e,t){this._map=e??new Ee,this._index=t??0}set(e){return this._index=e._index,this._map=e._map,this}preIncrement(){return++this._index,this}preDecrement(){return--this._index,this}increment(){return new Qe(this._map,this._index++)}decrement(){const e=new Qe(this._map,this._index);return this._map=e._map,this._index=e._index,this}ptr(){return this._map._keyValues[this._index]}notEqual(e){return this._index!=e._index||this._map!=e._map}}(function(n){n.csmMap=Ee,n.csmPair=ct,n.iterator=Qe})(ei||(ei={}));class xt{static parseJsonObject(e,t){return Object.keys(e).forEach(s=>{if(typeof e[s]=="boolean"){const a=!!e[s];t.put(s,new ae(a))}else if(typeof e[s]=="string"){const a=String(e[s]);t.put(s,new je(a))}else if(typeof e[s]=="number"){const a=Number(e[s]);t.put(s,new Ce(a))}else e[s]instanceof Array?t.put(s,xt.parseJsonArray(e[s])):e[s]instanceof Object?t.put(s,xt.parseJsonObject(e[s],new St)):e[s]==null?t.put(s,new Xe):t.put(s,e[s])}),t}static parseJsonArray(e){const t=new He;return Object.keys(e).forEach(s=>{if(typeof Number(s)=="number")if(typeof e[s]=="boolean"){const a=!!e[s];t.add(new ae(a))}else if(typeof e[s]=="string"){const a=String(e[s]);t.add(new je(a))}else if(typeof e[s]=="number"){const a=Number(e[s]);t.add(new Ce(a))}else e[s]instanceof Array?t.add(this.parseJsonArray(e[s])):e[s]instanceof Object?t.add(this.parseJsonObject(e[s],new St)):e[s]==null?t.add(new Xe):t.add(e[s]);else if(e[s]instanceof Array)t.add(this.parseJsonArray(e[s]));else if(e[s]instanceof Object)t.add(this.parseJsonObject(e[s],new St));else if(e[s]==null)t.add(new Xe);else{const a=Array(e[s]);for(let l=0;l<a.length;l++)t.add(a[l])}}),t}}const Tt="Error: type mismatch";class ye{constructor(){}getRawString(e,t){return this.getString(e,t)}toInt(e=0){return e}toFloat(e=0){return e}toBoolean(e=!1){return e}getSize(){return 0}getArray(e=null){return e}getVector(e=new S){return e}getMap(e){return e}getValueByIndex(e){return ye.errorValue.setErrorNotForClientCall(Tt)}getValueByString(e){return ye.nullValue.setErrorNotForClientCall(Tt)}getKeys(){return ye.s_dummyKeys}isError(){return!1}isNull(){return!1}isBool(){return!1}isFloat(){return!1}isString(){return!1}isArray(){return!1}isMap(){return!1}equals(e){return!1}isStatic(){return!1}setErrorNotForClientCall(e){return dt.errorValue}static staticInitializeNotForClientCall(){ae.trueValue=new ae(!0),ae.falseValue=new ae(!1),ye.errorValue=new dt("ERROR",!0),ye.nullValue=new Xe,ye.s_dummyKeys=new S}static staticReleaseNotForClientCall(){ae.trueValue=null,ae.falseValue=null,ye.errorValue=null,ye.nullValue=null,ye.s_dummyKeys=null}}class de{constructor(e,t){this._parseCallback=xt.parseJsonObject,this._error=null,this._lineCount=0,this._root=null,e!=null&&this.parseBytes(e,t,this._parseCallback)}static create(e,t){const s=new de;return s.parseBytes(e,t,s._parseCallback)?s:(de.delete(s),null)}static delete(e){}getRoot(){return this._root}static arrayBufferToString(e){const t=new Uint8Array(e);let s="";for(let a=0,l=t.length;a<l;++a)s+="%"+this.pad(t[a].toString(16));return s=decodeURIComponent(s),s}static pad(e){return e.length<2?"0"+e:e}parseBytes(e,t,s){const a=new Array(1),l=de.arrayBufferToString(e);if(this._root=s==null?this.parseValue(l,t,0,a):s(JSON.parse(l),new St),this._error){let g="\0";return g="Json parse error : @line "+(this._lineCount+1)+`
`,this._root=new je(g),K("{0}",this._root.getRawString()),!1}return this._root!=null||(this._root=new dt(new L(this._error),!1),!1)}getParseError(){return this._error}checkEndOfFile(){return this._root.getArray()[1].equals("EOF")}parseValue(e,t,s,a){if(this._error)return null;let l,g=null,c=s;for(;c<t;c++)switch(e[c]){case"-":case".":case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{const f=new Array(1);return l=Ts(e.slice(c),f),a[0]=e.indexOf(f[0]),new Ce(l)}case'"':return new je(this.parseString(e,t,c+1,a));case"[":return g=this.parseArray(e,t,c+1,a),g;case"{":return g=this.parseObject(e,t,c+1,a),g;case"n":return c+3<t?(g=new Xe,a[0]=c+4):this._error="parse null",g;case"t":return c+3<t?(g=ae.trueValue,a[0]=c+4):this._error="parse true",g;case"f":return c+4<t?(g=ae.falseValue,a[0]=c+5):this._error="illegal ',' position",g;case",":return this._error="illegal ',' position",null;case"]":return a[0]=c,null;case`
`:this._lineCount++}return this._error="illegal end of value",null}parseString(e,t,s,a){if(this._error)return null;let l,g,c=s;const f=new L("");let y=s;for(;c<t;c++)switch(l=e[c],l){case'"':return a[0]=c+1,f.append(e.slice(y),c-y),f.s;case"//":if(c++,c-1>y&&f.append(e.slice(y),c-y),y=c+1,c<t)switch(g=e[c],g){case"\\":f.expansion(1,"\\");break;case'"':f.expansion(1,'"');break;case"/":f.expansion(1,"/");break;case"b":f.expansion(1,"\b");break;case"f":f.expansion(1,"\f");break;case"n":f.expansion(1,`
`);break;case"r":f.expansion(1,"\r");break;case"t":f.expansion(1,"	");break;case"u":this._error="parse string/unicord escape not supported"}else this._error="parse string/escape error"}return this._error="parse string/illegal end",null}parseObject(e,t,s,a){if(this._error)return null;const l=new St;let g="",c=s,f="";const y=Array(1);let p=!1;for(;c<t;c++){e:for(;c<t;c++)switch(f=e[c],f){case'"':if(g=this.parseString(e,t,c+1,y),this._error)return null;c=y[0],p=!0;break e;case"}":return a[0]=c+1,l;case":":this._error="illegal ':' position";break;case`
`:this._lineCount++}if(!p)return this._error="key not found",null;p=!1;e:for(;c<t;c++)switch(f=e[c],f){case":":p=!0,c++;break e;case"}":this._error="illegal '}' position";break;case`
`:this._lineCount++}if(!p)return this._error="':' not found",null;const I=this.parseValue(e,t,c,y);if(this._error)return null;c=y[0],l.put(g,I);e:for(;c<t;c++)switch(f=e[c],f){case",":break e;case"}":return a[0]=c+1,l;case`
`:this._lineCount++}}return this._error="illegal end of perseObject",null}parseArray(e,t,s,a){if(this._error)return null;let l,g=new He,c=s;const f=new Array(1);for(;c<t;c++){const y=this.parseValue(e,t,c,f);if(this._error)return null;c=f[0],y&&g.add(y);e:for(;c<t;c++)switch(l=e[c],l){case",":break e;case"]":return a[0]=c+1,g;case`
`:++this._lineCount}}return g=void 0,this._error="illegal end of parseObject",null}}class Ce extends ye{constructor(e){super(),this._value=e}isFloat(){return!0}getString(e,t){return this._value=parseFloat("\0"),this._stringBuffer="\0",this._stringBuffer}toInt(e=0){return parseInt(this._value.toString())}toFloat(e=0){return this._value}equals(e){return typeof e=="number"&&!Math.round(e)&&e==this._value}}class ae extends ye{isBool(){return!0}toBoolean(e=!1){return this._boolValue}getString(e,t){return this._stringBuffer=this._boolValue?"true":"false",this._stringBuffer}equals(e){return typeof e=="boolean"&&e==this._boolValue}isStatic(){return!0}constructor(e){super(),this._boolValue=e}}class je extends ye{constructor(e){super(),typeof e=="string"&&(this._stringBuffer=e),e instanceof L&&(this._stringBuffer=e.s)}isString(){return!0}getString(e,t){return this._stringBuffer}equals(e){return typeof e=="string"?this._stringBuffer==e:e instanceof L&&this._stringBuffer==e.s}}class dt extends je{isStatic(){return this._isStatic}setErrorNotForClientCall(e){return this._stringBuffer=e,this}constructor(e,t){super(e),this._isStatic=t}isError(){return!0}}class Xe extends ye{isNull(){return!0}getString(e,t){return this._stringBuffer}isStatic(){return!0}setErrorNotForClientCall(e){return this._stringBuffer=e,dt.nullValue}constructor(){super(),this._stringBuffer="NullValue"}}class He extends ye{constructor(){super(),this._array=new S}release(){for(let e=this._array.begin();e.notEqual(this._array.end());e.preIncrement()){let t=e.ptr();t&&!t.isStatic()&&(t=void 0,t=null)}}isArray(){return!0}getValueByIndex(e){if(e<0||this._array.getSize()<=e)return ye.errorValue.setErrorNotForClientCall("Error: index out of bounds");const t=this._array.at(e);return t??ye.nullValue}getValueByString(e){return ye.errorValue.setErrorNotForClientCall(Tt)}getString(e,t){const s=t+`[
`;for(let a=this._array.begin();a.notEqual(this._array.end());a.increment()){const l=a.ptr();this._stringBuffer+=t+""+l.getString(t+" ")+`
`}return this._stringBuffer=s+t+`]
`,this._stringBuffer}add(e){this._array.pushBack(e)}getVector(e=null){return this._array}getSize(){return this._array.getSize()}}class St extends ye{constructor(){super(),this._map=new Ee}release(){const e=this._map.begin();for(;e.notEqual(this._map.end());){let t=e.ptr().second;t&&!t.isStatic()&&(t=void 0,t=null),e.preIncrement()}}isMap(){return!0}getValueByString(e){if(e instanceof L){const t=this._map.getValue(e.s);return t??ye.nullValue}for(let t=this._map.begin();t.notEqual(this._map.end());t.preIncrement())if(t.ptr().first==e)return t.ptr().second==null?ye.nullValue:t.ptr().second;return ye.nullValue}getValueByIndex(e){return ye.errorValue.setErrorNotForClientCall(Tt)}getString(e,t){this._stringBuffer=t+`{
`;const s=this._map.begin();for(;s.notEqual(this._map.end());){const a=s.ptr().first,l=s.ptr().second;this._stringBuffer+=t+" "+a+" : "+l.getString(t+"   ")+` 
`,s.preIncrement()}return this._stringBuffer+=t+`}
`,this._stringBuffer}getMap(e){return this._map}put(e,t){this._map.setValue(e,t)}getKeys(){if(!this._keys){this._keys=new S;const e=this._map.begin();for(;e.notEqual(this._map.end());){const t=e.ptr().first;this._keys.pushBack(t),e.preIncrement()}}return this._keys}getSize(){return this._keys.getSize()}}var Hi;function Ts(n,e){let t=0;for(let a=1;;a++){const l=n.slice(a-1,a);if(l=="e"||l=="-"||l=="E")continue;const g=n.substring(0,a),c=Number(g);if(isNaN(c))break;t=a}let s=parseFloat(n);return isNaN(s)&&(s=NaN),e[0]=n.slice(t),s}(function(n){n.CubismJson=de,n.JsonArray=He,n.JsonBoolean=ae,n.JsonError=dt,n.JsonFloat=Ce,n.JsonMap=St,n.JsonNullvalue=Xe,n.JsonString=je,n.Value=ye})(Hi||(Hi={}));let Re=!1,nt=!1,Ct=null,et=null;const tt=Object.freeze({vertexOffset:0,vertexStep:2});function Ci(n){}class _{static startUp(e=null){if(Re)return K("CubismFramework.startUp() is already done."),Re;if(Ct=e,Ct!=null&&Live2DCubismCore.Logging.csmSetLogFunction(Ct.logFunction),Re=!0,Re){const t=Live2DCubismCore.Version.csmGetVersion(),s=(16711680&t)>>16,a=65535&t,l=t;K("Live2D Cubism Core version: {0}.{1}.{2} ({3})",("00"+((4278190080&t)>>24)).slice(-2),("00"+s).slice(-2),("0000"+a).slice(-4),l)}return K("CubismFramework.startUp() is complete."),Re}static cleanUp(){Re=!1,nt=!1,Ct=null,et=null}static initialize(e=0){Se(Re),Re?nt?Ae("CubismFramework.initialize() skipped, already initialized."):(ye.staticInitializeNotForClientCall(),et=new te,Live2DCubismCore.Memory.initializeAmountOfMemory(e),nt=!0,K("CubismFramework.initialize() is complete.")):Ae("CubismFramework is not started.")}static dispose(){Se(Re),Re?nt?(ye.staticReleaseNotForClientCall(),et.release(),et=null,ne.staticRelease(),nt=!1,K("CubismFramework.dispose() is complete.")):Ae("CubismFramework.dispose() skipped, not initialized."):Ae("CubismFramework is not started.")}static isStarted(){return Re}static isInitialized(){return nt}static coreLogFunction(e){Live2DCubismCore.Logging.csmGetLogFunction()&&Live2DCubismCore.Logging.csmGetLogFunction()(e)}static getLoggingLevel(){return Ct!=null?Ct.loggingLevel:w.LogLevel_Off}static getIdManager(){return et}constructor(){}}class x{}var w,T;(function(n){n[n.LogLevel_Verbose=0]="LogLevel_Verbose",n[n.LogLevel_Debug=1]="LogLevel_Debug",n[n.LogLevel_Info=2]="LogLevel_Info",n[n.LogLevel_Warning=3]="LogLevel_Warning",n[n.LogLevel_Error=4]="LogLevel_Error",n[n.LogLevel_Off=5]="LogLevel_Off"})(w||(w={})),function(n){n.Constant=tt,n.csmDelete=Ci,n.CubismFramework=_}(T||(T={}));var P={CanvasId:"live2d",MessageBoxId:"live2dMessageBox",BackgroundRGBA:[0,0,0,0],CanvasSize:"auto",ViewScale:1,ViewMaxScale:2,ViewMinScale:.8,ViewLogicalLeft:-1,ViewLogicalRight:1,ViewLogicalBottom:-1,ViewLogicalTop:1,ViewLogicalMaxLeft:-2,ViewLogicalMaxRight:2,ViewLogicalMaxBottom:-2,ViewLogicalMaxTop:2,ResourcesPath:"",PowerImageName:"",MotionGroupIdle:"Idle",MotionGroupTapBody:"TapBody",HitAreaNameHead:"Head",HitAreaNameBody:"Body",PriorityNone:0,PriorityIdle:1,PriorityNormal:2,PriorityForce:3,MOCConsistencyValidationEnable:!0,DebugLogEnable:!0,DebugTouchLogEnable:!1,CubismLoggingLevel:w.LogLevel_Verbose,RenderTargetWidth:1900,RenderTargetHeight:1e3},E=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||E!==void 0&&E,N="URLSearchParams"in E,V="Symbol"in E&&"iterator"in Symbol,A="FileReader"in E&&"Blob"in E&&function(){try{return new Blob,!0}catch{return!1}}(),F="FormData"in E,X="ArrayBuffer"in E;if(X)var j=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],Y=ArrayBuffer.isView||function(n){return n&&j.indexOf(Object.prototype.toString.call(n))>-1};function $(n){if(typeof n!="string"&&(n=String(n)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(n)||n==="")throw new TypeError('Invalid character in header field name: "'+n+'"');return n.toLowerCase()}function re(n){return typeof n!="string"&&(n=String(n)),n}function fe(n){var e={next:function(){var t=n.shift();return{done:t===void 0,value:t}}};return V&&(e[Symbol.iterator]=function(){return e}),e}function Z(n){this.map={},n instanceof Z?n.forEach(function(e,t){this.append(t,e)},this):Array.isArray(n)?n.forEach(function(e){this.append(e[0],e[1])},this):n&&Object.getOwnPropertyNames(n).forEach(function(e){this.append(e,n[e])},this)}function Be(n){if(n.bodyUsed)return Promise.reject(new TypeError("Already read"));n.bodyUsed=!0}function Ye(n){return new Promise(function(e,t){n.onload=function(){e(n.result)},n.onerror=function(){t(n.error)}})}function Et(n){var e=new FileReader,t=Ye(e);return e.readAsArrayBuffer(n),t}function bi(n){if(n.slice)return n.slice(0);var e=new Uint8Array(n.byteLength);return e.set(new Uint8Array(n)),e.buffer}function Rt(){return this.bodyUsed=!1,this._initBody=function(n){var e;this.bodyUsed=this.bodyUsed,this._bodyInit=n,n?typeof n=="string"?this._bodyText=n:A&&Blob.prototype.isPrototypeOf(n)?this._bodyBlob=n:F&&FormData.prototype.isPrototypeOf(n)?this._bodyFormData=n:N&&URLSearchParams.prototype.isPrototypeOf(n)?this._bodyText=n.toString():X&&A&&(e=n)&&DataView.prototype.isPrototypeOf(e)?(this._bodyArrayBuffer=bi(n.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):X&&(ArrayBuffer.prototype.isPrototypeOf(n)||Y(n))?this._bodyArrayBuffer=bi(n):this._bodyText=n=Object.prototype.toString.call(n):this._bodyText="",this.headers.get("content-type")||(typeof n=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):N&&URLSearchParams.prototype.isPrototypeOf(n)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},A&&(this.blob=function(){var n=Be(this);if(n)return n;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?Be(this)||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer)):this.blob().then(Et)}),this.text=function(){var n,e,t,s=Be(this);if(s)return s;if(this._bodyBlob)return n=this._bodyBlob,t=Ye(e=new FileReader),e.readAsText(n),t;if(this._bodyArrayBuffer)return Promise.resolve(function(a){for(var l=new Uint8Array(a),g=new Array(l.length),c=0;c<l.length;c++)g[c]=String.fromCharCode(l[c]);return g.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},F&&(this.formData=function(){return this.text().then(it)}),this.json=function(){return this.text().then(JSON.parse)},this}Z.prototype.append=function(n,e){n=$(n),e=re(e);var t=this.map[n];this.map[n]=t?t+", "+e:e},Z.prototype.delete=function(n){delete this.map[$(n)]},Z.prototype.get=function(n){return n=$(n),this.has(n)?this.map[n]:null},Z.prototype.has=function(n){return this.map.hasOwnProperty($(n))},Z.prototype.set=function(n,e){this.map[$(n)]=re(e)},Z.prototype.forEach=function(n,e){for(var t in this.map)this.map.hasOwnProperty(t)&&n.call(e,this.map[t],t,this)},Z.prototype.keys=function(){var n=[];return this.forEach(function(e,t){n.push(t)}),fe(n)},Z.prototype.values=function(){var n=[];return this.forEach(function(e){n.push(e)}),fe(n)},Z.prototype.entries=function(){var n=[];return this.forEach(function(e,t){n.push([t,e])}),fe(n)},V&&(Z.prototype[Symbol.iterator]=Z.prototype.entries);var Yi=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function Fe(n,e){if(!(this instanceof Fe))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var t,s,a=(e=e||{}).body;if(n instanceof Fe){if(n.bodyUsed)throw new TypeError("Already read");this.url=n.url,this.credentials=n.credentials,e.headers||(this.headers=new Z(n.headers)),this.method=n.method,this.mode=n.mode,this.signal=n.signal,a||n._bodyInit==null||(a=n._bodyInit,n.bodyUsed=!0)}else this.url=String(n);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new Z(e.headers)),this.method=(s=(t=e.method||this.method||"GET").toUpperCase(),Yi.indexOf(s)>-1?s:t),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&a)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(a),!(this.method!=="GET"&&this.method!=="HEAD"||e.cache!=="no-store"&&e.cache!=="no-cache")){var l=/([?&])_=[^&]*/;l.test(this.url)?this.url=this.url.replace(l,"$1_="+new Date().getTime()):this.url+=(/\?/.test(this.url)?"&":"?")+"_="+new Date().getTime()}}function it(n){var e=new FormData;return n.trim().split("&").forEach(function(t){if(t){var s=t.split("="),a=s.shift().replace(/\+/g," "),l=s.join("=").replace(/\+/g," ");e.append(decodeURIComponent(a),decodeURIComponent(l))}}),e}function $e(n,e){if(!(this instanceof $e))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');e||(e={}),this.type="default",this.status=e.status===void 0?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText=e.statusText===void 0?"":""+e.statusText,this.headers=new Z(e.headers),this.url=e.url||"",this._initBody(n)}Fe.prototype.clone=function(){return new Fe(this,{body:this._bodyInit})},Rt.call(Fe.prototype),Rt.call($e.prototype),$e.prototype.clone=function(){return new $e(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new Z(this.headers),url:this.url})},$e.error=function(){var n=new $e(null,{status:0,statusText:""});return n.type="error",n};var Vo=[301,302,303,307,308];$e.redirect=function(n,e){if(Vo.indexOf(e)===-1)throw new RangeError("Invalid status code");return new $e(null,{status:e,headers:{location:n}})};var ti=E.DOMException;try{new ti}catch{(ti=function(e,t){this.message=e,this.name=t;var s=Error(e);this.stack=s.stack}).prototype=Object.create(Error.prototype),ti.prototype.constructor=ti}function Nr(n,e){return new Promise(function(t,s){var a=new Fe(n,e);if(a.signal&&a.signal.aborted)return s(new ti("Aborted","AbortError"));var l=new XMLHttpRequest;function g(){l.abort()}l.onload=function(){var c,f,y={status:l.status,statusText:l.statusText,headers:(c=l.getAllResponseHeaders()||"",f=new Z,c.replace(/\r?\n[\t ]+/g," ").split("\r").map(function(I){return I.indexOf(`
`)===0?I.substr(1,I.length):I}).forEach(function(I){var B=I.split(":"),M=B.shift().trim();if(M){var v=B.join(":").trim();f.append(M,v)}}),f)};y.url="responseURL"in l?l.responseURL:y.headers.get("X-Request-URL");var p="response"in l?l.response:l.responseText;setTimeout(function(){t(new $e(p,y))},0)},l.onerror=function(){setTimeout(function(){s(new TypeError("Network request failed"))},0)},l.ontimeout=function(){setTimeout(function(){s(new TypeError("Network request failed"))},0)},l.onabort=function(){setTimeout(function(){s(new ti("Aborted","AbortError"))},0)},l.open(a.method,function(c){try{return c===""&&E.location.href?E.location.href:c}catch{return c}}(a.url),!0),a.credentials==="include"?l.withCredentials=!0:a.credentials==="omit"&&(l.withCredentials=!1),"responseType"in l&&(A?l.responseType="blob":X&&a.headers.get("Content-Type")&&a.headers.get("Content-Type").indexOf("application/octet-stream")!==-1&&(l.responseType="arraybuffer")),!e||typeof e.headers!="object"||e.headers instanceof Z?a.headers.forEach(function(c,f){l.setRequestHeader(f,c)}):Object.getOwnPropertyNames(e.headers).forEach(function(c){l.setRequestHeader(c,re(e.headers[c]))}),a.signal&&(a.signal.addEventListener("abort",g),l.onreadystatechange=function(){l.readyState===4&&a.signal.removeEventListener("abort",g)}),l.send(a._bodyInit===void 0?null:a._bodyInit)})}Nr.polyfill=!0,E.fetch||(E.fetch=Nr,E.Headers=Z,E.Request=Fe,E.Response=$e);const G=Object.freeze({HitAreaPrefix:"HitArea",HitAreaHead:"Head",HitAreaBody:"Body",PartsIdCore:"Parts01Core",PartsArmPrefix:"Parts01Arm_",PartsArmLPrefix:"Parts01ArmL_",PartsArmRPrefix:"Parts01ArmR_",ParamAngleX:"ParamAngleX",ParamAngleY:"ParamAngleY",ParamAngleZ:"ParamAngleZ",ParamEyeLOpen:"ParamEyeLOpen",ParamEyeLSmile:"ParamEyeLSmile",ParamEyeROpen:"ParamEyeROpen",ParamEyeRSmile:"ParamEyeRSmile",ParamEyeBallX:"ParamEyeBallX",ParamEyeBallY:"ParamEyeBallY",ParamEyeBallForm:"ParamEyeBallForm",ParamBrowLY:"ParamBrowLY",ParamBrowRY:"ParamBrowRY",ParamBrowLX:"ParamBrowLX",ParamBrowRX:"ParamBrowRX",ParamBrowLAngle:"ParamBrowLAngle",ParamBrowRAngle:"ParamBrowRAngle",ParamBrowLForm:"ParamBrowLForm",ParamBrowRForm:"ParamBrowRForm",ParamMouthForm:"ParamMouthForm",ParamMouthOpenY:"ParamMouthOpenY",ParamCheek:"ParamCheek",ParamBodyAngleX:"ParamBodyAngleX",ParamBodyAngleY:"ParamBodyAngleY",ParamBodyAngleZ:"ParamBodyAngleZ",ParamBreath:"ParamBreath",ParamArmLA:"ParamArmLA",ParamArmRA:"ParamArmRA",ParamArmLB:"ParamArmLB",ParamArmRB:"ParamArmRB",ParamHandL:"ParamHandL",ParamHandR:"ParamHandR",ParamHairFront:"ParamHairFront",ParamHairSide:"ParamHairSide",ParamHairBack:"ParamHairBack",ParamHairFluffy:"ParamHairFluffy",ParamShoulderY:"ParamShoulderY",ParamBustX:"ParamBustX",ParamBustY:"ParamBustY",ParamBaseX:"ParamBaseX",ParamBaseY:"ParamBaseY",ParamNONE:"NONE:"});var Ur,zr;(function(n){n.HitAreaBody=G.HitAreaBody,n.HitAreaHead=G.HitAreaHead,n.HitAreaPrefix=G.HitAreaPrefix,n.ParamAngleX=G.ParamAngleX,n.ParamAngleY=G.ParamAngleY,n.ParamAngleZ=G.ParamAngleZ,n.ParamArmLA=G.ParamArmLA,n.ParamArmLB=G.ParamArmLB,n.ParamArmRA=G.ParamArmRA,n.ParamArmRB=G.ParamArmRB,n.ParamBaseX=G.ParamBaseX,n.ParamBaseY=G.ParamBaseY,n.ParamBodyAngleX=G.ParamBodyAngleX,n.ParamBodyAngleY=G.ParamBodyAngleY,n.ParamBodyAngleZ=G.ParamBodyAngleZ,n.ParamBreath=G.ParamBreath,n.ParamBrowLAngle=G.ParamBrowLAngle,n.ParamBrowLForm=G.ParamBrowLForm,n.ParamBrowLX=G.ParamBrowLX,n.ParamBrowLY=G.ParamBrowLY,n.ParamBrowRAngle=G.ParamBrowRAngle,n.ParamBrowRForm=G.ParamBrowRForm,n.ParamBrowRX=G.ParamBrowRX,n.ParamBrowRY=G.ParamBrowRY,n.ParamBustX=G.ParamBustX,n.ParamBustY=G.ParamBustY,n.ParamCheek=G.ParamCheek,n.ParamEyeBallForm=G.ParamEyeBallForm,n.ParamEyeBallX=G.ParamEyeBallX,n.ParamEyeBallY=G.ParamEyeBallY,n.ParamEyeLOpen=G.ParamEyeLOpen,n.ParamEyeLSmile=G.ParamEyeLSmile,n.ParamEyeROpen=G.ParamEyeROpen,n.ParamEyeRSmile=G.ParamEyeRSmile,n.ParamHairBack=G.ParamHairBack,n.ParamHairFluffy=G.ParamHairFluffy,n.ParamHairFront=G.ParamHairFront,n.ParamHairSide=G.ParamHairSide,n.ParamHandL=G.ParamHandL,n.ParamHandR=G.ParamHandR,n.ParamMouthForm=G.ParamMouthForm,n.ParamMouthOpenY=G.ParamMouthOpenY,n.ParamNONE=G.ParamNONE,n.ParamShoulderY=G.ParamShoulderY,n.PartsArmLPrefix=G.PartsArmLPrefix,n.PartsArmPrefix=G.PartsArmPrefix,n.PartsArmRPrefix=G.PartsArmRPrefix,n.PartsIdCore=G.PartsIdCore})(Ur||(Ur={}));class jr{}(function(n){n.ICubismModelSetting=jr})(zr||(zr={}));const Ft="FileReferences",Xr="UserData",Vt="Name",Hr="File",Gi="Ids",Yr="Sound",Gr="FadeInTime",qr="FadeOutTime",Es="LipSync",Rs="EyeBlink";var Q,Wr,$r,Ge,Kr;(function(n){n[n.FrequestNode_Groups=0]="FrequestNode_Groups",n[n.FrequestNode_Moc=1]="FrequestNode_Moc",n[n.FrequestNode_Motions=2]="FrequestNode_Motions",n[n.FrequestNode_Expressions=3]="FrequestNode_Expressions",n[n.FrequestNode_Textures=4]="FrequestNode_Textures",n[n.FrequestNode_Physics=5]="FrequestNode_Physics",n[n.FrequestNode_Pose=6]="FrequestNode_Pose",n[n.FrequestNode_HitAreas=7]="FrequestNode_HitAreas"})(Q||(Q={}));class Jr extends jr{constructor(e,t){super(),this._json=de.create(e,t),this._json&&(this._jsonValue=new S,this._jsonValue.pushBack(this._json.getRoot().getValueByString("Groups")),this._jsonValue.pushBack(this._json.getRoot().getValueByString(Ft).getValueByString("Moc")),this._jsonValue.pushBack(this._json.getRoot().getValueByString(Ft).getValueByString("Motions")),this._jsonValue.pushBack(this._json.getRoot().getValueByString(Ft).getValueByString("Expressions")),this._jsonValue.pushBack(this._json.getRoot().getValueByString(Ft).getValueByString("Textures")),this._jsonValue.pushBack(this._json.getRoot().getValueByString(Ft).getValueByString("Physics")),this._jsonValue.pushBack(this._json.getRoot().getValueByString(Ft).getValueByString("Pose")),this._jsonValue.pushBack(this._json.getRoot().getValueByString("HitAreas")))}release(){de.delete(this._json),this._jsonValue=null}GetJson(){return this._json}getModelFileName(){return this.isExistModelFile()?this._jsonValue.at(Q.FrequestNode_Moc).getRawString():""}getTextureCount(){return this.isExistTextureFiles()?this._jsonValue.at(Q.FrequestNode_Textures).getSize():0}getTextureDirectory(){const e=this._jsonValue.at(Q.FrequestNode_Textures).getValueByIndex(0).getRawString().split("/"),t=e.length-1;let s="";for(let a=0;a<t;a++)s+=e[a],a<t-1&&(s+="/");return s}getTextureFileName(e){return this._jsonValue.at(Q.FrequestNode_Textures).getValueByIndex(e).getRawString()}getHitAreasCount(){return this.isExistHitAreas()?this._jsonValue.at(Q.FrequestNode_HitAreas).getSize():0}getHitAreaId(e){return _.getIdManager().getId(this._jsonValue.at(Q.FrequestNode_HitAreas).getValueByIndex(e).getValueByString("Id").getRawString())}getHitAreaName(e){return this._jsonValue.at(Q.FrequestNode_HitAreas).getValueByIndex(e).getValueByString(Vt).getRawString()}getPhysicsFileName(){return this.isExistPhysicsFile()?this._jsonValue.at(Q.FrequestNode_Physics).getRawString():""}getPoseFileName(){return this.isExistPoseFile()?this._jsonValue.at(Q.FrequestNode_Pose).getRawString():""}getExpressionCount(){return this.isExistExpressionFile()?this._jsonValue.at(Q.FrequestNode_Expressions).getSize():0}getExpressionName(e){return this._jsonValue.at(Q.FrequestNode_Expressions).getValueByIndex(e).getValueByString(Vt).getRawString()}getExpressionFileName(e){return this._jsonValue.at(Q.FrequestNode_Expressions).getValueByIndex(e).getValueByString(Hr).getRawString()}getMotionGroupCount(){return this.isExistMotionGroups()?this._jsonValue.at(Q.FrequestNode_Motions).getKeys().getSize():0}getMotionGroupName(e){return this.isExistMotionGroups()?this._jsonValue.at(Q.FrequestNode_Motions).getKeys().at(e):null}getMotionCount(e){return this.isExistMotionGroupName(e)?this._jsonValue.at(Q.FrequestNode_Motions).getValueByString(e).getSize():0}getMotionFileName(e,t){return this.isExistMotionGroupName(e)?this._jsonValue.at(Q.FrequestNode_Motions).getValueByString(e).getValueByIndex(t).getValueByString(Hr).getRawString():""}getMotionSoundFileName(e,t){return this.isExistMotionSoundFile(e,t)?this._jsonValue.at(Q.FrequestNode_Motions).getValueByString(e).getValueByIndex(t).getValueByString(Yr).getRawString():""}getMotionFadeInTimeValue(e,t){return this.isExistMotionFadeIn(e,t)?this._jsonValue.at(Q.FrequestNode_Motions).getValueByString(e).getValueByIndex(t).getValueByString(Gr).toFloat():-1}getMotionFadeOutTimeValue(e,t){return this.isExistMotionFadeOut(e,t)?this._jsonValue.at(Q.FrequestNode_Motions).getValueByString(e).getValueByIndex(t).getValueByString(qr).toFloat():-1}getUserDataFile(){return this.isExistUserDataFile()?this._json.getRoot().getValueByString(Ft).getValueByString(Xr).getRawString():""}getLayoutMap(e){const t=this._json.getRoot().getValueByString("Layout").getMap();if(t==null)return!1;let s=!1;for(const a=t.begin();a.notEqual(t.end());a.preIncrement())e.setValue(a.ptr().first,a.ptr().second.toFloat()),s=!0;return s}getEyeBlinkParameterCount(){if(!this.isExistEyeBlinkParameters())return 0;let e=0;for(let t=0;t<this._jsonValue.at(Q.FrequestNode_Groups).getSize();t++){const s=this._jsonValue.at(Q.FrequestNode_Groups).getValueByIndex(t);if(!s.isNull()&&!s.isError()&&s.getValueByString(Vt).getRawString()==Rs){e=s.getValueByString(Gi).getVector().getSize();break}}return e}getEyeBlinkParameterId(e){if(!this.isExistEyeBlinkParameters())return null;for(let t=0;t<this._jsonValue.at(Q.FrequestNode_Groups).getSize();t++){const s=this._jsonValue.at(Q.FrequestNode_Groups).getValueByIndex(t);if(!s.isNull()&&!s.isError()&&s.getValueByString(Vt).getRawString()==Rs)return _.getIdManager().getId(s.getValueByString(Gi).getValueByIndex(e).getRawString())}return null}getLipSyncParameterCount(){if(!this.isExistLipSyncParameters())return 0;let e=0;for(let t=0;t<this._jsonValue.at(Q.FrequestNode_Groups).getSize();t++){const s=this._jsonValue.at(Q.FrequestNode_Groups).getValueByIndex(t);if(!s.isNull()&&!s.isError()&&s.getValueByString(Vt).getRawString()==Es){e=s.getValueByString(Gi).getVector().getSize();break}}return e}getLipSyncParameterId(e){if(!this.isExistLipSyncParameters())return null;for(let t=0;t<this._jsonValue.at(Q.FrequestNode_Groups).getSize();t++){const s=this._jsonValue.at(Q.FrequestNode_Groups).getValueByIndex(t);if(!s.isNull()&&!s.isError()&&s.getValueByString(Vt).getRawString()==Es)return _.getIdManager().getId(s.getValueByString(Gi).getValueByIndex(e).getRawString())}return null}isExistModelFile(){const e=this._jsonValue.at(Q.FrequestNode_Moc);return!e.isNull()&&!e.isError()}isExistTextureFiles(){const e=this._jsonValue.at(Q.FrequestNode_Textures);return!e.isNull()&&!e.isError()}isExistHitAreas(){const e=this._jsonValue.at(Q.FrequestNode_HitAreas);return!e.isNull()&&!e.isError()}isExistPhysicsFile(){const e=this._jsonValue.at(Q.FrequestNode_Physics);return!e.isNull()&&!e.isError()}isExistPoseFile(){const e=this._jsonValue.at(Q.FrequestNode_Pose);return!e.isNull()&&!e.isError()}isExistExpressionFile(){const e=this._jsonValue.at(Q.FrequestNode_Expressions);return!e.isNull()&&!e.isError()}isExistMotionGroups(){const e=this._jsonValue.at(Q.FrequestNode_Motions);return!e.isNull()&&!e.isError()}isExistMotionGroupName(e){const t=this._jsonValue.at(Q.FrequestNode_Motions).getValueByString(e);return!t.isNull()&&!t.isError()}isExistMotionSoundFile(e,t){const s=this._jsonValue.at(Q.FrequestNode_Motions).getValueByString(e).getValueByIndex(t).getValueByString(Yr);return!s.isNull()&&!s.isError()}isExistMotionFadeIn(e,t){const s=this._jsonValue.at(Q.FrequestNode_Motions).getValueByString(e).getValueByIndex(t).getValueByString(Gr);return!s.isNull()&&!s.isError()}isExistMotionFadeOut(e,t){const s=this._jsonValue.at(Q.FrequestNode_Motions).getValueByString(e).getValueByIndex(t).getValueByString(qr);return!s.isNull()&&!s.isError()}isExistUserDataFile(){const e=this._json.getRoot().getValueByString(Ft).getValueByString(Xr);return!e.isNull()&&!e.isError()}isExistEyeBlinkParameters(){if(this._jsonValue.at(Q.FrequestNode_Groups).isNull()||this._jsonValue.at(Q.FrequestNode_Groups).isError())return!1;for(let e=0;e<this._jsonValue.at(Q.FrequestNode_Groups).getSize();++e)if(this._jsonValue.at(Q.FrequestNode_Groups).getValueByIndex(e).getValueByString(Vt).getRawString()==Rs)return!0;return!1}isExistLipSyncParameters(){if(this._jsonValue.at(Q.FrequestNode_Groups).isNull()||this._jsonValue.at(Q.FrequestNode_Groups).isError())return!1;for(let e=0;e<this._jsonValue.at(Q.FrequestNode_Groups).getSize();++e)if(this._jsonValue.at(Q.FrequestNode_Groups).getValueByIndex(e).getValueByString(Vt).getRawString()==Es)return!0;return!1}}(function(n){n.CubismModelSettingJson=Jr})(Wr||(Wr={}));class Bi{static create(){return new Bi}static delete(e){}setParameters(e){this._breathParameters=e}getParameters(){return this._breathParameters}updateParameters(e,t){this._currentTime+=t;const s=2*this._currentTime*3.14159;for(let a=0;a<this._breathParameters.getSize();++a){const l=this._breathParameters.at(a);e.addParameterValueById(l.parameterId,l.offset+l.peak*Math.sin(s/l.cycle),l.weight)}}constructor(){this._currentTime=0}}class ii{constructor(e,t,s,a,l){this.parameterId=e??null,this.offset=t??0,this.peak=s??0,this.cycle=a??0,this.weight=l??0}}(function(n){n.BreathParameterData=ii,n.CubismBreath=Bi})($r||($r={}));class zt{static create(e=null){return new zt(e)}static delete(e){}setBlinkingInterval(e){this._blinkingIntervalSeconds=e}setBlinkingSetting(e,t,s){this._closingSeconds=e,this._closedSeconds=t,this._openingSeconds=s}setParameterIds(e){this._parameterIds=e}getParameterIds(){return this._parameterIds}updateParameters(e,t){let s;this._userTimeSeconds+=t;let a=0;switch(this._blinkingState){case Ge.EyeState_Closing:a=(this._userTimeSeconds-this._stateStartTimeSeconds)/this._closingSeconds,a>=1&&(a=1,this._blinkingState=Ge.EyeState_Closed,this._stateStartTimeSeconds=this._userTimeSeconds),s=1-a;break;case Ge.EyeState_Closed:a=(this._userTimeSeconds-this._stateStartTimeSeconds)/this._closedSeconds,a>=1&&(this._blinkingState=Ge.EyeState_Opening,this._stateStartTimeSeconds=this._userTimeSeconds),s=0;break;case Ge.EyeState_Opening:a=(this._userTimeSeconds-this._stateStartTimeSeconds)/this._openingSeconds,a>=1&&(a=1,this._blinkingState=Ge.EyeState_Interval,this._nextBlinkingTime=this.determinNextBlinkingTiming()),s=a;break;case Ge.EyeState_Interval:this._nextBlinkingTime<this._userTimeSeconds&&(this._blinkingState=Ge.EyeState_Closing,this._stateStartTimeSeconds=this._userTimeSeconds),s=1;break;case Ge.EyeState_First:default:this._blinkingState=Ge.EyeState_Interval,this._nextBlinkingTime=this.determinNextBlinkingTiming(),s=1}zt.CloseIfZero||(s=-s);for(let l=0;l<this._parameterIds.getSize();++l)e.setParameterValueById(this._parameterIds.at(l),s)}constructor(e){if(this._blinkingState=Ge.EyeState_First,this._nextBlinkingTime=0,this._stateStartTimeSeconds=0,this._blinkingIntervalSeconds=4,this._closingSeconds=.1,this._closedSeconds=.05,this._openingSeconds=.15,this._userTimeSeconds=0,this._parameterIds=new S,e!=null)for(let t=0;t<e.getEyeBlinkParameterCount();++t)this._parameterIds.pushBack(e.getEyeBlinkParameterId(t))}determinNextBlinkingTiming(){const e=Math.random();return this._userTimeSeconds+e*(2*this._blinkingIntervalSeconds-1)}}zt.CloseIfZero=!0,function(n){n[n.EyeState_First=0]="EyeState_First",n[n.EyeState_Interval=1]="EyeState_Interval",n[n.EyeState_Closing=2]="EyeState_Closing",n[n.EyeState_Closed=3]="EyeState_Closed",n[n.EyeState_Opening=4]="EyeState_Opening"}(Ge||(Ge={})),function(n){n.CubismEyeBlink=zt,n.EyeState=Ge}(Kr||(Kr={}));const Zr="FadeInTime",Qr="Link";class Mi{static create(e,t){const s=new Mi,a=de.create(e,t),l=a.getRoot();l.getValueByString(Zr).isNull()||(s._fadeTimeSeconds=l.getValueByString(Zr).toFloat(.5),s._fadeTimeSeconds<=0&&(s._fadeTimeSeconds=.5));const g=l.getValueByString("Groups"),c=g.getSize();for(let f=0;f<c;++f){const y=g.getValueByIndex(f),p=y.getSize();let I=0;for(let B=0;B<p;++B){const M=y.getValueByIndex(B),v=new Pi,O=_.getIdManager().getId(M.getValueByString("Id").getRawString());if(v.partId=O,!M.getValueByString(Qr).isNull()){const k=M.getValueByString(Qr),W=k.getSize();for(let H=0;H<W;++H){const ee=new Pi,D=_.getIdManager().getId(k.getValueByIndex(H).getString());ee.partId=D,v.link.pushBack(ee)}}s._partGroups.pushBack(v.clone()),++I}s._partGroupCounts.pushBack(I)}return de.delete(a),s}static delete(e){}updateParameters(e,t){e!=this._lastModel&&this.reset(e),this._lastModel=e,t<0&&(t=0);let s=0;for(let a=0;a<this._partGroupCounts.getSize();a++){const l=this._partGroupCounts.at(a);this.doFade(e,t,s,l),s+=l}this.copyPartOpacities(e)}reset(e){let t=0;for(let s=0;s<this._partGroupCounts.getSize();++s){const a=this._partGroupCounts.at(s);for(let l=t;l<t+a;++l){this._partGroups.at(l).initialize(e);const g=this._partGroups.at(l).partIndex,c=this._partGroups.at(l).parameterIndex;if(!(g<0)){e.setPartOpacityByIndex(g,l==t?1:0),e.setParameterValueByIndex(c,l==t?1:0);for(let f=0;f<this._partGroups.at(l).link.getSize();++f)this._partGroups.at(l).link.at(f).initialize(e)}}t+=a}}copyPartOpacities(e){for(let t=0;t<this._partGroups.getSize();++t){const s=this._partGroups.at(t);if(s.link.getSize()==0)continue;const a=this._partGroups.at(t).partIndex,l=e.getPartOpacityByIndex(a);for(let g=0;g<s.link.getSize();++g){const c=s.link.at(g).partIndex;c<0||e.setPartOpacityByIndex(c,l)}}}doFade(e,t,s,a){let l=-1,g=1;for(let c=s;c<s+a;++c){const f=this._partGroups.at(c).partIndex,y=this._partGroups.at(c).parameterIndex;if(e.getParameterValueByIndex(y)>.001){if(l>=0)break;l=c,g=e.getPartOpacityByIndex(f),g+=t/this._fadeTimeSeconds,g>1&&(g=1)}}l<0&&(l=0,g=1);for(let c=s;c<s+a;++c){const f=this._partGroups.at(c).partIndex;if(l==c)e.setPartOpacityByIndex(f,g);else{let y,p=e.getPartOpacityByIndex(f);y=g<.5?-.5*g/.5+1:.5*(1-g)/.5,(1-y)*(1-g)>.15&&(y=1-.15/(1-g)),p>y&&(p=y),e.setPartOpacityByIndex(f,p)}}}constructor(){this._fadeTimeSeconds=.5,this._lastModel=null,this._partGroups=new S,this._partGroupCounts=new S}}class Pi{constructor(e){if(this.parameterIndex=0,this.partIndex=0,this.link=new S,e!=null){this.partId=e.partId;for(const t=e.link.begin();t.notEqual(e.link.end());t.preIncrement())this.link.pushBack(t.ptr().clone())}}assignment(e){this.partId=e.partId;for(const t=e.link.begin();t.notEqual(e.link.end());t.preIncrement())this.link.pushBack(t.ptr().clone());return this}initialize(e){this.parameterIndex=e.getParameterIndex(this.partId),this.partIndex=e.getPartIndex(this.partId),e.setParameterValueByIndex(this.parameterIndex,1)}clone(){const e=new Pi;e.partId=this.partId,e.parameterIndex=this.parameterIndex,e.partIndex=this.partIndex,e.link=new S;for(let t=this.link.begin();t.notEqual(this.link.end());t.increment())e.link.pushBack(t.ptr().clone());return e}}var en,tn,sn,rn,nn,an;(function(n){n.CubismPose=Mi,n.PartData=Pi})(en||(en={}));class on extends ie{constructor(e,t){super(),this._width=e!==void 0?e:0,this._height=t!==void 0?t:0,this.setHeight(2)}setWidth(e){const t=e/this._width,s=t;this.scale(t,s)}setHeight(e){const t=e/this._height,s=t;this.scale(t,s)}setPosition(e,t){this.translate(e,t)}setCenterPosition(e,t){this.centerX(e),this.centerY(t)}top(e){this.setY(e)}bottom(e){const t=this._height*this.getScaleY();this.translateY(e-t)}left(e){this.setX(e)}right(e){const t=this._width*this.getScaleX();this.translateX(e-t)}centerX(e){const t=this._width*this.getScaleX();this.translateX(e-t/2)}setX(e){this.translateX(e)}centerY(e){const t=this._height*this.getScaleY();this.translateY(e-t/2)}setY(e){this.translateY(e)}setupFromLayout(e){for(const t=e.begin();t.notEqual(e.end());t.preIncrement()){const s=t.ptr().first,a=t.ptr().second;s=="width"?this.setWidth(a):s=="height"&&this.setHeight(a)}for(const t=e.begin();t.notEqual(e.end());t.preIncrement()){const s=t.ptr().first,a=t.ptr().second;s=="x"?this.setX(a):s=="y"?this.setY(a):s=="center_x"?this.centerX(a):s=="center_y"?this.centerY(a):s=="top"?this.top(a):s=="bottom"?this.bottom(a):s=="left"?this.left(a):s=="right"&&this.right(a)}}}(function(n){n.CubismModelMatrix=on})(tn||(tn={}));class q{constructor(e,t){this.x=e,this.y=t,this.x=e??0,this.y=t??0}add(e){const t=new q(0,0);return t.x=this.x+e.x,t.y=this.y+e.y,t}substract(e){const t=new q(0,0);return t.x=this.x-e.x,t.y=this.y-e.y,t}multiply(e){const t=new q(0,0);return t.x=this.x*e.x,t.y=this.y*e.y,t}multiplyByScaler(e){return this.multiply(new q(e,e))}division(e){const t=new q(0,0);return t.x=this.x/e.x,t.y=this.y/e.y,t}divisionByScalar(e){return this.division(new q(e,e))}getLength(){return Math.sqrt(this.x*this.x+this.y*this.y)}getDistanceWith(e){return Math.sqrt((this.x-e.x)*(this.x-e.x)+(this.y-e.y)*(this.y-e.y))}dot(e){return this.x*e.x+this.y*e.y}normalize(){const e=Math.pow(this.x*this.x+this.y*this.y,.5);this.x=this.x/e,this.y=this.y/e}isEqual(e){return this.x==e.x&&this.y==e.y}isNotEqual(e){return!this.isEqual(e)}}(function(n){n.CubismVector2=q})(sn||(sn={}));class J{static range(e,t,s){return e<t?e=t:e>s&&(e=s),e}static sin(e){return Math.sin(e)}static cos(e){return Math.cos(e)}static abs(e){return Math.abs(e)}static sqrt(e){return Math.sqrt(e)}static cbrt(e){if(e===0)return e;let t=e;const s=t<0;let a;return s&&(t=-t),t===1/0?a=1/0:(a=Math.exp(Math.log(t)/3),a=(t/(a*a)+2*a)/3),s?-a:a}static getEasingSine(e){return e<0?0:e>1?1:.5-.5*this.cos(e*Math.PI)}static max(e,t){return e>t?e:t}static min(e,t){return e>t?t:e}static degreesToRadian(e){return e/180*Math.PI}static radianToDegrees(e){return 180*e/Math.PI}static directionToRadian(e,t){let s=Math.atan2(t.y,t.x)-Math.atan2(e.y,e.x);for(;s<-Math.PI;)s+=2*Math.PI;for(;s>Math.PI;)s-=2*Math.PI;return s}static directionToDegrees(e,t){const s=this.directionToRadian(e,t);let a=this.radianToDegrees(s);return t.x-e.x>0&&(a=-a),a}static radianToDirection(e){const t=new q;return t.x=this.sin(e),t.y=this.cos(e),t}static quadraticEquation(e,t,s){return this.abs(e)<J.Epsilon?this.abs(t)<J.Epsilon?-s:-s/t:-(t+this.sqrt(t*t-4*e*s))/(2*e)}static cardanoAlgorithmForBezier(e,t,s,a){if(this.sqrt(e)<J.Epsilon)return this.range(this.quadraticEquation(t,s,a),0,1);const l=t/e,g=s/e,c=(3*g-l*l)/3,f=c/3,y=(2*l*l*l-9*l*g+a/e*27)/27,p=y/2,I=p*p+f*f*f,B=.51;if(I<0){const O=-c/3,k=O*O*O,W=this.sqrt(k),H=-y/(2*W),ee=this.range(H,-1,1),D=Math.acos(ee),ve=2*this.cbrt(W),ue=ve*this.cos(D/3)-l/3;if(this.abs(ue-.5)<B)return this.range(ue,0,1);const he=ve*this.cos((D+2*Math.PI)/3)-l/3;if(this.abs(he-.5)<B)return this.range(he,0,1);const le=ve*this.cos((D+4*Math.PI)/3)-l/3;return this.range(le,0,1)}if(I==0){let O;O=p<0?this.cbrt(-p):-this.cbrt(p);const k=2*O-l/3;if(this.abs(k-.5)<B)return this.range(k,0,1);const W=-O-l/3;return this.range(W,0,1)}const M=this.sqrt(I),v=this.cbrt(M-p)-this.cbrt(M+p)-l/3;return this.range(v,0,1)}constructor(){}}J.Epsilon=1e-5,function(n){n.CubismMath=J}(rn||(rn={}));class ln{constructor(){this._faceTargetX=0,this._faceTargetY=0,this._faceX=0,this._faceY=0,this._faceVX=0,this._faceVY=0,this._lastTimeSeconds=0,this._userTimeSeconds=0}update(e){this._userTimeSeconds+=e;const t=4/30;if(this._lastTimeSeconds==0)return void(this._lastTimeSeconds=this._userTimeSeconds);const s=30*(this._userTimeSeconds-this._lastTimeSeconds);this._lastTimeSeconds=this._userTimeSeconds;const a=s*t/4.5,l=this._faceTargetX-this._faceX,g=this._faceTargetY-this._faceY;if(J.abs(l)<=.01&&J.abs(g)<=.01)return;const c=J.sqrt(l*l+g*g),f=t*g/c;let y=t*l/c-this._faceVX,p=f-this._faceVY;const I=J.sqrt(y*y+p*p);(I<-a||I>a)&&(y*=a/I,p*=a/I),this._faceVX+=y,this._faceVY+=p;{const B=.5*(J.sqrt(a*a+16*a*c-8*a*c)-a),M=J.sqrt(this._faceVX*this._faceVX+this._faceVY*this._faceVY);M>B&&(this._faceVX*=B/M,this._faceVY*=B/M)}this._faceX+=this._faceVX,this._faceY+=this._faceVY}getX(){return this._faceX}getY(){return this._faceY}set(e,t){this._faceTargetX=e,this._faceTargetY=t}}(function(n){n.CubismTargetPoint=ln})(nn||(nn={}));class si{static delete(e){e.release(),e=null}constructor(){this.setFinishedMotionHandler=e=>this._onFinishedMotion=e,this.getFinishedMotionHandler=()=>this._onFinishedMotion,this._fadeInSeconds=-1,this._fadeOutSeconds=-1,this._weight=1,this._offsetSeconds=0,this._firedEventValues=new S}release(){this._weight=0}updateParameters(e,t,s){if(!t.isAvailable()||t.isFinished())return;if(!t.isStarted()){t.setIsStarted(!0),t.setStartTime(s-this._offsetSeconds),t.setFadeInStartTime(s);const l=this.getDuration();t.getEndTime()<0&&t.setEndTime(l<=0?-1:t.getStartTime()+l)}let a=this._weight;a=a*(this._fadeInSeconds==0?1:J.getEasingSine((s-t.getFadeInStartTime())/this._fadeInSeconds))*(this._fadeOutSeconds==0||t.getEndTime()<0?1:J.getEasingSine((t.getEndTime()-s)/this._fadeOutSeconds)),t.setState(s,a),Se(0<=a&&a<=1),this.doUpdateParameters(e,s,a,t),t.getEndTime()>0&&t.getEndTime()<s&&t.setIsFinished(!0)}setFadeInTime(e){this._fadeInSeconds=e}setFadeOutTime(e){this._fadeOutSeconds=e}getFadeOutTime(){return this._fadeOutSeconds}getFadeInTime(){return this._fadeInSeconds}setWeight(e){this._weight=e}getWeight(){return this._weight}getDuration(){return-1}getLoopDuration(){return-1}setOffsetTime(e){this._offsetSeconds=e}getFiredEvent(e,t){return this._firedEventValues}isExistModelOpacity(){return!1}getModelOpacityIndex(){return-1}getModelOpacityId(e){return null}getModelOpacityValue(){return 1}}(function(n){n.ACubismMotion=si})(an||(an={}));const un="Parameters",qi="Blend";class Wi extends si{static create(e,t){const s=new Wi;return s.parse(e,t),s}doUpdateParameters(e,t,s,a){for(let l=0;l<this._parameters.getSize();++l){const g=this._parameters.at(l);switch(g.blendType){case gt.ExpressionBlendType_Add:e.addParameterValueById(g.parameterId,g.value,s);break;case gt.ExpressionBlendType_Multiply:e.multiplyParameterValueById(g.parameterId,g.value,s);break;case gt.ExpressionBlendType_Overwrite:e.setParameterValueById(g.parameterId,g.value,s)}}}parse(e,t){const s=de.create(e,t),a=s.getRoot();this.setFadeInTime(a.getValueByString("FadeInTime").toFloat(1)),this.setFadeOutTime(a.getValueByString("FadeOutTime").toFloat(1));const l=a.getValueByString(un).getSize();this._parameters.prepareCapacity(l);for(let g=0;g<l;++g){const c=a.getValueByString(un).getValueByIndex(g),f=_.getIdManager().getId(c.getValueByString("Id").getRawString()),y=c.getValueByString("Value").toFloat();let p;p=c.getValueByString(qi).isNull()||c.getValueByString(qi).getString()=="Add"?gt.ExpressionBlendType_Add:c.getValueByString(qi).getString()=="Multiply"?gt.ExpressionBlendType_Multiply:c.getValueByString(qi).getString()=="Overwrite"?gt.ExpressionBlendType_Overwrite:gt.ExpressionBlendType_Add;const I=new dn;I.parameterId=f,I.blendType=p,I.value=y,this._parameters.pushBack(I)}de.delete(s)}constructor(){super(),this._parameters=new S}}var gt,hn,Ke,st,cn;(function(n){n[n.ExpressionBlendType_Add=0]="ExpressionBlendType_Add",n[n.ExpressionBlendType_Multiply=1]="ExpressionBlendType_Multiply",n[n.ExpressionBlendType_Overwrite=2]="ExpressionBlendType_Overwrite"})(gt||(gt={}));class dn{}(function(n){n.CubismExpressionMotion=Wi,n.ExpressionBlendType=gt,n.ExpressionParameter=dn})(hn||(hn={})),function(n){n[n.CubismMotionCurveTarget_Model=0]="CubismMotionCurveTarget_Model",n[n.CubismMotionCurveTarget_Parameter=1]="CubismMotionCurveTarget_Parameter",n[n.CubismMotionCurveTarget_PartOpacity=2]="CubismMotionCurveTarget_PartOpacity"}(Ke||(Ke={})),function(n){n[n.CubismMotionSegmentType_Linear=0]="CubismMotionSegmentType_Linear",n[n.CubismMotionSegmentType_Bezier=1]="CubismMotionSegmentType_Bezier",n[n.CubismMotionSegmentType_Stepped=2]="CubismMotionSegmentType_Stepped",n[n.CubismMotionSegmentType_InverseStepped=3]="CubismMotionSegmentType_InverseStepped"}(st||(st={}));class Fs{constructor(){this.time=0,this.value=0}}class gn{constructor(){this.evaluate=null,this.basePointIndex=0,this.segmentType=0}}class _n{constructor(){this.type=Ke.CubismMotionCurveTarget_Model,this.segmentCount=0,this.baseSegmentIndex=0,this.fadeInTime=0,this.fadeOutTime=0}}class fn{constructor(){this.fireTime=0}}class mn{constructor(){this.duration=0,this.loop=!1,this.curveCount=0,this.eventCount=0,this.fps=0,this.curves=new S,this.segments=new S,this.points=new S,this.events=new S}}(function(n){n.CubismMotionCurve=_n,n.CubismMotionCurveTarget=Ke,n.CubismMotionData=mn,n.CubismMotionEvent=fn,n.CubismMotionPoint=Fs,n.CubismMotionSegment=gn,n.CubismMotionSegmentType=st})(cn||(cn={}));const Je="Meta",At="Curves",$i="FadeInTime",Ki="FadeOutTime",pn="Segments",yn="UserData";class xn{constructor(e,t){this._json=de.create(e,t)}release(){de.delete(this._json)}getMotionDuration(){return this._json.getRoot().getValueByString(Je).getValueByString("Duration").toFloat()}isMotionLoop(){return this._json.getRoot().getValueByString(Je).getValueByString("Loop").toBoolean()}getEvaluationOptionFlag(e){return Ji.EvaluationOptionFlag_AreBeziersRistricted==e&&this._json.getRoot().getValueByString(Je).getValueByString("AreBeziersRestricted").toBoolean()}getMotionCurveCount(){return this._json.getRoot().getValueByString(Je).getValueByString("CurveCount").toInt()}getMotionFps(){return this._json.getRoot().getValueByString(Je).getValueByString("Fps").toFloat()}getMotionTotalSegmentCount(){return this._json.getRoot().getValueByString(Je).getValueByString("TotalSegmentCount").toInt()}getMotionTotalPointCount(){return this._json.getRoot().getValueByString(Je).getValueByString("TotalPointCount").toInt()}isExistMotionFadeInTime(){return!this._json.getRoot().getValueByString(Je).getValueByString($i).isNull()}isExistMotionFadeOutTime(){return!this._json.getRoot().getValueByString(Je).getValueByString(Ki).isNull()}getMotionFadeInTime(){return this._json.getRoot().getValueByString(Je).getValueByString($i).toFloat()}getMotionFadeOutTime(){return this._json.getRoot().getValueByString(Je).getValueByString(Ki).toFloat()}getMotionCurveTarget(e){return this._json.getRoot().getValueByString(At).getValueByIndex(e).getValueByString("Target").getRawString()}getMotionCurveId(e){return _.getIdManager().getId(this._json.getRoot().getValueByString(At).getValueByIndex(e).getValueByString("Id").getRawString())}isExistMotionCurveFadeInTime(e){return!this._json.getRoot().getValueByString(At).getValueByIndex(e).getValueByString($i).isNull()}isExistMotionCurveFadeOutTime(e){return!this._json.getRoot().getValueByString(At).getValueByIndex(e).getValueByString(Ki).isNull()}getMotionCurveFadeInTime(e){return this._json.getRoot().getValueByString(At).getValueByIndex(e).getValueByString($i).toFloat()}getMotionCurveFadeOutTime(e){return this._json.getRoot().getValueByString(At).getValueByIndex(e).getValueByString(Ki).toFloat()}getMotionCurveSegmentCount(e){return this._json.getRoot().getValueByString(At).getValueByIndex(e).getValueByString(pn).getVector().getSize()}getMotionCurveSegment(e,t){return this._json.getRoot().getValueByString(At).getValueByIndex(e).getValueByString(pn).getValueByIndex(t).toFloat()}getEventCount(){return this._json.getRoot().getValueByString(Je).getValueByString("UserDataCount").toInt()}getTotalEventValueSize(){return this._json.getRoot().getValueByString(Je).getValueByString("TotalUserDataSize").toInt()}getEventTime(e){return this._json.getRoot().getValueByString(yn).getValueByIndex(e).getValueByString("Time").toFloat()}getEventValue(e){return new L(this._json.getRoot().getValueByString(yn).getValueByIndex(e).getValueByString("Value").getRawString())}}var Ji,Sn;(function(n){n[n.EvaluationOptionFlag_AreBeziersRistricted=0]="EvaluationOptionFlag_AreBeziersRistricted"})(Ji||(Ji={})),function(n){n.CubismMotionJson=xn}(Sn||(Sn={}));const Zi="Opacity";function rt(n,e,t){const s=new Fs;return s.time=n.time+(e.time-n.time)*t,s.value=n.value+(e.value-n.value)*t,s}function Ao(n,e){let t=(e-n[0].time)/(n[1].time-n[0].time);return t<0&&(t=0),n[0].value+(n[1].value-n[0].value)*t}function Lo(n,e){let t=(e-n[0].time)/(n[3].time-n[0].time);t<0&&(t=0);const s=rt(n[0],n[1],t),a=rt(n[1],n[2],t),l=rt(n[2],n[3],t),g=rt(s,a,t),c=rt(a,l,t);return rt(g,c,t).value}function Do(n,e){const t=e,s=n[0].time,a=n[3].time,l=n[1].time,g=n[2].time,c=a-3*g+3*l-s,f=3*g-6*l+3*s,y=3*l-3*s,p=s-t,I=J.cardanoAlgorithmForBezier(c,f,y,p),B=rt(n[0],n[1],I),M=rt(n[1],n[2],I),v=rt(n[2],n[3],I),O=rt(B,M,I),k=rt(M,v,I);return rt(O,k,I).value}function Oo(n,e){return n[0].value}function ko(n,e){return n[1].value}function Vs(n,e,t){const s=n.curves.at(e);let a=-1;const l=s.baseSegmentIndex+s.segmentCount;let g=0;for(let f=s.baseSegmentIndex;f<l;++f)if(g=n.segments.at(f).basePointIndex+(n.segments.at(f).segmentType==st.CubismMotionSegmentType_Bezier?3:1),n.points.at(g).time>t){a=f;break}if(a==-1)return n.points.at(g).value;const c=n.segments.at(a);return c.evaluate(n.points.get(c.basePointIndex),t)}class Qi extends si{static create(e,t,s){const a=new Qi;return a.parse(e,t),a._sourceFrameRate=a._motionData.fps,a._loopDurationSeconds=a._motionData.duration,a._onFinishedMotion=s,a}doUpdateParameters(e,t,s,a){this._modelCurveIdEyeBlink==null&&(this._modelCurveIdEyeBlink=_.getIdManager().getId("EyeBlink")),this._modelCurveIdLipSync==null&&(this._modelCurveIdLipSync=_.getIdManager().getId("LipSync")),this._modelCurveIdOpacity==null&&(this._modelCurveIdOpacity=_.getIdManager().getId(Zi));let l=t-a.getStartTime();l<0&&(l=0);let g=Number.MAX_VALUE,c=Number.MAX_VALUE;const f=64;let y=0,p=0;this._eyeBlinkParameterIds.getSize()>f&&we("too many eye blink targets : {0}",this._eyeBlinkParameterIds.getSize()),this._lipSyncParameterIds.getSize()>f&&we("too many lip sync targets : {0}",this._lipSyncParameterIds.getSize());const I=this._fadeInSeconds<=0?1:J.getEasingSine((t-a.getFadeInStartTime())/this._fadeInSeconds),B=this._fadeOutSeconds<=0||a.getEndTime()<0?1:J.getEasingSine((a.getEndTime()-t)/this._fadeOutSeconds);let M,v,O,k=l;if(this._isLoop)for(;k>this._motionData.duration;)k-=this._motionData.duration;const W=this._motionData.curves;for(v=0;v<this._motionData.curveCount&&W.at(v).type==Ke.CubismMotionCurveTarget_Model;++v)M=Vs(this._motionData,v,k),W.at(v).id==this._modelCurveIdEyeBlink?c=M:W.at(v).id==this._modelCurveIdLipSync?g=M:W.at(v).id==this._modelCurveIdOpacity&&(this._modelOpacity=M,e.setModelOapcity(this.getModelOpacityValue()));for(;v<this._motionData.curveCount&&W.at(v).type==Ke.CubismMotionCurveTarget_Parameter;++v){if(O=e.getParameterIndex(W.at(v).id),O==-1)continue;const H=e.getParameterValueByIndex(O);if(M=Vs(this._motionData,v,k),c!=Number.MAX_VALUE){for(let D=0;D<this._eyeBlinkParameterIds.getSize()&&D<f;++D)if(this._eyeBlinkParameterIds.at(D)==W.at(v).id){M*=c,p|=1<<D;break}}if(g!=Number.MAX_VALUE){for(let D=0;D<this._lipSyncParameterIds.getSize()&&D<f;++D)if(this._lipSyncParameterIds.at(D)==W.at(v).id){M+=g,y|=1<<D;break}}let ee;if(W.at(v).fadeInTime<0&&W.at(v).fadeOutTime<0)ee=H+(M-H)*s;else{let D,ve;D=W.at(v).fadeInTime<0?I:W.at(v).fadeInTime==0?1:J.getEasingSine((t-a.getFadeInStartTime())/W.at(v).fadeInTime),ve=W.at(v).fadeOutTime<0?B:W.at(v).fadeOutTime==0||a.getEndTime()<0?1:J.getEasingSine((a.getEndTime()-t)/W.at(v).fadeOutTime),ee=H+(M-H)*(this._weight*D*ve)}e.setParameterValueByIndex(O,ee,1)}if(c!=Number.MAX_VALUE)for(let H=0;H<this._eyeBlinkParameterIds.getSize()&&H<f;++H){const ee=e.getParameterValueById(this._eyeBlinkParameterIds.at(H));if(p>>H&1)continue;const D=ee+(c-ee)*s;e.setParameterValueById(this._eyeBlinkParameterIds.at(H),D)}if(g!=Number.MAX_VALUE)for(let H=0;H<this._lipSyncParameterIds.getSize()&&H<f;++H){const ee=e.getParameterValueById(this._lipSyncParameterIds.at(H));if(y>>H&1)continue;const D=ee+(g-ee)*s;e.setParameterValueById(this._lipSyncParameterIds.at(H),D)}for(;v<this._motionData.curveCount&&W.at(v).type==Ke.CubismMotionCurveTarget_PartOpacity;++v)O=e.getParameterIndex(W.at(v).id),O!=-1&&(M=Vs(this._motionData,v,k),e.setParameterValueByIndex(O,M));l>=this._motionData.duration&&(this._isLoop?(a.setStartTime(t),this._isLoopFadeIn&&a.setFadeInStartTime(t)):(this._onFinishedMotion&&this._onFinishedMotion(this),a.setIsFinished(!0))),this._lastWeight=s}setIsLoop(e){this._isLoop=e}isLoop(){return this._isLoop}setIsLoopFadeIn(e){this._isLoopFadeIn=e}isLoopFadeIn(){return this._isLoopFadeIn}getDuration(){return this._isLoop?-1:this._loopDurationSeconds}getLoopDuration(){return this._loopDurationSeconds}setParameterFadeInTime(e,t){const s=this._motionData.curves;for(let a=0;a<this._motionData.curveCount;++a)if(e==s.at(a).id)return void(s.at(a).fadeInTime=t)}setParameterFadeOutTime(e,t){const s=this._motionData.curves;for(let a=0;a<this._motionData.curveCount;++a)if(e==s.at(a).id)return void(s.at(a).fadeOutTime=t)}getParameterFadeInTime(e){const t=this._motionData.curves;for(let s=0;s<this._motionData.curveCount;++s)if(e==t.at(s).id)return t.at(s).fadeInTime;return-1}getParameterFadeOutTime(e){const t=this._motionData.curves;for(let s=0;s<this._motionData.curveCount;++s)if(e==t.at(s).id)return t.at(s).fadeOutTime;return-1}setEffectIds(e,t){this._eyeBlinkParameterIds=e,this._lipSyncParameterIds=t}constructor(){super(),this._sourceFrameRate=30,this._loopDurationSeconds=-1,this._isLoop=!1,this._isLoopFadeIn=!0,this._lastWeight=0,this._motionData=null,this._modelCurveIdEyeBlink=null,this._modelCurveIdLipSync=null,this._modelCurveIdOpacity=null,this._eyeBlinkParameterIds=null,this._lipSyncParameterIds=null,this._modelOpacity=1}release(){this._motionData=void 0,this._motionData=null}parse(e,t){this._motionData=new mn;let s=new xn(e,t);this._motionData.duration=s.getMotionDuration(),this._motionData.loop=s.isMotionLoop(),this._motionData.curveCount=s.getMotionCurveCount(),this._motionData.fps=s.getMotionFps(),this._motionData.eventCount=s.getEventCount();const a=s.getEvaluationOptionFlag(Ji.EvaluationOptionFlag_AreBeziersRistricted);s.isExistMotionFadeInTime()?this._fadeInSeconds=s.getMotionFadeInTime()<0?1:s.getMotionFadeInTime():this._fadeInSeconds=1,s.isExistMotionFadeOutTime()?this._fadeOutSeconds=s.getMotionFadeOutTime()<0?1:s.getMotionFadeOutTime():this._fadeOutSeconds=1,this._motionData.curves.updateSize(this._motionData.curveCount,_n,!0),this._motionData.segments.updateSize(s.getMotionTotalSegmentCount(),gn,!0),this._motionData.points.updateSize(s.getMotionTotalPointCount(),Fs,!0),this._motionData.events.updateSize(this._motionData.eventCount,fn,!0);let l=0,g=0;for(let c=0;c<this._motionData.curveCount;++c){s.getMotionCurveTarget(c)=="Model"?this._motionData.curves.at(c).type=Ke.CubismMotionCurveTarget_Model:s.getMotionCurveTarget(c)=="Parameter"?this._motionData.curves.at(c).type=Ke.CubismMotionCurveTarget_Parameter:s.getMotionCurveTarget(c)=="PartOpacity"?this._motionData.curves.at(c).type=Ke.CubismMotionCurveTarget_PartOpacity:Ae('Warning : Unable to get segment type from Curve! The number of "CurveCount" may be incorrect!'),this._motionData.curves.at(c).id=s.getMotionCurveId(c),this._motionData.curves.at(c).baseSegmentIndex=g,this._motionData.curves.at(c).fadeInTime=s.isExistMotionCurveFadeInTime(c)?s.getMotionCurveFadeInTime(c):-1,this._motionData.curves.at(c).fadeOutTime=s.isExistMotionCurveFadeOutTime(c)?s.getMotionCurveFadeOutTime(c):-1;for(let f=0;f<s.getMotionCurveSegmentCount(c);){switch(f==0?(this._motionData.segments.at(g).basePointIndex=l,this._motionData.points.at(l).time=s.getMotionCurveSegment(c,f),this._motionData.points.at(l).value=s.getMotionCurveSegment(c,f+1),l+=1,f+=2):this._motionData.segments.at(g).basePointIndex=l-1,s.getMotionCurveSegment(c,f)){case st.CubismMotionSegmentType_Linear:this._motionData.segments.at(g).segmentType=st.CubismMotionSegmentType_Linear,this._motionData.segments.at(g).evaluate=Ao,this._motionData.points.at(l).time=s.getMotionCurveSegment(c,f+1),this._motionData.points.at(l).value=s.getMotionCurveSegment(c,f+2),l+=1,f+=3;break;case st.CubismMotionSegmentType_Bezier:this._motionData.segments.at(g).segmentType=st.CubismMotionSegmentType_Bezier,this._motionData.segments.at(g).evaluate=a?Lo:Do,this._motionData.points.at(l).time=s.getMotionCurveSegment(c,f+1),this._motionData.points.at(l).value=s.getMotionCurveSegment(c,f+2),this._motionData.points.at(l+1).time=s.getMotionCurveSegment(c,f+3),this._motionData.points.at(l+1).value=s.getMotionCurveSegment(c,f+4),this._motionData.points.at(l+2).time=s.getMotionCurveSegment(c,f+5),this._motionData.points.at(l+2).value=s.getMotionCurveSegment(c,f+6),l+=3,f+=7;break;case st.CubismMotionSegmentType_Stepped:this._motionData.segments.at(g).segmentType=st.CubismMotionSegmentType_Stepped,this._motionData.segments.at(g).evaluate=Oo,this._motionData.points.at(l).time=s.getMotionCurveSegment(c,f+1),this._motionData.points.at(l).value=s.getMotionCurveSegment(c,f+2),l+=1,f+=3;break;case st.CubismMotionSegmentType_InverseStepped:this._motionData.segments.at(g).segmentType=st.CubismMotionSegmentType_InverseStepped,this._motionData.segments.at(g).evaluate=ko,this._motionData.points.at(l).time=s.getMotionCurveSegment(c,f+1),this._motionData.points.at(l).value=s.getMotionCurveSegment(c,f+2),l+=1,f+=3;break;default:Se(0)}++this._motionData.curves.at(c).segmentCount,++g}}for(let c=0;c<s.getEventCount();++c)this._motionData.events.at(c).fireTime=s.getEventTime(c),this._motionData.events.at(c).value=s.getEventValue(c);s.release(),s=void 0,s=null}getFiredEvent(e,t){this._firedEventValues.updateSize(0);for(let s=0;s<this._motionData.eventCount;++s)this._motionData.events.at(s).fireTime>e&&this._motionData.events.at(s).fireTime<=t&&this._firedEventValues.pushBack(new L(this._motionData.events.at(s).value.s));return this._firedEventValues}isExistModelOpacity(){for(let e=0;e<this._motionData.curveCount;e++){const t=this._motionData.curves.at(e);if(t.type==Ke.CubismMotionCurveTarget_Model&&t.id.getString().s.localeCompare(Zi)==0)return!0}return!1}getModelOpacityIndex(){if(this.isExistModelOpacity())for(let e=0;e<this._motionData.curveCount;e++){const t=this._motionData.curves.at(e);if(t.type==Ke.CubismMotionCurveTarget_Model&&t.id.getString().s.localeCompare(Zi)==0)return e}return-1}getModelOpacityId(e){if(e!=-1){const t=this._motionData.curves.at(e);if(t.type==Ke.CubismMotionCurveTarget_Model&&t.id.getString().s.localeCompare(Zi)==0)return _.getIdManager().getId(t.id.getString().s)}return null}getModelOpacityValue(){return this._modelOpacity}}var Cn,bn;(function(n){n.CubismMotion=Qi})(Cn||(Cn={}));class Bn{constructor(){this._autoDelete=!1,this._motion=null,this._available=!0,this._finished=!1,this._started=!1,this._startTimeSeconds=-1,this._fadeInStartTimeSeconds=0,this._endTimeSeconds=-1,this._stateTimeSeconds=0,this._stateWeight=0,this._lastEventCheckSeconds=0,this._motionQueueEntryHandle=this,this._fadeOutSeconds=0,this._isTriggeredFadeOut=!1}release(){this._autoDelete&&this._motion&&si.delete(this._motion)}setFadeOut(e){this._fadeOutSeconds=e,this._isTriggeredFadeOut=!0}startFadeOut(e,t){const s=t+e;this._isTriggeredFadeOut=!0,(this._endTimeSeconds<0||s<this._endTimeSeconds)&&(this._endTimeSeconds=s)}isFinished(){return this._finished}isStarted(){return this._started}getStartTime(){return this._startTimeSeconds}getFadeInStartTime(){return this._fadeInStartTimeSeconds}getEndTime(){return this._endTimeSeconds}setStartTime(e){this._startTimeSeconds=e}setFadeInStartTime(e){this._fadeInStartTimeSeconds=e}setEndTime(e){this._endTimeSeconds=e}setIsFinished(e){this._finished=e}setIsStarted(e){this._started=e}isAvailable(){return this._available}setIsAvailable(e){this._available=e}setState(e,t){this._stateTimeSeconds=e,this._stateWeight=t}getStateTime(){return this._stateTimeSeconds}getStateWeight(){return this._stateWeight}getLastCheckEventSeconds(){return this._lastEventCheckSeconds}setLastCheckEventSeconds(e){this._lastEventCheckSeconds=e}isTriggeredFadeOut(){return this._isTriggeredFadeOut}getFadeOutSeconds(){return this._fadeOutSeconds}}(function(n){n.CubismMotionQueueEntry=Bn})(bn||(bn={}));class Mn{constructor(){this._userTimeSeconds=0,this._eventCallBack=null,this._eventCustomData=null,this._motions=new S}release(){for(let e=0;e<this._motions.getSize();++e)this._motions.at(e)&&(this._motions.at(e).release(),this._motions.set(e,null));this._motions=null}startMotion(e,t,s){if(e==null)return es;let a=null;for(let l=0;l<this._motions.getSize();++l)a=this._motions.at(l),a!=null&&a.setFadeOut(a._motion.getFadeOutTime());return a=new Bn,a._autoDelete=t,a._motion=e,this._motions.pushBack(a),a._motionQueueEntryHandle}isFinished(){for(let e=this._motions.begin();e.notEqual(this._motions.end());){let t=e.ptr();if(t!=null)if(t._motion!=null){if(!t.isFinished())return!1;e.preIncrement()}else t.release(),t=null,e=this._motions.erase(e);else e=this._motions.erase(e)}return!0}isFinishedByHandle(e){for(let t=this._motions.begin();t.notEqual(this._motions.end());t.increment()){const s=t.ptr();if(s!=null&&s._motionQueueEntryHandle==e&&!s.isFinished())return!1}return!0}stopAllMotions(){for(let e=this._motions.begin();e.notEqual(this._motions.end());){let t=e.ptr();t!=null?(t.release(),t=null,e=this._motions.erase(e)):e=this._motions.erase(e)}}getCubismMotionQueueEntry(e){for(let t=this._motions.begin();t.notEqual(this._motions.end());t.preIncrement()){const s=t.ptr();if(s!=null&&s._motionQueueEntryHandle==e)return s}return null}setEventCallback(e,t=null){this._eventCallBack=e,this._eventCustomData=t}doUpdateMotion(e,t){let s=!1;for(let a=this._motions.begin();a.notEqual(this._motions.end());){let l=a.ptr();if(l==null){a=this._motions.erase(a);continue}const g=l._motion;if(g==null){l.release(),l=null,a=this._motions.erase(a);continue}g.updateParameters(e,l,t),s=!0;const c=g.getFiredEvent(l.getLastCheckEventSeconds()-l.getStartTime(),t-l.getStartTime());for(let f=0;f<c.getSize();++f)this._eventCallBack(this,c.at(f),this._eventCustomData);l.setLastCheckEventSeconds(t),l.isFinished()?(l.release(),l=null,a=this._motions.erase(a)):(l.isTriggeredFadeOut()&&l.startFadeOut(l.getFadeOutSeconds(),t),a.preIncrement())}return s}}const es=-1;var Pn,wn,wi,bt,vn;(function(n){n.CubismMotionQueueManager=Mn,n.InvalidMotionQueueEntryHandleValue=es})(Pn||(Pn={}));class As extends Mn{constructor(){super(),this._currentPriority=0,this._reservePriority=0}getCurrentPriority(){return this._currentPriority}getReservePriority(){return this._reservePriority}setReservePriority(e){this._reservePriority=e}startMotionPriority(e,t,s){return s==this._reservePriority&&(this._reservePriority=0),this._currentPriority=s,super.startMotion(e,t,this._userTimeSeconds)}updateMotion(e,t){this._userTimeSeconds+=t;const s=super.doUpdateMotion(e,this._userTimeSeconds);return this.isFinished()&&(this._currentPriority=0),s}reserveMotion(e){return!(e<=this._reservePriority||e<=this._currentPriority||(this._reservePriority=e,0))}}(function(n){n.CubismMotionManager=As})(wn||(wn={})),function(n){n[n.CubismPhysicsTargetType_Parameter=0]="CubismPhysicsTargetType_Parameter"}(wi||(wi={})),function(n){n[n.CubismPhysicsSource_X=0]="CubismPhysicsSource_X",n[n.CubismPhysicsSource_Y=1]="CubismPhysicsSource_Y",n[n.CubismPhysicsSource_Angle=2]="CubismPhysicsSource_Angle"}(bt||(bt={}));class No{constructor(){this.gravity=new q(0,0),this.wind=new q(0,0)}}class Ls{}class Ds{}class In{constructor(){this.initialPosition=new q(0,0),this.position=new q(0,0),this.lastPosition=new q(0,0),this.lastGravity=new q(0,0),this.force=new q(0,0),this.velocity=new q(0,0)}}class Tn{constructor(){this.normalizationPosition=new Ds,this.normalizationAngle=new Ds}}class En{constructor(){this.source=new Ls}}class Rn{constructor(){this.destination=new Ls,this.translationScale=new q(0,0)}}class Fn{constructor(){this.settings=new S,this.inputs=new S,this.outputs=new S,this.particles=new S,this.gravity=new q(0,0),this.wind=new q(0,0),this.fps=0}}(function(n){n.CubismPhysicsInput=En,n.CubismPhysicsNormalization=Ds,n.CubismPhysicsOutput=Rn,n.CubismPhysicsParameter=Ls,n.CubismPhysicsParticle=In,n.CubismPhysicsRig=Fn,n.CubismPhysicsSource=bt,n.CubismPhysicsSubRig=Tn,n.CubismPhysicsTargetType=wi,n.PhysicsJsonEffectiveForces=No})(vn||(vn={}));const vi="Position",Os="Angle",Vn="Type",Bt="Meta",ts="EffectiveForces",An="Gravity",Ln="Wind",be="PhysicsSettings",ri="Normalization",Dn="Minimum",On="Maximum",kn="Default",Nn="Reflect",Un="Weight",Ii="Input",jt="Output",Xt="Vertices";class zn{constructor(e,t){this._json=de.create(e,t)}release(){de.delete(this._json)}getGravity(){const e=new q(0,0);return e.x=this._json.getRoot().getValueByString(Bt).getValueByString(ts).getValueByString(An).getValueByString("X").toFloat(),e.y=this._json.getRoot().getValueByString(Bt).getValueByString(ts).getValueByString(An).getValueByString("Y").toFloat(),e}getWind(){const e=new q(0,0);return e.x=this._json.getRoot().getValueByString(Bt).getValueByString(ts).getValueByString(Ln).getValueByString("X").toFloat(),e.y=this._json.getRoot().getValueByString(Bt).getValueByString(ts).getValueByString(Ln).getValueByString("Y").toFloat(),e}getFps(){return this._json.getRoot().getValueByString(Bt).getValueByString("Fps").toFloat(0)}getSubRigCount(){return this._json.getRoot().getValueByString(Bt).getValueByString("PhysicsSettingCount").toInt()}getTotalInputCount(){return this._json.getRoot().getValueByString(Bt).getValueByString("TotalInputCount").toInt()}getTotalOutputCount(){return this._json.getRoot().getValueByString(Bt).getValueByString("TotalOutputCount").toInt()}getVertexCount(){return this._json.getRoot().getValueByString(Bt).getValueByString("VertexCount").toInt()}getNormalizationPositionMinimumValue(e){return this._json.getRoot().getValueByString(be).getValueByIndex(e).getValueByString(ri).getValueByString(vi).getValueByString(Dn).toFloat()}getNormalizationPositionMaximumValue(e){return this._json.getRoot().getValueByString(be).getValueByIndex(e).getValueByString(ri).getValueByString(vi).getValueByString(On).toFloat()}getNormalizationPositionDefaultValue(e){return this._json.getRoot().getValueByString(be).getValueByIndex(e).getValueByString(ri).getValueByString(vi).getValueByString(kn).toFloat()}getNormalizationAngleMinimumValue(e){return this._json.getRoot().getValueByString(be).getValueByIndex(e).getValueByString(ri).getValueByString(Os).getValueByString(Dn).toFloat()}getNormalizationAngleMaximumValue(e){return this._json.getRoot().getValueByString(be).getValueByIndex(e).getValueByString(ri).getValueByString(Os).getValueByString(On).toFloat()}getNormalizationAngleDefaultValue(e){return this._json.getRoot().getValueByString(be).getValueByIndex(e).getValueByString(ri).getValueByString(Os).getValueByString(kn).toFloat()}getInputCount(e){return this._json.getRoot().getValueByString(be).getValueByIndex(e).getValueByString(Ii).getVector().getSize()}getInputWeight(e,t){return this._json.getRoot().getValueByString(be).getValueByIndex(e).getValueByString(Ii).getValueByIndex(t).getValueByString(Un).toFloat()}getInputReflect(e,t){return this._json.getRoot().getValueByString(be).getValueByIndex(e).getValueByString(Ii).getValueByIndex(t).getValueByString(Nn).toBoolean()}getInputType(e,t){return this._json.getRoot().getValueByString(be).getValueByIndex(e).getValueByString(Ii).getValueByIndex(t).getValueByString(Vn).getRawString()}getInputSourceId(e,t){return _.getIdManager().getId(this._json.getRoot().getValueByString(be).getValueByIndex(e).getValueByString(Ii).getValueByIndex(t).getValueByString("Source").getValueByString("Id").getRawString())}getOutputCount(e){return this._json.getRoot().getValueByString(be).getValueByIndex(e).getValueByString(jt).getVector().getSize()}getOutputVertexIndex(e,t){return this._json.getRoot().getValueByString(be).getValueByIndex(e).getValueByString(jt).getValueByIndex(t).getValueByString("VertexIndex").toInt()}getOutputAngleScale(e,t){return this._json.getRoot().getValueByString(be).getValueByIndex(e).getValueByString(jt).getValueByIndex(t).getValueByString("Scale").toFloat()}getOutputWeight(e,t){return this._json.getRoot().getValueByString(be).getValueByIndex(e).getValueByString(jt).getValueByIndex(t).getValueByString(Un).toFloat()}getOutputDestinationId(e,t){return _.getIdManager().getId(this._json.getRoot().getValueByString(be).getValueByIndex(e).getValueByString(jt).getValueByIndex(t).getValueByString("Destination").getValueByString("Id").getRawString())}getOutputType(e,t){return this._json.getRoot().getValueByString(be).getValueByIndex(e).getValueByString(jt).getValueByIndex(t).getValueByString(Vn).getRawString()}getOutputReflect(e,t){return this._json.getRoot().getValueByString(be).getValueByIndex(e).getValueByString(jt).getValueByIndex(t).getValueByString(Nn).toBoolean()}getParticleCount(e){return this._json.getRoot().getValueByString(be).getValueByIndex(e).getValueByString(Xt).getVector().getSize()}getParticleMobility(e,t){return this._json.getRoot().getValueByString(be).getValueByIndex(e).getValueByString(Xt).getValueByIndex(t).getValueByString("Mobility").toFloat()}getParticleDelay(e,t){return this._json.getRoot().getValueByString(be).getValueByIndex(e).getValueByString(Xt).getValueByIndex(t).getValueByString("Delay").toFloat()}getParticleAcceleration(e,t){return this._json.getRoot().getValueByString(be).getValueByIndex(e).getValueByString(Xt).getValueByIndex(t).getValueByString("Acceleration").toFloat()}getParticleRadius(e,t){return this._json.getRoot().getValueByString(be).getValueByIndex(e).getValueByString(Xt).getValueByIndex(t).getValueByString("Radius").toFloat()}getParticlePosition(e,t){const s=new q(0,0);return s.x=this._json.getRoot().getValueByString(be).getValueByIndex(e).getValueByString(Xt).getValueByIndex(t).getValueByString(vi).getValueByString("X").toFloat(),s.y=this._json.getRoot().getValueByString(be).getValueByIndex(e).getValueByString(Xt).getValueByIndex(t).getValueByString(vi).getValueByString("Y").toFloat(),s}}var jn;(function(n){n.CubismPhysicsJson=zn})(jn||(jn={}));const Xn="Angle";class Ti{static create(e,t){const s=new Ti;return s.parse(e,t),s._physicsRig.gravity.y=0,s}static delete(e){e!=null&&(e.release(),e=null)}parse(e,t){this._physicsRig=new Fn;let s=new zn(e,t);this._physicsRig.gravity=s.getGravity(),this._physicsRig.wind=s.getWind(),this._physicsRig.subRigCount=s.getSubRigCount(),this._physicsRig.fps=s.getFps(),this._physicsRig.settings.updateSize(this._physicsRig.subRigCount,Tn,!0),this._physicsRig.inputs.updateSize(s.getTotalInputCount(),En,!0),this._physicsRig.outputs.updateSize(s.getTotalOutputCount(),Rn,!0),this._physicsRig.particles.updateSize(s.getVertexCount(),In,!0),this._currentRigOutputs.clear(),this._previousRigOutputs.clear();let a=0,l=0,g=0;for(let c=0;c<this._physicsRig.settings.getSize();++c){this._physicsRig.settings.at(c).normalizationPosition.minimum=s.getNormalizationPositionMinimumValue(c),this._physicsRig.settings.at(c).normalizationPosition.maximum=s.getNormalizationPositionMaximumValue(c),this._physicsRig.settings.at(c).normalizationPosition.defalut=s.getNormalizationPositionDefaultValue(c),this._physicsRig.settings.at(c).normalizationAngle.minimum=s.getNormalizationAngleMinimumValue(c),this._physicsRig.settings.at(c).normalizationAngle.maximum=s.getNormalizationAngleMaximumValue(c),this._physicsRig.settings.at(c).normalizationAngle.defalut=s.getNormalizationAngleDefaultValue(c),this._physicsRig.settings.at(c).inputCount=s.getInputCount(c),this._physicsRig.settings.at(c).baseInputIndex=a;for(let p=0;p<this._physicsRig.settings.at(c).inputCount;++p)this._physicsRig.inputs.at(a+p).sourceParameterIndex=-1,this._physicsRig.inputs.at(a+p).weight=s.getInputWeight(c,p),this._physicsRig.inputs.at(a+p).reflect=s.getInputReflect(c,p),s.getInputType(c,p)=="X"?(this._physicsRig.inputs.at(a+p).type=bt.CubismPhysicsSource_X,this._physicsRig.inputs.at(a+p).getNormalizedParameterValue=Uo):s.getInputType(c,p)=="Y"?(this._physicsRig.inputs.at(a+p).type=bt.CubismPhysicsSource_Y,this._physicsRig.inputs.at(a+p).getNormalizedParameterValue=zo):s.getInputType(c,p)==Xn&&(this._physicsRig.inputs.at(a+p).type=bt.CubismPhysicsSource_Angle,this._physicsRig.inputs.at(a+p).getNormalizedParameterValue=jo),this._physicsRig.inputs.at(a+p).source.targetType=wi.CubismPhysicsTargetType_Parameter,this._physicsRig.inputs.at(a+p).source.id=s.getInputSourceId(c,p);a+=this._physicsRig.settings.at(c).inputCount,this._physicsRig.settings.at(c).outputCount=s.getOutputCount(c),this._physicsRig.settings.at(c).baseOutputIndex=l;const f=new Yn;f.outputs.resize(this._physicsRig.settings.at(c).outputCount);const y=new Yn;y.outputs.resize(this._physicsRig.settings.at(c).outputCount);for(let p=0;p<this._physicsRig.settings.at(c).outputCount;++p)f.outputs.set(p,0),y.outputs.set(p,0),this._physicsRig.outputs.at(l+p).destinationParameterIndex=-1,this._physicsRig.outputs.at(l+p).vertexIndex=s.getOutputVertexIndex(c,p),this._physicsRig.outputs.at(l+p).angleScale=s.getOutputAngleScale(c,p),this._physicsRig.outputs.at(l+p).weight=s.getOutputWeight(c,p),this._physicsRig.outputs.at(l+p).destination.targetType=wi.CubismPhysicsTargetType_Parameter,this._physicsRig.outputs.at(l+p).destination.id=s.getOutputDestinationId(c,p),s.getOutputType(c,p)=="X"?(this._physicsRig.outputs.at(l+p).type=bt.CubismPhysicsSource_X,this._physicsRig.outputs.at(l+p).getValue=Xo,this._physicsRig.outputs.at(l+p).getScale=Go):s.getOutputType(c,p)=="Y"?(this._physicsRig.outputs.at(l+p).type=bt.CubismPhysicsSource_Y,this._physicsRig.outputs.at(l+p).getValue=Ho,this._physicsRig.outputs.at(l+p).getScale=qo):s.getOutputType(c,p)==Xn&&(this._physicsRig.outputs.at(l+p).type=bt.CubismPhysicsSource_Angle,this._physicsRig.outputs.at(l+p).getValue=Yo,this._physicsRig.outputs.at(l+p).getScale=Wo),this._physicsRig.outputs.at(l+p).reflect=s.getOutputReflect(c,p);this._currentRigOutputs.pushBack(f),this._previousRigOutputs.pushBack(y),l+=this._physicsRig.settings.at(c).outputCount,this._physicsRig.settings.at(c).particleCount=s.getParticleCount(c),this._physicsRig.settings.at(c).baseParticleIndex=g;for(let p=0;p<this._physicsRig.settings.at(c).particleCount;++p)this._physicsRig.particles.at(g+p).mobility=s.getParticleMobility(c,p),this._physicsRig.particles.at(g+p).delay=s.getParticleDelay(c,p),this._physicsRig.particles.at(g+p).acceleration=s.getParticleAcceleration(c,p),this._physicsRig.particles.at(g+p).radius=s.getParticleRadius(c,p),this._physicsRig.particles.at(g+p).position=s.getParticlePosition(c,p);g+=this._physicsRig.settings.at(c).particleCount}this.initialize(),s.release(),s=void 0,s=null}stabilization(e){var t,s,a,l;let g,c,f,y;const p=new q;let I,B,M,v,O,k,W,H;O=e.getModel().parameters.values,k=e.getModel().parameters.maximumValues,W=e.getModel().parameters.minimumValues,H=e.getModel().parameters.defaultValues,((s=(t=this._parameterCaches)===null||t===void 0?void 0:t.length)!==null&&s!==void 0?s:0)<e.getParameterCount()&&(this._parameterCaches=new Float32Array(e.getParameterCount())),((l=(a=this._parameterInputCaches)===null||a===void 0?void 0:a.length)!==null&&l!==void 0?l:0)<e.getParameterCount()&&(this._parameterInputCaches=new Float32Array(e.getParameterCount()));for(let ee=0;ee<e.getParameterCount();++ee)this._parameterCaches[ee]=O[ee],this._parameterInputCaches[ee]=O[ee];for(let ee=0;ee<this._physicsRig.subRigCount;++ee){g={angle:0},p.x=0,p.y=0,I=this._physicsRig.settings.at(ee),B=this._physicsRig.inputs.get(I.baseInputIndex),M=this._physicsRig.outputs.get(I.baseOutputIndex),v=this._physicsRig.particles.get(I.baseParticleIndex);for(let D=0;D<I.inputCount;++D)c=B[D].weight/100,B[D].sourceParameterIndex==-1&&(B[D].sourceParameterIndex=e.getParameterIndex(B[D].source.id)),B[D].getNormalizedParameterValue(p,g,O[B[D].sourceParameterIndex],W[B[D].sourceParameterIndex],k[B[D].sourceParameterIndex],H[B[D].sourceParameterIndex],I.normalizationPosition,I.normalizationAngle,B[D].reflect,c),this._parameterCaches[B[D].sourceParameterIndex]=O[B[D].sourceParameterIndex];f=J.degreesToRadian(-g.angle),p.x=p.x*J.cos(f)-p.y*J.sin(f),p.y=p.x*J.sin(f)+p.y*J.cos(f),Ko(v,I.particleCount,p,g.angle,this._options.wind,.001*I.normalizationPosition.maximum);for(let D=0;D<I.outputCount;++D){const ve=M[D].vertexIndex;if(M[D].destinationParameterIndex==-1&&(M[D].destinationParameterIndex=e.getParameterIndex(M[D].destination.id)),ve<1||ve>=I.particleCount)continue;let ue=new q;ue=v[ve].position.substract(v[ve-1].position),y=M[D].getValue(ue,v,ve,M[D].reflect,this._options.gravity),this._currentRigOutputs.at(ee).outputs.set(D,y),this._previousRigOutputs.at(ee).outputs.set(D,y);const he=M[D].destinationParameterIndex,le=!Float32Array.prototype.slice&&"subarray"in Float32Array.prototype?JSON.parse(JSON.stringify(O.subarray(he))):O.slice(he);ks(le,W[he],k[he],y,M[D]);for(let Le=he,ui=0;Le<this._parameterCaches.length;Le++,ui++)O[Le]=this._parameterCaches[Le]=le[ui]}}}evaluate(e,t){var s,a,l,g;let c,f,y,p;const I=new q;let B,M,v,O,k,W,H,ee,D;if(0>=t)return;if(this._currentRemainTime+=t,this._currentRemainTime>5&&(this._currentRemainTime=0),k=e.getModel().parameters.values,W=e.getModel().parameters.maximumValues,H=e.getModel().parameters.minimumValues,ee=e.getModel().parameters.defaultValues,((a=(s=this._parameterCaches)===null||s===void 0?void 0:s.length)!==null&&a!==void 0?a:0)<e.getParameterCount()&&(this._parameterCaches=new Float32Array(e.getParameterCount())),((g=(l=this._parameterInputCaches)===null||l===void 0?void 0:l.length)!==null&&g!==void 0?g:0)<e.getParameterCount()){this._parameterInputCaches=new Float32Array(e.getParameterCount());for(let ue=0;ue<e.getParameterCount();++ue)this._parameterInputCaches[ue]=k[ue]}for(D=this._physicsRig.fps>0?1/this._physicsRig.fps:t;this._currentRemainTime>=D;){for(let he=0;he<this._physicsRig.subRigCount;++he){B=this._physicsRig.settings.at(he),v=this._physicsRig.outputs.get(B.baseOutputIndex);for(let le=0;le<B.outputCount;++le)this._previousRigOutputs.at(he).outputs.set(le,this._currentRigOutputs.at(he).outputs.at(le))}const ue=D/this._currentRemainTime;for(let he=0;he<e.getParameterCount();++he)this._parameterCaches[he]=this._parameterInputCaches[he]*(1-ue)+k[he]*ue,this._parameterInputCaches[he]=this._parameterCaches[he];for(let he=0;he<this._physicsRig.subRigCount;++he){c={angle:0},I.x=0,I.y=0,B=this._physicsRig.settings.at(he),M=this._physicsRig.inputs.get(B.baseInputIndex),v=this._physicsRig.outputs.get(B.baseOutputIndex),O=this._physicsRig.particles.get(B.baseParticleIndex);for(let le=0;le<B.inputCount;++le)f=M[le].weight/100,M[le].sourceParameterIndex==-1&&(M[le].sourceParameterIndex=e.getParameterIndex(M[le].source.id)),M[le].getNormalizedParameterValue(I,c,this._parameterCaches[M[le].sourceParameterIndex],H[M[le].sourceParameterIndex],W[M[le].sourceParameterIndex],ee[M[le].sourceParameterIndex],B.normalizationPosition,B.normalizationAngle,M[le].reflect,f);y=J.degreesToRadian(-c.angle),I.x=I.x*J.cos(y)-I.y*J.sin(y),I.y=I.x*J.sin(y)+I.y*J.cos(y),$o(O,B.particleCount,I,c.angle,this._options.wind,.001*B.normalizationPosition.maximum,D,5);for(let le=0;le<B.outputCount;++le){const Le=v[le].vertexIndex;if(v[le].destinationParameterIndex==-1&&(v[le].destinationParameterIndex=e.getParameterIndex(v[le].destination.id)),Le<1||Le>=B.particleCount)continue;const ui=new q;ui.x=O[Le].position.x-O[Le-1].position.x,ui.y=O[Le].position.y-O[Le-1].position.y,p=v[le].getValue(ui,O,Le,v[le].reflect,this._options.gravity),this._currentRigOutputs.at(he).outputs.set(le,p);const Fi=v[le].destinationParameterIndex,_a=!Float32Array.prototype.slice&&"subarray"in Float32Array.prototype?JSON.parse(JSON.stringify(this._parameterCaches.subarray(Fi))):this._parameterCaches.slice(Fi);ks(_a,H[Fi],W[Fi],p,v[le]);for(let qs=Fi,fa=0;qs<this._parameterCaches.length;qs++,fa++)this._parameterCaches[qs]=_a[fa]}}this._currentRemainTime-=D}const ve=this._currentRemainTime/D;this.interpolate(e,ve)}interpolate(e,t){let s,a,l,g,c;l=e.getModel().parameters.values,g=e.getModel().parameters.maximumValues,c=e.getModel().parameters.minimumValues;for(let f=0;f<this._physicsRig.subRigCount;++f){a=this._physicsRig.settings.at(f),s=this._physicsRig.outputs.get(a.baseOutputIndex);for(let y=0;y<a.outputCount;++y){if(s[y].destinationParameterIndex==-1)continue;const p=s[y].destinationParameterIndex,I=!Float32Array.prototype.slice&&"subarray"in Float32Array.prototype?JSON.parse(JSON.stringify(l.subarray(p))):l.slice(p);ks(I,c[p],g[p],this._previousRigOutputs.at(f).outputs.at(y)*(1-t)+this._currentRigOutputs.at(f).outputs.at(y)*t,s[y]);for(let B=p,M=0;B<l.length;B++,M++)l[B]=I[M]}}}setOptions(e){this._options=e}getOption(){return this._options}constructor(){this._physicsRig=null,this._options=new Hn,this._options.gravity.y=-1,this._options.gravity.x=0,this._options.wind.x=0,this._options.wind.y=0,this._currentRigOutputs=new S,this._previousRigOutputs=new S,this._currentRemainTime=0,this._parameterCaches=null,this._parameterInputCaches=null}release(){this._physicsRig=void 0,this._physicsRig=null}initialize(){let e,t,s;for(let a=0;a<this._physicsRig.subRigCount;++a){t=this._physicsRig.settings.at(a),e=this._physicsRig.particles.get(t.baseParticleIndex),e[0].initialPosition=new q(0,0),e[0].lastPosition=new q(e[0].initialPosition.x,e[0].initialPosition.y),e[0].lastGravity=new q(0,-1),e[0].lastGravity.y*=-1,e[0].velocity=new q(0,0),e[0].force=new q(0,0);for(let l=1;l<t.particleCount;++l)s=new q(0,0),s.y=e[l].radius,e[l].initialPosition=new q(e[l-1].initialPosition.x+s.x,e[l-1].initialPosition.y+s.y),e[l].position=new q(e[l].initialPosition.x,e[l].initialPosition.y),e[l].lastPosition=new q(e[l].initialPosition.x,e[l].initialPosition.y),e[l].lastGravity=new q(0,-1),e[l].lastGravity.y*=-1,e[l].velocity=new q(0,0),e[l].force=new q(0,0)}}}class Hn{constructor(){this.gravity=new q(0,0),this.wind=new q(0,0)}}class Yn{constructor(){this.outputs=new S(0)}}function Uo(n,e,t,s,a,l,g,c,f,y){n.x+=Ns(t,s,a,0,g.minimum,g.maximum,g.defalut,f)*y}function zo(n,e,t,s,a,l,g,c,f,y){n.y+=Ns(t,s,a,0,g.minimum,g.maximum,g.defalut,f)*y}function jo(n,e,t,s,a,l,g,c,f,y){e.angle+=Ns(t,s,a,0,c.minimum,c.maximum,c.defalut,f)*y}function Xo(n,e,t,s,a){let l=n.x;return s&&(l*=-1),l}function Ho(n,e,t,s,a){let l=n.y;return s&&(l*=-1),l}function Yo(n,e,t,s,a){let l;return a=t>=2?e[t-1].position.substract(e[t-2].position):a.multiplyByScaler(-1),l=J.directionToRadian(a,n),s&&(l*=-1),l}function Go(n,e){return JSON.parse(JSON.stringify(n.x))}function qo(n,e){return JSON.parse(JSON.stringify(n.y))}function Wo(n,e){return JSON.parse(JSON.stringify(e))}function $o(n,e,t,s,a,l,g,c){let f,y,p,I,B=new q(0,0),M=new q(0,0),v=new q(0,0),O=new q(0,0);n[0].position=new q(t.x,t.y),f=J.degreesToRadian(s),I=J.radianToDirection(f),I.normalize();for(let k=1;k<e;++k)n[k].force=I.multiplyByScaler(n[k].acceleration).add(a),n[k].lastPosition=new q(n[k].position.x,n[k].position.y),y=n[k].delay*g*30,B=n[k].position.substract(n[k-1].position),p=J.directionToRadian(n[k].lastGravity,I)/c,B.x=J.cos(p)*B.x-B.y*J.sin(p),B.y=J.sin(p)*B.x+B.y*J.cos(p),n[k].position=n[k-1].position.add(B),M=n[k].velocity.multiplyByScaler(y),v=n[k].force.multiplyByScaler(y).multiplyByScaler(y),n[k].position=n[k].position.add(M).add(v),O=n[k].position.substract(n[k-1].position),O.normalize(),n[k].position=n[k-1].position.add(O.multiplyByScaler(n[k].radius)),J.abs(n[k].position.x)<l&&(n[k].position.x=0),y!=0&&(n[k].velocity=n[k].position.substract(n[k].lastPosition),n[k].velocity=n[k].velocity.divisionByScalar(y),n[k].velocity=n[k].velocity.multiplyByScaler(n[k].mobility)),n[k].force=new q(0,0),n[k].lastGravity=new q(I.x,I.y)}function Ko(n,e,t,s,a,l){let g,c,f=new q(0,0);n[0].position=new q(t.x,t.y),g=J.degreesToRadian(s),c=J.radianToDirection(g),c.normalize();for(let y=1;y<e;++y)n[y].force=c.multiplyByScaler(n[y].acceleration).add(a),n[y].lastPosition=new q(n[y].position.x,n[y].position.y),n[y].velocity=new q(0,0),f=n[y].force,f.normalize(),f=f.multiplyByScaler(n[y].radius),n[y].position=n[y-1].position.add(f),J.abs(n[y].position.x)<l&&(n[y].position.x=0),n[y].force=new q(0,0),n[y].lastGravity=new q(c.x,c.y)}function ks(n,e,t,s,a){let l,g,c;l=a.getScale(a.translationScale,a.angleScale),g=s*l,g<e?(g<a.valueBelowMinimum&&(a.valueBelowMinimum=g),g=e):g>t&&(g>a.valueExceededMaximum&&(a.valueExceededMaximum=g),g=t),c=a.weight/100,c>=1||(g=n[0]*(1-c)+g*c),n[0]=g}function Ns(n,e,t,s,a,l,g,c){let f=0;const y=J.max(t,e);y<n&&(n=y);const p=J.min(t,e);p>n&&(n=p);const I=J.min(a,l),B=J.max(a,l),M=g,v=(k=p,W=y,J.min(k,W)+function(H,ee){const D=J.max(H,ee),ve=J.min(H,ee);return J.abs(D-ve)}(k,W)/2),O=n-v;var k,W;switch(function(H){let ee=0;return H>0?ee=1:H<0&&(ee=-1),ee}(O)){case 1:{const H=y-v;H!=0&&(f=O*((B-M)/H),f+=M);break}case-1:{const H=p-v;H!=0&&(f=O*((I-M)/H),f+=M);break}case 0:f=M}return c?f:-1*f}var Gn,qn;(function(n){n.CubismPhysics=Ti,n.Options=Hn})(Gn||(Gn={}));class is{constructor(e,t,s,a){this.x=e,this.y=t,this.width=s,this.height=a}getCenterX(){return this.x+.5*this.width}getCenterY(){return this.y+.5*this.height}getRight(){return this.x+this.width}getBottom(){return this.y+this.height}setRect(e){this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height}expand(e,t){this.x-=e,this.y-=t,this.width+=2*e,this.height+=2*t}}let Ht,Mt,ss;(function(n){n.csmRect=is})(qn||(qn={}));class Us{getChannelFlagAsColor(e){return this._channelColors.at(e)}getMaskRenderTexture(){if(this._maskTexture&&this._maskTexture.textures!=null)this._maskTexture.frameNo=this._currentFrameNo;else{this._maskRenderTextures!=null&&this._maskRenderTextures.clear(),this._maskRenderTextures=new S,this._maskColorBuffers!=null&&this._maskColorBuffers.clear(),this._maskColorBuffers=new S;const e=this._clippingMaskBufferSize;for(let t=0;t<this._renderTextureCount;t++)this._maskColorBuffers.pushBack(this.gl.createTexture()),this.gl.bindTexture(this.gl.TEXTURE_2D,this._maskColorBuffers.at(t)),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,e,e,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.bindTexture(this.gl.TEXTURE_2D,null),this._maskRenderTextures.pushBack(this.gl.createFramebuffer()),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this._maskRenderTextures.at(t)),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,this._maskColorBuffers.at(t),0);this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,ss),this._maskTexture=new Wn(this._currentFrameNo,this._maskRenderTextures)}return this._maskTexture.textures}setGL(e){this.gl=e}calcClippedDrawTotalBounds(e,t){let s=Number.MAX_VALUE,a=Number.MAX_VALUE,l=Number.MIN_VALUE,g=Number.MIN_VALUE;const c=t._clippedDrawableIndexList.length;for(let f=0;f<c;f++){const y=t._clippedDrawableIndexList[f],p=e.getDrawableVertexCount(y),I=e.getDrawableVertices(y);let B=Number.MAX_VALUE,M=Number.MAX_VALUE,v=-Number.MAX_VALUE,O=-Number.MAX_VALUE;const k=p*tt.vertexStep;for(let W=tt.vertexOffset;W<k;W+=tt.vertexStep){const H=I[W],ee=I[W+1];H<B&&(B=H),H>v&&(v=H),ee<M&&(M=ee),ee>O&&(O=ee)}if(B!=Number.MAX_VALUE)if(B<s&&(s=B),M<a&&(a=M),v>l&&(l=v),O>g&&(g=O),s==Number.MAX_VALUE)t._allClippedDrawRect.x=0,t._allClippedDrawRect.y=0,t._allClippedDrawRect.width=0,t._allClippedDrawRect.height=0,t._isUsing=!1;else{t._isUsing=!0;const W=l-s,H=g-a;t._allClippedDrawRect.x=s,t._allClippedDrawRect.y=a,t._allClippedDrawRect.width=W,t._allClippedDrawRect.height=H}}}constructor(){this._currentMaskRenderTexture=null,this._maskColorBuffers=null,this._currentFrameNo=0,this._renderTextureCount=0,this._clippingMaskBufferSize=256,this._clippingContextListForMask=new S,this._clippingContextListForDraw=new S,this._channelColors=new S,this._tmpBoundsOnModel=new is,this._tmpMatrix=new ie,this._tmpMatrixForMask=new ie,this._tmpMatrixForDraw=new ie,this._maskTexture=null;let e=new ce;e.R=1,e.G=0,e.B=0,e.A=0,this._channelColors.pushBack(e),e=new ce,e.R=0,e.G=1,e.B=0,e.A=0,this._channelColors.pushBack(e),e=new ce,e.R=0,e.G=0,e.B=1,e.A=0,this._channelColors.pushBack(e),e=new ce,e.R=0,e.G=0,e.B=0,e.A=1,this._channelColors.pushBack(e)}release(){for(let e=0;e<this._clippingContextListForMask.getSize();e++)this._clippingContextListForMask.at(e)&&(this._clippingContextListForMask.at(e).release(),this._clippingContextListForMask.set(e,void 0)),this._clippingContextListForMask.set(e,null);this._clippingContextListForMask=null;for(let e=0;e<this._clippingContextListForDraw.getSize();e++)this._clippingContextListForDraw.set(e,null);if(this._clippingContextListForDraw=null,this._maskTexture){for(let e=0;e<this._maskTexture.textures.getSize();e++)this.gl.deleteFramebuffer(this._maskTexture.textures.at(e));this._maskTexture.textures.clear(),this._maskTexture.textures=null,this._maskTexture=null}for(let e=0;e<this._channelColors.getSize();e++)this._channelColors.set(e,null);if(this._channelColors=null,this._maskColorBuffers!=null){for(let e=0;e<this._maskColorBuffers.getSize();e++)this.gl.deleteTexture(this._maskColorBuffers.at(e));this._maskColorBuffers.clear()}this._maskColorBuffers=null,this._maskRenderTextures!=null&&this._maskRenderTextures.clear(),this._maskRenderTextures=null,this._clearedFrameBufferflags!=null&&this._clearedFrameBufferflags.clear(),this._clearedFrameBufferflags=null}initialize(e,t,s,a,l){l%1!=0&&(Ae("The number of render textures must be specified as an integer. The decimal point is rounded down and corrected to an integer."),l=~~l),l<1&&Ae("The number of render textures must be an integer greater than or equal to 1. Set the number of render textures to 1."),this._renderTextureCount=l<1?1:l,this._clearedFrameBufferflags=new S(this._renderTextureCount);for(let g=0;g<t;g++){if(a[g]<=0){this._clippingContextListForDraw.pushBack(null);continue}let c=this.findSameClip(s[g],a[g]);c==null&&(c=new $n(this,s[g],a[g]),this._clippingContextListForMask.pushBack(c)),c.addClippedDrawable(g),this._clippingContextListForDraw.pushBack(c)}}setupClippingContext(e,t){this._currentFrameNo++;let s=0;for(let a=0;a<this._clippingContextListForMask.getSize();a++){const l=this._clippingContextListForMask.at(a);this.calcClippedDrawTotalBounds(e,l),l._isUsing&&s++}if(s>0){this.setupLayoutBounds(t.isUsingHighPrecisionMask()?0:s),t.isUsingHighPrecisionMask()||(this.gl.viewport(0,0,this._clippingMaskBufferSize,this._clippingMaskBufferSize),this._currentMaskRenderTexture=this.getMaskRenderTexture().at(0),t.preDraw(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this._currentMaskRenderTexture)),this._clearedFrameBufferflags.getSize()!=this._renderTextureCount&&(this._clearedFrameBufferflags.clear(),this._clearedFrameBufferflags=new S(this._renderTextureCount));for(let a=0;a<this._clearedFrameBufferflags.getSize();a++)this._clearedFrameBufferflags.set(a,!1);for(let a=0;a<this._clippingContextListForMask.getSize();a++){const l=this._clippingContextListForMask.at(a),g=l._allClippedDrawRect,c=l._layoutBounds,f=.05;let y=0,p=0;const I=this.getMaskRenderTexture().at(l._bufferIndex);if(this._currentMaskRenderTexture==I||t.isUsingHighPrecisionMask()||(this._currentMaskRenderTexture=I,t.preDraw(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this._currentMaskRenderTexture)),t.isUsingHighPrecisionMask()){const B=e.getPixelsPerUnit(),M=l.getClippingManager()._clippingMaskBufferSize,v=c.width*M,O=c.height*M;this._tmpBoundsOnModel.setRect(g),this._tmpBoundsOnModel.width*B>v?(this._tmpBoundsOnModel.expand(g.width*f,0),y=c.width/this._tmpBoundsOnModel.width):y=B/v,this._tmpBoundsOnModel.height*B>O?(this._tmpBoundsOnModel.expand(0,g.height*f),p=c.height/this._tmpBoundsOnModel.height):p=B/O}else this._tmpBoundsOnModel.setRect(g),this._tmpBoundsOnModel.expand(g.width*f,g.height*f),y=c.width/this._tmpBoundsOnModel.width,p=c.height/this._tmpBoundsOnModel.height;if(this._tmpMatrix.loadIdentity(),this._tmpMatrix.translateRelative(-1,-1),this._tmpMatrix.scaleRelative(2,2),this._tmpMatrix.translateRelative(c.x,c.y),this._tmpMatrix.scaleRelative(y,p),this._tmpMatrix.translateRelative(-this._tmpBoundsOnModel.x,-this._tmpBoundsOnModel.y),this._tmpMatrixForMask.setMatrix(this._tmpMatrix.getArray()),this._tmpMatrix.loadIdentity(),this._tmpMatrix.translateRelative(c.x,c.y),this._tmpMatrix.scaleRelative(y,p),this._tmpMatrix.translateRelative(-this._tmpBoundsOnModel.x,-this._tmpBoundsOnModel.y),this._tmpMatrixForDraw.setMatrix(this._tmpMatrix.getArray()),l._matrixForMask.setMatrix(this._tmpMatrixForMask.getArray()),l._matrixForDraw.setMatrix(this._tmpMatrixForDraw.getArray()),!t.isUsingHighPrecisionMask()){const B=l._clippingIdCount;for(let M=0;M<B;M++){const v=l._clippingIdList[M];e.getDrawableDynamicFlagVertexPositionsDidChange(v)&&(t.setIsCulling(e.getDrawableCulling(v)!=0),this._clearedFrameBufferflags.at(l._bufferIndex)||(this.gl.clearColor(1,1,1,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this._clearedFrameBufferflags.set(l._bufferIndex,!0)),t.setClippingContextBufferForMask(l),t.drawMesh(e.getDrawableTextureIndex(v),e.getDrawableVertexIndexCount(v),e.getDrawableVertexCount(v),e.getDrawableVertexIndices(v),e.getDrawableVertices(v),e.getDrawableVertexUvs(v),e.getMultiplyColor(v),e.getScreenColor(v),e.getDrawableOpacity(v),d.CubismBlendMode_Normal,!1))}}}t.isUsingHighPrecisionMask()||(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,ss),t.setClippingContextBufferForMask(null),this.gl.viewport(Mt[0],Mt[1],Mt[2],Mt[3]))}}findSameClip(e,t){for(let s=0;s<this._clippingContextListForMask.getSize();s++){const a=this._clippingContextListForMask.at(s),l=a._clippingIdCount;if(l!=t)continue;let g=0;for(let c=0;c<l;c++){const f=a._clippingIdList[c];for(let y=0;y<l;y++)if(e[y]==f){g++;break}}if(g==l)return a}return null}setupLayoutBounds(e){const t=this._renderTextureCount<=1?36:32*this._renderTextureCount;if(e<=0||e>t){e>t&&Te(`not supported mask count : {0}
[Details] render texture count : {1}, mask count : {2}`,e-t,this._renderTextureCount,e);for(let y=0;y<this._clippingContextListForMask.getSize();y++){const p=this._clippingContextListForMask.at(y);p._layoutChannelNo=0,p._layoutBounds.x=0,p._layoutBounds.y=0,p._layoutBounds.width=1,p._layoutBounds.height=1,p._bufferIndex=0}return}const s=this._renderTextureCount<=1?9:8;let a=e/this._renderTextureCount,l=e%this._renderTextureCount;a=~~a,l=~~l;let g=a/4,c=a%4;g=~~g,c=~~c;let f=0;for(let y=0;y<this._renderTextureCount;y++)for(let p=0;p<4;p++){let I=g+(p<c?1:0);if(I<s&&p==(c+1>=4?0:c+1)&&(I+=y<l?1:0),I!=0)if(I==1){const B=this._clippingContextListForMask.at(f++);B._layoutChannelNo=p,B._layoutBounds.x=0,B._layoutBounds.y=0,B._layoutBounds.width=1,B._layoutBounds.height=1,B._bufferIndex=y}else if(I==2)for(let B=0;B<I;B++){let M=B%2;M=~~M;const v=this._clippingContextListForMask.at(f++);v._layoutChannelNo=p,v._layoutBounds.x=.5*M,v._layoutBounds.y=0,v._layoutBounds.width=.5,v._layoutBounds.height=1,v._bufferIndex=y}else if(I<=4)for(let B=0;B<I;B++){let M=B%2,v=B/2;M=~~M,v=~~v;const O=this._clippingContextListForMask.at(f++);O._layoutChannelNo=p,O._layoutBounds.x=.5*M,O._layoutBounds.y=.5*v,O._layoutBounds.width=.5,O._layoutBounds.height=.5,O._bufferIndex=y}else if(I<=s)for(let B=0;B<I;B++){let M=B%3,v=B/3;M=~~M,v=~~v;const O=this._clippingContextListForMask.at(f++);O._layoutChannelNo=p,O._layoutBounds.x=M/3,O._layoutBounds.y=v/3,O._layoutBounds.width=1/3,O._layoutBounds.height=1/3,O._bufferIndex=y}else{Te(`not supported mask count : {0}
[Details] render texture count : {1}, mask count : {2}`,e-t,this._renderTextureCount,e);for(let B=0;B<I;B++){const M=this._clippingContextListForMask.at(f++);M._layoutChannelNo=0,M._layoutBounds.x=0,M._layoutBounds.y=0,M._layoutBounds.width=1,M._layoutBounds.height=1,M._bufferIndex=0}}}}getColorBuffer(){return this._maskColorBuffers}getClippingContextListForDraw(){return this._clippingContextListForDraw}getClippingMaskCount(){return this._clippingContextListForMask.getSize()}setClippingMaskBufferSize(e){this._clippingMaskBufferSize=e}getClippingMaskBufferSize(){return this._clippingMaskBufferSize}getRenderTextureCount(){return this._renderTextureCount}}class Wn{constructor(e,t){this.frameNo=e,this.textures=t}}class $n{constructor(e,t,s){this._owner=e,this._clippingIdList=t,this._clippingIdCount=s,this._allClippedDrawRect=new is,this._layoutBounds=new is,this._clippedDrawableIndexList=[],this._matrixForMask=new ie,this._matrixForDraw=new ie,this._bufferIndex=0}release(){this._layoutBounds!=null&&(this._layoutBounds=null),this._allClippedDrawRect!=null&&(this._allClippedDrawRect=null),this._clippedDrawableIndexList!=null&&(this._clippedDrawableIndexList=null)}addClippedDrawable(e){this._clippedDrawableIndexList.push(e)}getClippingManager(){return this._owner}setGl(e){this._owner.setGL(e)}}class Jo{setGlEnable(e,t){t?this.gl.enable(e):this.gl.disable(e)}setGlEnableVertexAttribArray(e,t){t?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e)}save(){this.gl!=null?(this._lastArrayBufferBinding=this.gl.getParameter(this.gl.ARRAY_BUFFER_BINDING),this._lastArrayBufferBinding=this.gl.getParameter(this.gl.ELEMENT_ARRAY_BUFFER_BINDING),this._lastProgram=this.gl.getParameter(this.gl.CURRENT_PROGRAM),this._lastActiveTexture=this.gl.getParameter(this.gl.ACTIVE_TEXTURE),this.gl.activeTexture(this.gl.TEXTURE1),this._lastTexture1Binding2D=this.gl.getParameter(this.gl.TEXTURE_BINDING_2D),this.gl.activeTexture(this.gl.TEXTURE0),this._lastTexture0Binding2D=this.gl.getParameter(this.gl.TEXTURE_BINDING_2D),this._lastVertexAttribArrayEnabled[0]=this.gl.getVertexAttrib(0,this.gl.VERTEX_ATTRIB_ARRAY_ENABLED),this._lastVertexAttribArrayEnabled[1]=this.gl.getVertexAttrib(1,this.gl.VERTEX_ATTRIB_ARRAY_ENABLED),this._lastVertexAttribArrayEnabled[2]=this.gl.getVertexAttrib(2,this.gl.VERTEX_ATTRIB_ARRAY_ENABLED),this._lastVertexAttribArrayEnabled[3]=this.gl.getVertexAttrib(3,this.gl.VERTEX_ATTRIB_ARRAY_ENABLED),this._lastScissorTest=this.gl.isEnabled(this.gl.SCISSOR_TEST),this._lastStencilTest=this.gl.isEnabled(this.gl.STENCIL_TEST),this._lastDepthTest=this.gl.isEnabled(this.gl.DEPTH_TEST),this._lastCullFace=this.gl.isEnabled(this.gl.CULL_FACE),this._lastBlend=this.gl.isEnabled(this.gl.BLEND),this._lastFrontFace=this.gl.getParameter(this.gl.FRONT_FACE),this._lastColorMask=this.gl.getParameter(this.gl.COLOR_WRITEMASK),this._lastBlending[0]=this.gl.getParameter(this.gl.BLEND_SRC_RGB),this._lastBlending[1]=this.gl.getParameter(this.gl.BLEND_DST_RGB),this._lastBlending[2]=this.gl.getParameter(this.gl.BLEND_SRC_ALPHA),this._lastBlending[3]=this.gl.getParameter(this.gl.BLEND_DST_ALPHA),this._lastFBO=this.gl.getParameter(this.gl.FRAMEBUFFER_BINDING),this._lastViewport=this.gl.getParameter(this.gl.VIEWPORT)):Te(`'gl' is null. WebGLRenderingContext is required.
Please call 'CubimRenderer_WebGL.startUp' function.`)}restore(){this.gl!=null?(this.gl.useProgram(this._lastProgram),this.setGlEnableVertexAttribArray(0,this._lastVertexAttribArrayEnabled[0]),this.setGlEnableVertexAttribArray(1,this._lastVertexAttribArrayEnabled[1]),this.setGlEnableVertexAttribArray(2,this._lastVertexAttribArrayEnabled[2]),this.setGlEnableVertexAttribArray(3,this._lastVertexAttribArrayEnabled[3]),this.setGlEnable(this.gl.SCISSOR_TEST,this._lastScissorTest),this.setGlEnable(this.gl.STENCIL_TEST,this._lastStencilTest),this.setGlEnable(this.gl.DEPTH_TEST,this._lastDepthTest),this.setGlEnable(this.gl.CULL_FACE,this._lastCullFace),this.setGlEnable(this.gl.BLEND,this._lastBlend),this.gl.frontFace(this._lastFrontFace),this.gl.colorMask(this._lastColorMask[0],this._lastColorMask[1],this._lastColorMask[2],this._lastColorMask[3]),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this._lastArrayBufferBinding),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this._lastElementArrayBufferBinding),this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,this._lastTexture1Binding2D),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this._lastTexture0Binding2D),this.gl.activeTexture(this._lastActiveTexture),this.gl.blendFuncSeparate(this._lastBlending[0],this._lastBlending[1],this._lastBlending[2],this._lastBlending[3])):Te(`'gl' is null. WebGLRenderingContext is required.
Please call 'CubimRenderer_WebGL.startUp' function.`)}setGl(e){this.gl=e}constructor(){this._lastVertexAttribArrayEnabled=new Array(4),this._lastColorMask=new Array(4),this._lastBlending=new Array(4),this._lastViewport=new Array(4)}}class ni{static getInstance(){return Ht==null&&(Ht=new ni),Ht}static deleteInstance(){Ht&&(Ht.release(),Ht=null)}constructor(){this._shaderSets=new S}release(){this.releaseShaderProgram()}setupShaderProgram(e,t,s,a,l,g,c,f,y,p,I,B,M,v,O){let k,W,H,ee;if(M||Te("NoPremultipliedAlpha is not allowed"),this._shaderSets.getSize()==0&&this.generateShaders(),e.getClippingContextBufferForMask()!=null){const D=this._shaderSets.at(Yt.ShaderNames_SetupMask);this.gl.useProgram(D.shaderProgram),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.uniform1i(D.samplerTexture0Location,0),c.vertex==null&&(c.vertex=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,c.vertex),this.gl.bufferData(this.gl.ARRAY_BUFFER,a,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(D.attributePositionLocation),this.gl.vertexAttribPointer(D.attributePositionLocation,2,this.gl.FLOAT,!1,0,0),c.uv==null&&(c.uv=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,c.uv),this.gl.bufferData(this.gl.ARRAY_BUFFER,g,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(D.attributeTexCoordLocation),this.gl.vertexAttribPointer(D.attributeTexCoordLocation,2,this.gl.FLOAT,!1,0,0);const ve=e.getClippingContextBufferForMask()._layoutChannelNo,ue=e.getClippingContextBufferForMask().getClippingManager().getChannelFlagAsColor(ve);this.gl.uniform4f(D.uniformChannelFlagLocation,ue.R,ue.G,ue.B,ue.A),this.gl.uniformMatrix4fv(D.uniformClipMatrixLocation,!1,e.getClippingContextBufferForMask()._matrixForMask.getArray());const he=e.getClippingContextBufferForMask()._layoutBounds;this.gl.uniform4f(D.uniformBaseColorLocation,2*he.x-1,2*he.y-1,2*he.getRight()-1,2*he.getBottom()-1),this.gl.uniform4f(D.uniformMultiplyColorLocation,I.R,I.G,I.B,I.A),this.gl.uniform4f(D.uniformScreenColorLocation,B.R,B.G,B.B,B.A),k=this.gl.ZERO,W=this.gl.ONE_MINUS_SRC_COLOR,H=this.gl.ZERO,ee=this.gl.ONE_MINUS_SRC_ALPHA}else{const D=e.getClippingContextBufferForDraw()!=null,ve=D?O?2:1:0;let ue=new zs;switch(y){case d.CubismBlendMode_Normal:default:ue=this._shaderSets.at(Yt.ShaderNames_NormalPremultipliedAlpha+ve),k=this.gl.ONE,W=this.gl.ONE_MINUS_SRC_ALPHA,H=this.gl.ONE,ee=this.gl.ONE_MINUS_SRC_ALPHA;break;case d.CubismBlendMode_Additive:ue=this._shaderSets.at(Yt.ShaderNames_AddPremultipliedAlpha+ve),k=this.gl.ONE,W=this.gl.ONE,H=this.gl.ZERO,ee=this.gl.ONE;break;case d.CubismBlendMode_Multiplicative:ue=this._shaderSets.at(Yt.ShaderNames_MultPremultipliedAlpha+ve),k=this.gl.DST_COLOR,W=this.gl.ONE_MINUS_SRC_ALPHA,H=this.gl.ZERO,ee=this.gl.ONE}if(this.gl.useProgram(ue.shaderProgram),c.vertex==null&&(c.vertex=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,c.vertex),this.gl.bufferData(this.gl.ARRAY_BUFFER,a,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(ue.attributePositionLocation),this.gl.vertexAttribPointer(ue.attributePositionLocation,2,this.gl.FLOAT,!1,0,0),c.uv==null&&(c.uv=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,c.uv),this.gl.bufferData(this.gl.ARRAY_BUFFER,g,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(ue.attributeTexCoordLocation),this.gl.vertexAttribPointer(ue.attributeTexCoordLocation,2,this.gl.FLOAT,!1,0,0),D){this.gl.activeTexture(this.gl.TEXTURE1);const he=e.getClippingContextBufferForDraw().getClippingManager().getColorBuffer().at(e.getClippingContextBufferForDraw()._bufferIndex);this.gl.bindTexture(this.gl.TEXTURE_2D,he),this.gl.uniform1i(ue.samplerTexture1Location,1),this.gl.uniformMatrix4fv(ue.uniformClipMatrixLocation,!1,e.getClippingContextBufferForDraw()._matrixForDraw.getArray());const le=e.getClippingContextBufferForDraw()._layoutChannelNo,Le=e.getClippingContextBufferForDraw().getClippingManager().getChannelFlagAsColor(le);this.gl.uniform4f(ue.uniformChannelFlagLocation,Le.R,Le.G,Le.B,Le.A)}this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.uniform1i(ue.samplerTexture0Location,0),this.gl.uniformMatrix4fv(ue.uniformMatrixLocation,!1,v.getArray()),this.gl.uniform4f(ue.uniformBaseColorLocation,p.R,p.G,p.B,p.A),this.gl.uniform4f(ue.uniformMultiplyColorLocation,I.R,I.G,I.B,I.A),this.gl.uniform4f(ue.uniformScreenColorLocation,B.R,B.G,B.B,B.A)}c.index==null&&(c.index=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,c.index),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,l,this.gl.DYNAMIC_DRAW),this.gl.blendFuncSeparate(k,W,H,ee)}releaseShaderProgram(){for(let e=0;e<this._shaderSets.getSize();e++)this.gl.deleteProgram(this._shaderSets.at(e).shaderProgram),this._shaderSets.at(e).shaderProgram=0,this._shaderSets.set(e,void 0),this._shaderSets.set(e,null)}generateShaders(){for(let e=0;e<10;e++)this._shaderSets.pushBack(new zs);this._shaderSets.at(0).shaderProgram=this.loadShaderProgram(Zo,Qo),this._shaderSets.at(1).shaderProgram=this.loadShaderProgram(el,tl),this._shaderSets.at(2).shaderProgram=this.loadShaderProgram(Kn,il),this._shaderSets.at(3).shaderProgram=this.loadShaderProgram(Kn,sl),this._shaderSets.at(4).shaderProgram=this._shaderSets.at(1).shaderProgram,this._shaderSets.at(5).shaderProgram=this._shaderSets.at(2).shaderProgram,this._shaderSets.at(6).shaderProgram=this._shaderSets.at(3).shaderProgram,this._shaderSets.at(7).shaderProgram=this._shaderSets.at(1).shaderProgram,this._shaderSets.at(8).shaderProgram=this._shaderSets.at(2).shaderProgram,this._shaderSets.at(9).shaderProgram=this._shaderSets.at(3).shaderProgram,this._shaderSets.at(0).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(0).shaderProgram,"a_position"),this._shaderSets.at(0).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(0).shaderProgram,"a_texCoord"),this._shaderSets.at(0).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(0).shaderProgram,"s_texture0"),this._shaderSets.at(0).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(0).shaderProgram,"u_clipMatrix"),this._shaderSets.at(0).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(0).shaderProgram,"u_channelFlag"),this._shaderSets.at(0).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(0).shaderProgram,"u_baseColor"),this._shaderSets.at(0).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(0).shaderProgram,"u_multiplyColor"),this._shaderSets.at(0).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(0).shaderProgram,"u_screenColor"),this._shaderSets.at(1).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(1).shaderProgram,"a_position"),this._shaderSets.at(1).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(1).shaderProgram,"a_texCoord"),this._shaderSets.at(1).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(1).shaderProgram,"s_texture0"),this._shaderSets.at(1).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(1).shaderProgram,"u_matrix"),this._shaderSets.at(1).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(1).shaderProgram,"u_baseColor"),this._shaderSets.at(1).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(1).shaderProgram,"u_multiplyColor"),this._shaderSets.at(1).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(1).shaderProgram,"u_screenColor"),this._shaderSets.at(2).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(2).shaderProgram,"a_position"),this._shaderSets.at(2).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(2).shaderProgram,"a_texCoord"),this._shaderSets.at(2).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"s_texture0"),this._shaderSets.at(2).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"s_texture1"),this._shaderSets.at(2).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"u_matrix"),this._shaderSets.at(2).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"u_clipMatrix"),this._shaderSets.at(2).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"u_channelFlag"),this._shaderSets.at(2).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"u_baseColor"),this._shaderSets.at(2).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"u_multiplyColor"),this._shaderSets.at(2).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"u_screenColor"),this._shaderSets.at(3).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(3).shaderProgram,"a_position"),this._shaderSets.at(3).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(3).shaderProgram,"a_texCoord"),this._shaderSets.at(3).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"s_texture0"),this._shaderSets.at(3).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"s_texture1"),this._shaderSets.at(3).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"u_matrix"),this._shaderSets.at(3).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"u_clipMatrix"),this._shaderSets.at(3).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"u_channelFlag"),this._shaderSets.at(3).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"u_baseColor"),this._shaderSets.at(3).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"u_multiplyColor"),this._shaderSets.at(3).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"u_screenColor"),this._shaderSets.at(4).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(4).shaderProgram,"a_position"),this._shaderSets.at(4).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(4).shaderProgram,"a_texCoord"),this._shaderSets.at(4).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(4).shaderProgram,"s_texture0"),this._shaderSets.at(4).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(4).shaderProgram,"u_matrix"),this._shaderSets.at(4).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(4).shaderProgram,"u_baseColor"),this._shaderSets.at(4).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(4).shaderProgram,"u_multiplyColor"),this._shaderSets.at(4).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(4).shaderProgram,"u_screenColor"),this._shaderSets.at(5).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(5).shaderProgram,"a_position"),this._shaderSets.at(5).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(5).shaderProgram,"a_texCoord"),this._shaderSets.at(5).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"s_texture0"),this._shaderSets.at(5).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"s_texture1"),this._shaderSets.at(5).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"u_matrix"),this._shaderSets.at(5).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"u_clipMatrix"),this._shaderSets.at(5).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"u_channelFlag"),this._shaderSets.at(5).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"u_baseColor"),this._shaderSets.at(5).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"u_multiplyColor"),this._shaderSets.at(5).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"u_screenColor"),this._shaderSets.at(6).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(6).shaderProgram,"a_position"),this._shaderSets.at(6).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(6).shaderProgram,"a_texCoord"),this._shaderSets.at(6).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"s_texture0"),this._shaderSets.at(6).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"s_texture1"),this._shaderSets.at(6).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"u_matrix"),this._shaderSets.at(6).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"u_clipMatrix"),this._shaderSets.at(6).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"u_channelFlag"),this._shaderSets.at(6).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"u_baseColor"),this._shaderSets.at(6).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"u_multiplyColor"),this._shaderSets.at(6).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"u_screenColor"),this._shaderSets.at(7).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(7).shaderProgram,"a_position"),this._shaderSets.at(7).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(7).shaderProgram,"a_texCoord"),this._shaderSets.at(7).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(7).shaderProgram,"s_texture0"),this._shaderSets.at(7).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(7).shaderProgram,"u_matrix"),this._shaderSets.at(7).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(7).shaderProgram,"u_baseColor"),this._shaderSets.at(7).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(7).shaderProgram,"u_multiplyColor"),this._shaderSets.at(7).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(7).shaderProgram,"u_screenColor"),this._shaderSets.at(8).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(8).shaderProgram,"a_position"),this._shaderSets.at(8).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(8).shaderProgram,"a_texCoord"),this._shaderSets.at(8).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"s_texture0"),this._shaderSets.at(8).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"s_texture1"),this._shaderSets.at(8).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"u_matrix"),this._shaderSets.at(8).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"u_clipMatrix"),this._shaderSets.at(8).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"u_channelFlag"),this._shaderSets.at(8).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"u_baseColor"),this._shaderSets.at(8).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"u_multiplyColor"),this._shaderSets.at(8).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"u_screenColor"),this._shaderSets.at(9).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(9).shaderProgram,"a_position"),this._shaderSets.at(9).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(9).shaderProgram,"a_texCoord"),this._shaderSets.at(9).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"s_texture0"),this._shaderSets.at(9).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"s_texture1"),this._shaderSets.at(9).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"u_matrix"),this._shaderSets.at(9).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"u_clipMatrix"),this._shaderSets.at(9).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"u_channelFlag"),this._shaderSets.at(9).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"u_baseColor"),this._shaderSets.at(9).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"u_multiplyColor"),this._shaderSets.at(9).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"u_screenColor")}loadShaderProgram(e,t){let s=this.gl.createProgram(),a=this.compileShaderSource(this.gl.VERTEX_SHADER,e);if(!a)return Te("Vertex shader compile error!"),0;let l=this.compileShaderSource(this.gl.FRAGMENT_SHADER,t);return l?(this.gl.attachShader(s,a),this.gl.attachShader(s,l),this.gl.linkProgram(s),this.gl.getProgramParameter(s,this.gl.LINK_STATUS)?(this.gl.deleteShader(a),this.gl.deleteShader(l),s):(Te("Failed to link program: {0}",s),this.gl.deleteShader(a),a=0,this.gl.deleteShader(l),l=0,s&&(this.gl.deleteProgram(s),s=0),0)):(Te("Vertex shader compile error!"),0)}compileShaderSource(e,t){const s=t,a=this.gl.createShader(e);if(this.gl.shaderSource(a,s),this.gl.compileShader(a),!a){const l=this.gl.getShaderInfoLog(a);Te("Shader compile log: {0} ",l)}return this.gl.getShaderParameter(a,this.gl.COMPILE_STATUS)?a:(this.gl.deleteShader(a),null)}setGl(e){this.gl=e}}class zs{}var Yt;(function(n){n[n.ShaderNames_SetupMask=0]="ShaderNames_SetupMask",n[n.ShaderNames_NormalPremultipliedAlpha=1]="ShaderNames_NormalPremultipliedAlpha",n[n.ShaderNames_NormalMaskedPremultipliedAlpha=2]="ShaderNames_NormalMaskedPremultipliedAlpha",n[n.ShaderNames_NomralMaskedInvertedPremultipliedAlpha=3]="ShaderNames_NomralMaskedInvertedPremultipliedAlpha",n[n.ShaderNames_AddPremultipliedAlpha=4]="ShaderNames_AddPremultipliedAlpha",n[n.ShaderNames_AddMaskedPremultipliedAlpha=5]="ShaderNames_AddMaskedPremultipliedAlpha",n[n.ShaderNames_AddMaskedPremultipliedAlphaInverted=6]="ShaderNames_AddMaskedPremultipliedAlphaInverted",n[n.ShaderNames_MultPremultipliedAlpha=7]="ShaderNames_MultPremultipliedAlpha",n[n.ShaderNames_MultMaskedPremultipliedAlpha=8]="ShaderNames_MultMaskedPremultipliedAlpha",n[n.ShaderNames_MultMaskedPremultipliedAlphaInverted=9]="ShaderNames_MultMaskedPremultipliedAlphaInverted"})(Yt||(Yt={}));const Zo="attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;varying vec4       v_myPos;uniform mat4       u_clipMatrix;void main(){   gl_Position = u_clipMatrix * a_position;   v_myPos = u_clipMatrix * a_position;   v_texCoord = a_texCoord;   v_texCoord.y = 1.0 - v_texCoord.y;}",Qo="precision mediump float;varying vec2       v_texCoord;varying vec4       v_myPos;uniform vec4       u_baseColor;uniform vec4       u_channelFlag;uniform sampler2D  s_texture0;void main(){   float isInside =        step(u_baseColor.x, v_myPos.x/v_myPos.w)       * step(u_baseColor.y, v_myPos.y/v_myPos.w)       * step(v_myPos.x/v_myPos.w, u_baseColor.z)       * step(v_myPos.y/v_myPos.w, u_baseColor.w);   gl_FragColor = u_channelFlag * texture2D(s_texture0, v_texCoord).a * isInside;}",el="attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;uniform mat4       u_matrix;void main(){   gl_Position = u_matrix * a_position;   v_texCoord = a_texCoord;   v_texCoord.y = 1.0 - v_texCoord.y;}",Kn="attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;varying vec4       v_clipPos;uniform mat4       u_matrix;uniform mat4       u_clipMatrix;void main(){   gl_Position = u_matrix * a_position;   v_clipPos = u_clipMatrix * a_position;   v_texCoord = a_texCoord;   v_texCoord.y = 1.0 - v_texCoord.y;}",tl="precision mediump float;varying vec2       v_texCoord;uniform vec4       u_baseColor;uniform sampler2D  s_texture0;uniform vec4       u_multiplyColor;uniform vec4       u_screenColor;void main(){   vec4 texColor = texture2D(s_texture0, v_texCoord);   texColor.rgb = texColor.rgb * u_multiplyColor.rgb;   texColor.rgb = (texColor.rgb + u_screenColor.rgb * texColor.a) - (texColor.rgb * u_screenColor.rgb);   vec4 color = texColor * u_baseColor;   gl_FragColor = vec4(color.rgb, color.a);}",il="precision mediump float;varying vec2       v_texCoord;varying vec4       v_clipPos;uniform vec4       u_baseColor;uniform vec4       u_channelFlag;uniform sampler2D  s_texture0;uniform sampler2D  s_texture1;uniform vec4       u_multiplyColor;uniform vec4       u_screenColor;void main(){   vec4 texColor = texture2D(s_texture0, v_texCoord);   texColor.rgb = texColor.rgb * u_multiplyColor.rgb;   texColor.rgb = (texColor.rgb + u_screenColor.rgb * texColor.a) - (texColor.rgb * u_screenColor.rgb);   vec4 col_formask = texColor * u_baseColor;   vec4 clipMask = (1.0 - texture2D(s_texture1, v_clipPos.xy / v_clipPos.w)) * u_channelFlag;   float maskVal = clipMask.r + clipMask.g + clipMask.b + clipMask.a;   col_formask = col_formask * maskVal;   gl_FragColor = col_formask;}",sl="precision mediump float;varying vec2      v_texCoord;varying vec4      v_clipPos;uniform sampler2D s_texture0;uniform sampler2D s_texture1;uniform vec4      u_channelFlag;uniform vec4      u_baseColor;uniform vec4      u_multiplyColor;uniform vec4      u_screenColor;void main(){   vec4 texColor = texture2D(s_texture0, v_texCoord);   texColor.rgb = texColor.rgb * u_multiplyColor.rgb;   texColor.rgb = (texColor.rgb + u_screenColor.rgb * texColor.a) - (texColor.rgb * u_screenColor.rgb);   vec4 col_formask = texColor * u_baseColor;   vec4 clipMask = (1.0 - texture2D(s_texture1, v_clipPos.xy / v_clipPos.w)) * u_channelFlag;   float maskVal = clipMask.r + clipMask.g + clipMask.b + clipMask.a;   col_formask = col_formask * (1.0 - maskVal);   gl_FragColor = col_formask;}";class js extends ne{initialize(e,t=1){e.isUsingMasking()&&(this._clippingManager=new Us,this._clippingManager.initialize(e,e.getDrawableCount(),e.getDrawableMasks(),e.getDrawableMaskCounts(),t)),this._sortedDrawableIndexList.resize(e.getDrawableCount(),0),super.initialize(e)}bindTexture(e,t){this._textures.setValue(e,t)}getBindedTextures(){return this._textures}setClippingMaskBufferSize(e){if(!this._model.isUsingMasking())return;const t=this._clippingManager.getRenderTextureCount();this._clippingManager.release(),this._clippingManager=void 0,this._clippingManager=null,this._clippingManager=new Us,this._clippingManager.setClippingMaskBufferSize(e),this._clippingManager.initialize(this.getModel(),this.getModel().getDrawableCount(),this.getModel().getDrawableMasks(),this.getModel().getDrawableMaskCounts(),t)}getClippingMaskBufferSize(){return this._model.isUsingMasking()?this._clippingManager.getClippingMaskBufferSize():-1}getRenderTextureCount(){return this._model.isUsingMasking()?this._clippingManager.getRenderTextureCount():-1}constructor(){super(),this._clippingContextBufferForMask=null,this._clippingContextBufferForDraw=null,this._rendererProfile=new Jo,this.firstDraw=!0,this._textures=new Ee,this._sortedDrawableIndexList=new S,this._bufferData={vertex:WebGLBuffer=null,uv:WebGLBuffer=null,index:WebGLBuffer=null},this._textures.prepareCapacity(32,!0)}release(){this._clippingManager&&(this._clippingManager.release(),this._clippingManager=void 0,this._clippingManager=null),this.gl!=null&&(this.gl.deleteBuffer(this._bufferData.vertex),this._bufferData.vertex=null,this.gl.deleteBuffer(this._bufferData.uv),this._bufferData.uv=null,this.gl.deleteBuffer(this._bufferData.index),this._bufferData.index=null,this._bufferData=null,this._textures=null)}doDrawModel(){if(this.gl==null)return void Te(`'gl' is null. WebGLRenderingContext is required.
Please call 'CubimRenderer_WebGL.startUp' function.`);this._clippingManager!=null&&(this.preDraw(),this._clippingManager.setupClippingContext(this.getModel(),this)),this.preDraw();const e=this.getModel().getDrawableCount(),t=this.getModel().getDrawableRenderOrders();for(let s=0;s<e;++s){const a=t[s];this._sortedDrawableIndexList.set(a,s)}for(let s=0;s<e;++s){const a=this._sortedDrawableIndexList.at(s);if(!this.getModel().getDrawableDynamicFlagIsVisible(a))continue;const l=this._clippingManager!=null?this._clippingManager.getClippingContextListForDraw().at(a):null;if(l!=null&&this.isUsingHighPrecisionMask()){l._isUsing&&(this.gl.viewport(0,0,this._clippingManager.getClippingMaskBufferSize(),this._clippingManager.getClippingMaskBufferSize()),this.preDraw(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,l.getClippingManager().getMaskRenderTexture().at(l._bufferIndex)),this.gl.clearColor(1,1,1,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT));{const g=l._clippingIdCount;for(let c=0;c<g;c++){const f=l._clippingIdList[c];this._model.getDrawableDynamicFlagVertexPositionsDidChange(f)&&(this.setIsCulling(this._model.getDrawableCulling(f)!=0),this.setClippingContextBufferForMask(l),this.drawMesh(this.getModel().getDrawableTextureIndex(f),this.getModel().getDrawableVertexIndexCount(f),this.getModel().getDrawableVertexCount(f),this.getModel().getDrawableVertexIndices(f),this.getModel().getDrawableVertices(f),this.getModel().getDrawableVertexUvs(f),this.getModel().getMultiplyColor(f),this.getModel().getScreenColor(f),this.getModel().getDrawableOpacity(f),d.CubismBlendMode_Normal,!1))}}this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,ss),this.setClippingContextBufferForMask(null),this.gl.viewport(Mt[0],Mt[1],Mt[2],Mt[3]),this.preDraw()}this.setClippingContextBufferForDraw(l),this.setIsCulling(this.getModel().getDrawableCulling(a)),this.drawMesh(this.getModel().getDrawableTextureIndex(a),this.getModel().getDrawableVertexIndexCount(a),this.getModel().getDrawableVertexCount(a),this.getModel().getDrawableVertexIndices(a),this.getModel().getDrawableVertices(a),this.getModel().getDrawableVertexUvs(a),this.getModel().getMultiplyColor(a),this.getModel().getScreenColor(a),this.getModel().getDrawableOpacity(a),this.getModel().getDrawableBlendMode(a),this.getModel().getDrawableInvertedMaskBit(a))}}drawMesh(e,t,s,a,l,g,c,f,y,p,I){this.isCulling()?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this.gl.frontFace(this.gl.CCW);const B=this.getModelColor();let M;this.getClippingContextBufferForMask()==null&&(B.A*=y,this.isPremultipliedAlpha()&&(B.R*=B.A,B.G*=B.A,B.B*=B.A)),M=this._textures.getValue(e)!=null?this._textures.getValue(e):null,ni.getInstance().setupShaderProgram(this,M,s,l,a,g,this._bufferData,y,p,B,c,f,this.isPremultipliedAlpha(),this.getMvpMatrix(),I),this.gl.drawElements(this.gl.TRIANGLES,t,this.gl.UNSIGNED_SHORT,0),this.gl.useProgram(null),this.setClippingContextBufferForDraw(null),this.setClippingContextBufferForMask(null)}saveProfile(){this._rendererProfile.save()}restoreProfile(){this._rendererProfile.restore()}static doStaticRelease(){ni.deleteInstance()}setRenderState(e,t){ss=e,Mt=t}preDraw(){if(this.firstDraw&&(this.firstDraw=!1),this.gl.disable(this.gl.SCISSOR_TEST),this.gl.disable(this.gl.STENCIL_TEST),this.gl.disable(this.gl.DEPTH_TEST),this.gl.frontFace(this.gl.CW),this.gl.enable(this.gl.BLEND),this.gl.colorMask(!0,!0,!0,!0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null),this.getAnisotropy()>0&&this._extension)for(let e=0;e<this._textures.getSize();++e)this.gl.bindTexture(this.gl.TEXTURE_2D,this._textures.getValue(e)),this.gl.texParameterf(this.gl.TEXTURE_2D,this._extension.TEXTURE_MAX_ANISOTROPY_EXT,this.getAnisotropy())}setClippingContextBufferForMask(e){this._clippingContextBufferForMask=e}getClippingContextBufferForMask(){return this._clippingContextBufferForMask}setClippingContextBufferForDraw(e){this._clippingContextBufferForDraw=e}getClippingContextBufferForDraw(){return this._clippingContextBufferForDraw}startUp(e){this.gl=e,this._clippingManager&&this._clippingManager.setGL(e),ni.getInstance().setGl(e),this._rendererProfile.setGl(e),this._extension=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")}}var Jn,Zn,Qn;ne.staticRelease=()=>{js.doStaticRelease()},function(n){n.CubismClippingContext=$n,n.CubismClippingManager_WebGL=Us,n.CubismRenderTextureResource=Wn,n.CubismRenderer_WebGL=js,n.CubismShaderSet=zs,n.CubismShader_WebGL=ni,n.ShaderNames=Yt}(Jn||(Jn={}));class ea{constructor(e=!1,t=new ce){this.isOverwritten=e,this.Color=t}}class ta{constructor(e=!1,t=new ce){this.isOverwritten=e,this.Color=t}}class rl{constructor(e=!1,t=!1){this.isOverwritten=e,this.isCulling=t}}class ia{update(){this._model.update(),this._model.drawables.resetDynamicFlags()}getPixelsPerUnit(){return this._model==null?0:this._model.canvasinfo.PixelsPerUnit}getCanvasWidth(){return this._model==null?0:this._model.canvasinfo.CanvasWidth/this._model.canvasinfo.PixelsPerUnit}getCanvasHeight(){return this._model==null?0:this._model.canvasinfo.CanvasHeight/this._model.canvasinfo.PixelsPerUnit}saveParameters(){const e=this._model.parameters.count,t=this._savedParameters.getSize();for(let s=0;s<e;++s)s<t?this._savedParameters.set(s,this._parameterValues[s]):this._savedParameters.pushBack(this._parameterValues[s])}getMultiplyColor(e){return this.getOverwriteFlagForModelMultiplyColors()||this.getOverwriteFlagForDrawableMultiplyColors(e)?this._userMultiplyColors.at(e).Color:this.getDrawableMultiplyColor(e)}getScreenColor(e){return this.getOverwriteFlagForModelScreenColors()||this.getOverwriteFlagForDrawableScreenColors(e)?this._userScreenColors.at(e).Color:this.getDrawableScreenColor(e)}setMultiplyColorByTextureColor(e,t){this.setMultiplyColorByRGBA(e,t.R,t.G,t.B,t.A)}setMultiplyColorByRGBA(e,t,s,a,l=1){this._userMultiplyColors.at(e).Color.R=t,this._userMultiplyColors.at(e).Color.G=s,this._userMultiplyColors.at(e).Color.B=a,this._userMultiplyColors.at(e).Color.A=l}setScreenColorByTextureColor(e,t){this.setScreenColorByRGBA(e,t.R,t.G,t.B,t.A)}setScreenColorByRGBA(e,t,s,a,l=1){this._userScreenColors.at(e).Color.R=t,this._userScreenColors.at(e).Color.G=s,this._userScreenColors.at(e).Color.B=a,this._userScreenColors.at(e).Color.A=l}getPartMultiplyColor(e){return this._userPartMultiplyColors.at(e).Color}getPartScreenColor(e){return this._userPartScreenColors.at(e).Color}setPartColor(e,t,s,a,l,g,c){if(g.at(e).Color.R=t,g.at(e).Color.G=s,g.at(e).Color.B=a,g.at(e).Color.A=l,g.at(e).isOverwritten)for(let f=0;f<this._partChildDrawables.at(e).getSize();++f){const y=this._partChildDrawables.at(e).at(f);c.at(y).Color.R=t,c.at(y).Color.G=s,c.at(y).Color.B=a,c.at(y).Color.A=l}}setPartMultiplyColorByTextureColor(e,t){this.setPartMultiplyColorByRGBA(e,t.R,t.G,t.B,t.A)}setPartMultiplyColorByRGBA(e,t,s,a,l){this.setPartColor(e,t,s,a,l,this._userPartMultiplyColors,this._userMultiplyColors)}setPartScreenColorByTextureColor(e,t){this.setPartScreenColorByRGBA(e,t.R,t.G,t.B,t.A)}setPartScreenColorByRGBA(e,t,s,a,l){this.setPartColor(e,t,s,a,l,this._userPartScreenColors,this._userScreenColors)}getOverwriteFlagForModelMultiplyColors(){return this._isOverwrittenModelMultiplyColors}getOverwriteFlagForModelScreenColors(){return this._isOverwrittenModelScreenColors}setOverwriteFlagForModelMultiplyColors(e){this._isOverwrittenModelMultiplyColors=e}setOverwriteFlagForModelScreenColors(e){this._isOverwrittenModelScreenColors=e}getOverwriteFlagForDrawableMultiplyColors(e){return this._userMultiplyColors.at(e).isOverwritten}getOverwriteFlagForDrawableScreenColors(e){return this._userScreenColors.at(e).isOverwritten}setOverwriteFlagForDrawableMultiplyColors(e,t){this._userMultiplyColors.at(e).isOverwritten=t}setOverwriteFlagForDrawableScreenColors(e,t){this._userScreenColors.at(e).isOverwritten=t}getOverwriteColorForPartMultiplyColors(e){return this._userPartMultiplyColors.at(e).isOverwritten}getOverwriteColorForPartScreenColors(e){return this._userPartScreenColors.at(e).isOverwritten}setOverwriteColorForPartColors(e,t,s,a){s.at(e).isOverwritten=t;for(let l=0;l<this._partChildDrawables.at(e).getSize();++l){const g=this._partChildDrawables.at(e).at(l);a.at(g).isOverwritten=t,t&&(a.at(g).Color.R=s.at(e).Color.R,a.at(g).Color.G=s.at(e).Color.G,a.at(g).Color.B=s.at(e).Color.B,a.at(g).Color.A=s.at(e).Color.A)}}setOverwriteColorForPartMultiplyColors(e,t){this._userPartMultiplyColors.at(e).isOverwritten=t,this.setOverwriteColorForPartColors(e,t,this._userPartMultiplyColors,this._userMultiplyColors)}setOverwriteColorForPartScreenColors(e,t){this._userPartScreenColors.at(e).isOverwritten=t,this.setOverwriteColorForPartColors(e,t,this._userPartScreenColors,this._userScreenColors)}getDrawableCulling(e){if(this.getOverwriteFlagForModelCullings()||this.getOverwriteFlagForDrawableCullings(e))return this._userCullings.at(e).isCulling;const t=this._model.drawables.constantFlags;return!Live2DCubismCore.Utils.hasIsDoubleSidedBit(t[e])}setDrawableCulling(e,t){this._userCullings.at(e).isCulling=t}getOverwriteFlagForModelCullings(){return this._isOverwrittenCullings}setOverwriteFlagForModelCullings(e){this._isOverwrittenCullings=e}getOverwriteFlagForDrawableCullings(e){return this._userCullings.at(e).isOverwritten}setOverwriteFlagForDrawableCullings(e,t){this._userCullings.at(e).isOverwritten=t}getModelOapcity(){return this._modelOpacity}setModelOapcity(e){this._modelOpacity=e}getModel(){return this._model}getPartIndex(e){let t;const s=this._model.parts.count;for(t=0;t<s;++t)if(e==this._partIds.at(t))return t;return this._notExistPartId.isExist(e)?this._notExistPartId.getValue(e):(t=s+this._notExistPartId.getSize(),this._notExistPartId.setValue(e,t),this._notExistPartOpacities.appendKey(t),t)}getPartId(e){const t=this._model.parts.ids[e];return _.getIdManager().getId(t)}getPartCount(){return this._model.parts.count}setPartOpacityByIndex(e,t){this._notExistPartOpacities.isExist(e)?this._notExistPartOpacities.setValue(e,t):(Se(0<=e&&e<this.getPartCount()),this._partOpacities[e]=t)}setPartOpacityById(e,t){const s=this.getPartIndex(e);s<0||this.setPartOpacityByIndex(s,t)}getPartOpacityByIndex(e){return this._notExistPartOpacities.isExist(e)?this._notExistPartOpacities.getValue(e):(Se(0<=e&&e<this.getPartCount()),this._partOpacities[e])}getPartOpacityById(e){const t=this.getPartIndex(e);return t<0?0:this.getPartOpacityByIndex(t)}getParameterIndex(e){let t;const s=this._model.parameters.count;for(t=0;t<s;++t)if(e==this._parameterIds.at(t))return t;return this._notExistParameterId.isExist(e)?this._notExistParameterId.getValue(e):(t=this._model.parameters.count+this._notExistParameterId.getSize(),this._notExistParameterId.setValue(e,t),this._notExistParameterValues.appendKey(t),t)}getParameterCount(){return this._model.parameters.count}getParameterType(e){return this._model.parameters.types[e]}getParameterMaximumValue(e){return this._model.parameters.maximumValues[e]}getParameterMinimumValue(e){return this._model.parameters.minimumValues[e]}getParameterDefaultValue(e){return this._model.parameters.defaultValues[e]}getParameterValueByIndex(e){return this._notExistParameterValues.isExist(e)?this._notExistParameterValues.getValue(e):(Se(0<=e&&e<this.getParameterCount()),this._parameterValues[e])}getParameterValueById(e){const t=this.getParameterIndex(e);return this.getParameterValueByIndex(t)}setParameterValueByIndex(e,t,s=1){this._notExistParameterValues.isExist(e)?this._notExistParameterValues.setValue(e,s==1?t:this._notExistParameterValues.getValue(e)*(1-s)+t*s):(Se(0<=e&&e<this.getParameterCount()),this._model.parameters.maximumValues[e]<t&&(t=this._model.parameters.maximumValues[e]),this._model.parameters.minimumValues[e]>t&&(t=this._model.parameters.minimumValues[e]),this._parameterValues[e]=s==1?t:this._parameterValues[e]=this._parameterValues[e]*(1-s)+t*s)}setParameterValueById(e,t,s=1){const a=this.getParameterIndex(e);this.setParameterValueByIndex(a,t,s)}addParameterValueByIndex(e,t,s=1){this.setParameterValueByIndex(e,this.getParameterValueByIndex(e)+t*s)}addParameterValueById(e,t,s=1){const a=this.getParameterIndex(e);this.addParameterValueByIndex(a,t,s)}multiplyParameterValueById(e,t,s=1){const a=this.getParameterIndex(e);this.multiplyParameterValueByIndex(a,t,s)}multiplyParameterValueByIndex(e,t,s=1){this.setParameterValueByIndex(e,this.getParameterValueByIndex(e)*(1+(t-1)*s))}getDrawableIndex(e){const t=this._model.drawables.count;for(let s=0;s<t;++s)if(this._drawableIds.at(s)==e)return s;return-1}getDrawableCount(){return this._model.drawables.count}getDrawableId(e){const t=this._model.drawables.ids;return _.getIdManager().getId(t[e])}getDrawableRenderOrders(){return this._model.drawables.renderOrders}getDrawableTextureIndices(e){return this.getDrawableTextureIndex(e)}getDrawableTextureIndex(e){return this._model.drawables.textureIndices[e]}getDrawableDynamicFlagVertexPositionsDidChange(e){const t=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasVertexPositionsDidChangeBit(t[e])}getDrawableVertexIndexCount(e){return this._model.drawables.indexCounts[e]}getDrawableVertexCount(e){return this._model.drawables.vertexCounts[e]}getDrawableVertices(e){return this.getDrawableVertexPositions(e)}getDrawableVertexIndices(e){return this._model.drawables.indices[e]}getDrawableVertexPositions(e){return this._model.drawables.vertexPositions[e]}getDrawableVertexUvs(e){return this._model.drawables.vertexUvs[e]}getDrawableOpacity(e){return this._model.drawables.opacities[e]}getDrawableMultiplyColor(e){const t=this._model.drawables.multiplyColors,s=4*e,a=new ce;return a.R=t[s],a.G=t[s+1],a.B=t[s+2],a.A=t[s+3],a}getDrawableScreenColor(e){const t=this._model.drawables.screenColors,s=4*e,a=new ce;return a.R=t[s],a.G=t[s+1],a.B=t[s+2],a.A=t[s+3],a}getDrawableParentPartIndex(e){return this._model.drawables.parentPartIndices[e]}getDrawableBlendMode(e){const t=this._model.drawables.constantFlags;return Live2DCubismCore.Utils.hasBlendAdditiveBit(t[e])?d.CubismBlendMode_Additive:Live2DCubismCore.Utils.hasBlendMultiplicativeBit(t[e])?d.CubismBlendMode_Multiplicative:d.CubismBlendMode_Normal}getDrawableInvertedMaskBit(e){const t=this._model.drawables.constantFlags;return Live2DCubismCore.Utils.hasIsInvertedMaskBit(t[e])}getDrawableMasks(){return this._model.drawables.masks}getDrawableMaskCounts(){return this._model.drawables.maskCounts}isUsingMasking(){for(let e=0;e<this._model.drawables.count;++e)if(!(this._model.drawables.maskCounts[e]<=0))return!0;return!1}getDrawableDynamicFlagIsVisible(e){const t=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasIsVisibleBit(t[e])}getDrawableDynamicFlagVisibilityDidChange(e){const t=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasVisibilityDidChangeBit(t[e])}getDrawableDynamicFlagOpacityDidChange(e){const t=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasOpacityDidChangeBit(t[e])}getDrawableDynamicFlagRenderOrderDidChange(e){const t=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasRenderOrderDidChangeBit(t[e])}getDrawableDynamicFlagBlendColorDidChange(e){const t=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasBlendColorDidChangeBit(t[e])}loadParameters(){let e=this._model.parameters.count;const t=this._savedParameters.getSize();e>t&&(e=t);for(let s=0;s<e;++s)this._parameterValues[s]=this._savedParameters.at(s)}initialize(){Se(this._model),this._parameterValues=this._model.parameters.values,this._partOpacities=this._model.parts.opacities,this._parameterMaximumValues=this._model.parameters.maximumValues,this._parameterMinimumValues=this._model.parameters.minimumValues;{const t=this._model.parameters.ids,s=this._model.parameters.count;this._parameterIds.prepareCapacity(s);for(let a=0;a<s;++a)this._parameterIds.pushBack(_.getIdManager().getId(t[a]))}const e=this._model.parts.count;{const t=this._model.parts.ids;this._partIds.prepareCapacity(e);for(let s=0;s<e;++s)this._partIds.pushBack(_.getIdManager().getId(t[s]));this._userPartMultiplyColors.prepareCapacity(e),this._userPartScreenColors.prepareCapacity(e),this._partChildDrawables.prepareCapacity(e)}{const t=this._model.drawables.ids,s=this._model.drawables.count;this._userMultiplyColors.prepareCapacity(s),this._userScreenColors.prepareCapacity(s),this._userCullings.prepareCapacity(s);const a=new rl(!1,!1);for(let l=0;l<e;++l){const g=new ce(1,1,1,1),c=new ce(0,0,0,1),f=new ta(!1,g),y=new ta(!1,c);this._userPartMultiplyColors.pushBack(f),this._userPartScreenColors.pushBack(y),this._partChildDrawables.pushBack(new S),this._partChildDrawables.at(l).prepareCapacity(s)}for(let l=0;l<s;++l){const g=new ce(1,1,1,1),c=new ce(0,0,0,1),f=new ea(!1,g),y=new ea(!1,c);this._drawableIds.pushBack(_.getIdManager().getId(t[l])),this._userMultiplyColors.pushBack(f),this._userScreenColors.pushBack(y),this._userCullings.pushBack(a);const p=this.getDrawableParentPartIndex(l);p>=0&&this._partChildDrawables.at(p).pushBack(l)}}}constructor(e){this._model=e,this._parameterValues=null,this._parameterMaximumValues=null,this._parameterMinimumValues=null,this._partOpacities=null,this._savedParameters=new S,this._parameterIds=new S,this._drawableIds=new S,this._partIds=new S,this._isOverwrittenModelMultiplyColors=!1,this._isOverwrittenModelScreenColors=!1,this._isOverwrittenCullings=!1,this._modelOpacity=1,this._userMultiplyColors=new S,this._userScreenColors=new S,this._userCullings=new S,this._userPartMultiplyColors=new S,this._userPartScreenColors=new S,this._partChildDrawables=new S,this._notExistPartId=new Ee,this._notExistParameterId=new Ee,this._notExistParameterValues=new Ee,this._notExistPartOpacities=new Ee}release(){this._model.release(),this._model=null}}(function(n){n.CubismModel=ia})(Zn||(Zn={}));class Ei{static create(e,t){let s=null;if(t&&!this.hasMocConsistency(e))return Te("Inconsistent MOC3."),s;const a=Live2DCubismCore.Moc.fromArrayBuffer(e);return a&&(s=new Ei(a),s._mocVersion=Live2DCubismCore.Version.csmGetMocVersion(a,e)),s}static delete(e){e._moc._release(),e._moc=null,e=null}createModel(){let e=null;const t=Live2DCubismCore.Model.fromMoc(this._moc);return t&&(e=new ia(t),e.initialize(),++this._modelCount),e}deleteModel(e){e!=null&&(e.release(),e=null,--this._modelCount)}constructor(e){this._moc=e,this._modelCount=0,this._mocVersion=0}release(){Se(this._modelCount==0),this._moc._release(),this._moc=null}getLatestMocVersion(){return Live2DCubismCore.Version.csmGetLatestMocVersion()}getMocVersion(){return this._mocVersion}static hasMocConsistency(e){return Live2DCubismCore.Moc.prototype.hasMocConsistency(e)===1}}(function(n){n.CubismMoc=Ei})(Qn||(Qn={}));const sa="Meta",Xs="UserData";class ra{constructor(e,t){this._json=de.create(e,t)}release(){de.delete(this._json)}getUserDataCount(){return this._json.getRoot().getValueByString(sa).getValueByString("UserDataCount").toInt()}getTotalUserDataSize(){return this._json.getRoot().getValueByString(sa).getValueByString("TotalUserDataSize").toInt()}getUserDataTargetType(e){return this._json.getRoot().getValueByString(Xs).getValueByIndex(e).getValueByString("Target").getRawString()}getUserDataId(e){return _.getIdManager().getId(this._json.getRoot().getValueByString(Xs).getValueByIndex(e).getValueByString("Id").getRawString())}getUserDataValue(e){return this._json.getRoot().getValueByString(Xs).getValueByIndex(e).getValueByString("Value").getRawString()}}var na,aa,oa;(function(n){n.CubismModelUserDataJson=ra})(na||(na={}));class la{}class Ri{static create(e,t){const s=new Ri;return s.parseUserData(e,t),s}static delete(e){e!=null&&(e.release(),e=null)}getArtMeshUserDatas(){return this._artMeshUserDataNode}parseUserData(e,t){let s=new ra(e,t);const a=_.getIdManager().getId("ArtMesh"),l=s.getUserDataCount();for(let g=0;g<l;g++){const c=new la;c.targetId=s.getUserDataId(g),c.targetType=_.getIdManager().getId(s.getUserDataTargetType(g)),c.value=new L(s.getUserDataValue(g)),this._userDataNodes.pushBack(c),c.targetType==a&&this._artMeshUserDataNode.pushBack(c)}s.release(),s=void 0}constructor(){this._userDataNodes=new S,this._artMeshUserDataNode=new S}release(){for(let e=0;e<this._userDataNodes.getSize();++e)this._userDataNodes.set(e,null);this._userDataNodes=null}}(function(n){n.CubismModelUserData=Ri,n.CubismModelUserDataNode=la})(aa||(aa={}));class rs{isInitialized(){return this._initialized}setInitialized(e){this._initialized=e}isUpdating(){return this._updating}setUpdating(e){this._updating=e}setDragging(e,t){this._dragManager.set(e,t)}setAcceleration(e,t,s){this._accelerationX=e,this._accelerationY=t,this._accelerationZ=s}getModelMatrix(){return this._modelMatrix}setOpacity(e){this._opacity=e}getOpacity(){return this._opacity}loadModel(e,t=!1){this._moc=Ei.create(e,t),this._moc!=null?(this._model=this._moc.createModel(),this._model!=null?(this._model.saveParameters(),this._modelMatrix=new on(this._model.getCanvasWidth(),this._model.getCanvasHeight())):Te("Failed to CreateModel().")):Te("Failed to CubismMoc.create().")}loadExpression(e,t,s){return Wi.create(e,t)}loadPose(e,t){this._pose=Mi.create(e,t)}loadUserData(e,t){this._modelUserData=Ri.create(e,t)}loadPhysics(e,t){this._physics=Ti.create(e,t)}isHit(e,t,s){const a=this._model.getDrawableIndex(e);if(a<0)return!1;const l=this._model.getDrawableVertexCount(a),g=this._model.getDrawableVertices(a);let c=g[0],f=g[0],y=g[1],p=g[1];for(let M=1;M<l;++M){const v=g[tt.vertexOffset+M*tt.vertexStep],O=g[tt.vertexOffset+M*tt.vertexStep+1];v<c&&(c=v),v>f&&(f=v),O<y&&(y=O),O>p&&(p=O)}const I=this._modelMatrix.invertTransformX(t),B=this._modelMatrix.invertTransformY(s);return c<=I&&I<=f&&y<=B&&B<=p}getModel(){return this._model}getRenderer(){return this._renderer}createRenderer(e=1){this._renderer&&this.deleteRenderer(),this._renderer=new js,this._renderer.initialize(this._model,e)}deleteRenderer(){this._renderer!=null&&(this._renderer.release(),this._renderer=null)}motionEventFired(e){K("{0}",e.s)}static cubismDefaultMotionEventCallback(e,t,s){s!=null&&s.motionEventFired(t)}constructor(){this.loadMotion=(e,t,s,a)=>Qi.create(e,t,a),this._moc=null,this._model=null,this._motionManager=null,this._expressionManager=null,this._eyeBlink=null,this._breath=null,this._modelMatrix=null,this._pose=null,this._dragManager=null,this._physics=null,this._modelUserData=null,this._initialized=!1,this._updating=!1,this._opacity=1,this._lipsync=!0,this._lastLipSyncValue=0,this._dragX=0,this._dragY=0,this._accelerationX=0,this._accelerationY=0,this._accelerationZ=0,this._mocConsistency=!1,this._debugMode=!1,this._renderer=null,this._motionManager=new As,this._motionManager.setEventCallback(rs.cubismDefaultMotionEventCallback,this),this._expressionManager=new As,this._dragManager=new ln}release(){this._motionManager!=null&&(this._motionManager.release(),this._motionManager=null),this._expressionManager!=null&&(this._expressionManager.release(),this._expressionManager=null),this._moc!=null&&(this._moc.deleteModel(this._model),this._moc.release(),this._moc=null),this._modelMatrix=null,Mi.delete(this._pose),zt.delete(this._eyeBlink),Bi.delete(this._breath),this._dragManager=null,Ti.delete(this._physics),Ri.delete(this._modelUserData),this.deleteRenderer()}}(function(n){n.CubismUserModel=rs})(oa||(oa={}));class me{static loadFileAsBytes(e,t){fetch(e).then(s=>s.arrayBuffer()).then(s=>t(s,s.byteLength))}static getDeltaTime(){return this.s_deltaTime}static updateTime(){this.s_currentFrame=Date.now(),this.s_deltaTime=(this.s_currentFrame-this.s_lastFrame)/1e3,this.s_lastFrame=this.s_currentFrame}static printMessage(e){console.log(e)}}me.lastUpdate=Date.now(),me.s_currentFrame=0,me.s_lastFrame=0,me.s_deltaTime=0;var ua=function(n,e,t,s){return new(t||(t=Promise))(function(a,l){function g(y){try{f(s.next(y))}catch(p){l(p)}}function c(y){try{f(s.throw(y))}catch(p){l(p)}}function f(y){var p;y.done?a(y.value):(p=y.value,p instanceof t?p:new t(function(I){I(p)})).then(g,c)}f((s=s.apply(n,e||[])).next())})};let ai=null;class Hs{static getInstance(){return ai==null&&(ai=new Hs),ai}static releaseInstance(){ai!=null&&(ai=void 0),ai=null}update(e){let t,s;if(this._pcmData==null||this._sampleOffset>=this._wavFileInfo._samplesPerChannel)return this._lastRms=0,!1;this._userTimeSeconds+=e,t=Math.floor(this._userTimeSeconds*this._wavFileInfo._samplingRate),t>this._wavFileInfo._samplesPerChannel&&(t=this._wavFileInfo._samplesPerChannel),s=0;for(let a=0;a<this._wavFileInfo._numberOfChannels;a++)for(let l=this._sampleOffset;l<t;l++){const g=this._pcmData[a][l];s+=g*g}return s=Math.sqrt(s/(this._wavFileInfo._numberOfChannels*(t-this._sampleOffset))),this._lastRms=s,this._sampleOffset=t,!0}start(e){this._sampleOffset=0,this._userTimeSeconds=0,this._lastRms=0,this.loadWavFile(e)}getRms(){return this._lastRms}loadWavFile(e){let t=!1;this._pcmData!=null&&this.releasePcmData();const s=()=>ua(this,void 0,void 0,function*(){return fetch(e).then(a=>a.arrayBuffer())});return ua(this,void 0,void 0,function*(){if(this._byteReader._fileByte=yield s(),this._byteReader._fileDataView=new DataView(this._byteReader._fileByte),this._byteReader._fileSize=this._byteReader._fileByte.byteLength,this._byteReader._readOffset=0,this._byteReader._fileByte==null||this._byteReader._fileSize<4)return!1;this._wavFileInfo._fileName=e;try{if(!this._byteReader.getCheckSignature("RIFF"))throw t=!1,new Error('Cannot find Signeture "RIFF".');if(this._byteReader.get32LittleEndian(),!this._byteReader.getCheckSignature("WAVE"))throw t=!1,new Error('Cannot find Signeture "WAVE".');if(!this._byteReader.getCheckSignature("fmt "))throw t=!1,new Error('Cannot find Signeture "fmt".');const a=this._byteReader.get32LittleEndian();if(this._byteReader.get16LittleEndian()!=1)throw t=!1,new Error("File is not linear PCM.");for(this._wavFileInfo._numberOfChannels=this._byteReader.get16LittleEndian(),this._wavFileInfo._samplingRate=this._byteReader.get32LittleEndian(),this._byteReader.get32LittleEndian(),this._byteReader.get16LittleEndian(),this._wavFileInfo._bitsPerSample=this._byteReader.get16LittleEndian(),a>16&&(this._byteReader._readOffset+=a-16);!this._byteReader.getCheckSignature("data")&&this._byteReader._readOffset<this._byteReader._fileSize;)this._byteReader._readOffset+=this._byteReader.get32LittleEndian()+4;if(this._byteReader._readOffset>=this._byteReader._fileSize)throw t=!1,new Error('Cannot find "data" Chunk.');{const l=this._byteReader.get32LittleEndian();this._wavFileInfo._samplesPerChannel=8*l/(this._wavFileInfo._bitsPerSample*this._wavFileInfo._numberOfChannels)}this._pcmData=new Array(this._wavFileInfo._numberOfChannels);for(let l=0;l<this._wavFileInfo._numberOfChannels;l++)this._pcmData[l]=new Float32Array(this._wavFileInfo._samplesPerChannel);for(let l=0;l<this._wavFileInfo._samplesPerChannel;l++)for(let g=0;g<this._wavFileInfo._numberOfChannels;g++)this._pcmData[g][l]=this.getPcmSample();t=!0}catch(a){console.log(a)}}),t}getPcmSample(){let e;switch(this._wavFileInfo._bitsPerSample){case 8:e=this._byteReader.get8()-128,e<<=24;break;case 16:e=this._byteReader.get16LittleEndian()<<16;break;case 24:e=this._byteReader.get24LittleEndian()<<8;break;default:e=0}return e/2147483647}releasePcmData(){for(let e=0;e<this._wavFileInfo._numberOfChannels;e++)delete this._pcmData[e];delete this._pcmData,this._pcmData=null}constructor(){this._loadFiletoBytes=(e,t)=>{this._byteReader._fileByte=e,this._byteReader._fileDataView=new DataView(this._byteReader._fileByte),this._byteReader._fileSize=t},this._pcmData=null,this._userTimeSeconds=0,this._lastRms=0,this._sampleOffset=0,this._wavFileInfo=new nl,this._byteReader=new al}}class nl{constructor(){this._fileName="",this._numberOfChannels=0,this._bitsPerSample=0,this._samplingRate=0,this._samplesPerChannel=0}}class al{constructor(){this._fileByte=null,this._fileDataView=null,this._fileSize=0,this._readOffset=0}get8(){const e=this._fileDataView.getUint8(this._readOffset);return this._readOffset++,e}get16LittleEndian(){const e=this._fileDataView.getUint8(this._readOffset+1)<<8|this._fileDataView.getUint8(this._readOffset);return this._readOffset+=2,e}get24LittleEndian(){const e=this._fileDataView.getUint8(this._readOffset+2)<<16|this._fileDataView.getUint8(this._readOffset+1)<<8|this._fileDataView.getUint8(this._readOffset);return this._readOffset+=3,e}get32LittleEndian(){const e=this._fileDataView.getUint8(this._readOffset+3)<<24|this._fileDataView.getUint8(this._readOffset+2)<<16|this._fileDataView.getUint8(this._readOffset+1)<<8|this._fileDataView.getUint8(this._readOffset);return this._readOffset+=4,e}getCheckSignature(e){const t=new Uint8Array(4),s=new TextEncoder().encode(e);if(e.length!=4)return!1;for(let a=0;a<4;a++)t[a]=this.get8();return t[0]==s[0]&&t[1]==s[1]&&t[2]==s[2]&&t[3]==s[3]}}var _e,ha=function(n,e,t,s){return new(t||(t=Promise))(function(a,l){function g(y){try{f(s.next(y))}catch(p){l(p)}}function c(y){try{f(s.throw(y))}catch(p){l(p)}}function f(y){var p;y.done?a(y.value):(p=y.value,p instanceof t?p:new t(function(I){I(p)})).then(g,c)}f((s=s.apply(n,e||[])).next())})};(function(n){n[n.LoadAssets=0]="LoadAssets",n[n.LoadModel=1]="LoadModel",n[n.WaitLoadModel=2]="WaitLoadModel",n[n.LoadExpression=3]="LoadExpression",n[n.WaitLoadExpression=4]="WaitLoadExpression",n[n.LoadPhysics=5]="LoadPhysics",n[n.WaitLoadPhysics=6]="WaitLoadPhysics",n[n.LoadPose=7]="LoadPose",n[n.WaitLoadPose=8]="WaitLoadPose",n[n.SetupEyeBlink=9]="SetupEyeBlink",n[n.SetupBreath=10]="SetupBreath",n[n.LoadUserData=11]="LoadUserData",n[n.WaitLoadUserData=12]="WaitLoadUserData",n[n.SetupEyeBlinkIds=13]="SetupEyeBlinkIds",n[n.SetupLipSyncIds=14]="SetupLipSyncIds",n[n.SetupLayout=15]="SetupLayout",n[n.LoadMotion=16]="LoadMotion",n[n.WaitLoadMotion=17]="WaitLoadMotion",n[n.CompleteInitialize=18]="CompleteInitialize",n[n.CompleteSetupModel=19]="CompleteSetupModel",n[n.LoadTexture=20]="LoadTexture",n[n.WaitLoadTexture=21]="WaitLoadTexture",n[n.CompleteSetup=22]="CompleteSetup"})(_e||(_e={}));class ol extends rs{loadAssets(e,t){return ha(this,void 0,void 0,function*(){this._modelHomeDir=e;const s=yield fetch(t),a=yield s.arrayBuffer(),l=new Jr(a,a.byteLength);this._state=_e.LoadModel,this.setupModel(l)})}setupModel(e){if(this._updating=!0,this._initialized=!1,this._modelSetting=e,this._modelSetting.getModelFileName()!=""){const B=this._modelSetting.getModelFileName();fetch(`${this._modelHomeDir}${B}`).then(M=>M.arrayBuffer()).then(M=>{this.loadModel(M,this._mocConsistency),this._state=_e.LoadExpression,t()}),this._state=_e.WaitLoadModel}else me.printMessage("Model data does not exist.");const t=()=>{if(this._modelSetting.getExpressionCount()>0){const B=this._modelSetting.getExpressionCount();for(let M=0;M<B;++M){const v=this._modelSetting.getExpressionName(M),O=this._modelSetting.getExpressionFileName(M);fetch(`${this._modelHomeDir}${O}`).then(k=>k.arrayBuffer()).then(k=>{const W=this.loadExpression(k,k.byteLength,v);this._expressions.getValue(v)!=null&&(si.delete(this._expressions.getValue(v)),this._expressions.setValue(v,null)),this._expressions.setValue(v,W),this._expressionCount++,this._expressionCount>=B&&(this._state=_e.LoadPhysics,s())})}this._state=_e.WaitLoadExpression}else this._state=_e.LoadPhysics,s()},s=()=>{if(this._modelSetting.getPhysicsFileName()!=""){const B=this._modelSetting.getPhysicsFileName();fetch(`${this._modelHomeDir}${B}`).then(M=>M.arrayBuffer()).then(M=>{this.loadPhysics(M,M.byteLength),this._state=_e.LoadPose,a()}),this._state=_e.WaitLoadPhysics}else this._state=_e.LoadPose,a()},a=()=>{if(this._modelSetting.getPoseFileName()!=""){const B=this._modelSetting.getPoseFileName();fetch(`${this._modelHomeDir}${B}`).then(M=>M.arrayBuffer()).then(M=>{this.loadPose(M,M.byteLength),this._state=_e.SetupEyeBlink,l()}),this._state=_e.WaitLoadPose}else this._state=_e.SetupEyeBlink,l()},l=()=>{this._modelSetting.getEyeBlinkParameterCount()>0&&(this._eyeBlink=zt.create(this._modelSetting),this._state=_e.SetupBreath),g()},g=()=>{this._breath=Bi.create();const B=new S;B.pushBack(new ii(this._idParamAngleX,0,15,6.5345,.5)),B.pushBack(new ii(this._idParamAngleY,0,8,3.5345,.5)),B.pushBack(new ii(this._idParamAngleZ,0,10,5.5345,.5)),B.pushBack(new ii(this._idParamBodyAngleX,0,4,15.5345,.5)),B.pushBack(new ii(_.getIdManager().getId(G.ParamBreath),.5,.5,3.2345,1)),this._breath.setParameters(B),this._state=_e.LoadUserData,c()},c=()=>{if(this._modelSetting.getUserDataFile()!=""){const B=this._modelSetting.getUserDataFile();fetch(`${this._modelHomeDir}${B}`).then(M=>M.arrayBuffer()).then(M=>{this.loadUserData(M,M.byteLength),this._state=_e.SetupEyeBlinkIds,f()}),this._state=_e.WaitLoadUserData}else this._state=_e.SetupEyeBlinkIds,f()},f=()=>{const B=this._modelSetting.getEyeBlinkParameterCount();for(let M=0;M<B;++M)this._eyeBlinkIds.pushBack(this._modelSetting.getEyeBlinkParameterId(M));this._state=_e.SetupLipSyncIds,y()},y=()=>{const B=this._modelSetting.getLipSyncParameterCount();for(let M=0;M<B;++M)this._lipSyncIds.pushBack(this._modelSetting.getLipSyncParameterId(M));this._state=_e.SetupLayout,p()},p=()=>{const B=new Ee;this._modelSetting!=null&&this._modelMatrix!=null?(this._modelSetting.getLayoutMap(B),this._modelMatrix.setupFromLayout(B),this._state=_e.LoadMotion,I()):Te("Failed to setupLayout().")},I=()=>{this._state=_e.WaitLoadMotion,this._model.saveParameters(),this._allMotionCount=0,this._motionCount=0;const B=[],M=this._modelSetting.getMotionGroupCount();for(let v=0;v<M;v++)B[v]=this._modelSetting.getMotionGroupName(v),this._allMotionCount+=this._modelSetting.getMotionCount(B[v]);for(let v=0;v<M;v++)this.preLoadMotionGroup(B[v]);M==0&&(this._state=_e.LoadTexture,this._motionManager.stopAllMotions(),this._updating=!1,this._initialized=!0,this.createRenderer(),this.setupTextures(),this.getRenderer().startUp(U))}}setupTextures(){if(this._state==_e.LoadTexture){const e=this._modelSetting.getTextureCount();for(let t=0;t<e;t++){if(this._modelSetting.getTextureFileName(t)==""){console.log("getTextureFileName null");continue}let s=this._modelSetting.getTextureFileName(t);s=this._modelHomeDir+s;const a=l=>{this.getRenderer().bindTexture(t,l.id),this._textureCount++,this._textureCount>=e&&(this._state=_e.CompleteSetup)};Pe.getInstance().getTextureManager().createTextureFromPngFile(s,!0,a),this.getRenderer().setIsPremultipliedAlpha(!0)}this._state=_e.WaitLoadTexture}}reloadRenderer(){this.deleteRenderer(),this.createRenderer(),this.setupTextures()}update(){if(this._state!=_e.CompleteSetup)return;const e=me.getDeltaTime();this._userTimeSeconds+=e,this._dragManager.update(e),this._dragX=this._dragManager.getX(),this._dragY=this._dragManager.getY();let t=!1;if(this._model.loadParameters(),this._motionManager.isFinished()?this.startRandomMotion(P.MotionGroupIdle,P.PriorityIdle):t=this._motionManager.updateMotion(this._model,e),this._model.saveParameters(),t||this._eyeBlink!=null&&this._eyeBlink.updateParameters(this._model,e),this._expressionManager!=null&&this._expressionManager.updateMotion(this._model,e),this._model.addParameterValueById(this._idParamAngleX,30*this._dragX),this._model.addParameterValueById(this._idParamAngleY,30*this._dragY),this._model.addParameterValueById(this._idParamAngleZ,this._dragX*this._dragY*-30),this._model.addParameterValueById(this._idParamBodyAngleX,10*this._dragX),this._model.addParameterValueById(this._idParamEyeBallX,this._dragX),this._model.addParameterValueById(this._idParamEyeBallY,this._dragY),this._breath!=null&&this._breath.updateParameters(this._model,e),this._physics!=null&&this._physics.evaluate(this._model,e),this._lipsync){let s=0;this._wavFileHandler.update(e),s=this._wavFileHandler.getRms();for(let a=0;a<this._lipSyncIds.getSize();++a)this._model.addParameterValueById(this._lipSyncIds.at(a),s,.8)}this._pose!=null&&this._pose.updateParameters(this._model,e),this._model.update()}startMotion(e,t,s,a){if(s==P.PriorityForce)this._motionManager.setReservePriority(s);else if(!this._motionManager.reserveMotion(s))return this._debugMode&&me.printMessage("[APP]can't start motion."),es;const l=this._modelSetting.getMotionFileName(e,t),g=`${e}_${t}`;let c=this._motions.getValue(g),f=!1;c==null?fetch(`${this._modelHomeDir}${l}`).then(p=>p.arrayBuffer()).then(p=>{c=this.loadMotion(p,p.byteLength,null,a);let I=this._modelSetting.getMotionFadeInTimeValue(e,t);I>=0&&c.setFadeInTime(I),I=this._modelSetting.getMotionFadeOutTimeValue(e,t),I>=0&&c.setFadeOutTime(I),c.setEffectIds(this._eyeBlinkIds,this._lipSyncIds),f=!0}):c.setFinishedMotionHandler(a);const y=this._modelSetting.getMotionSoundFileName(e,t);if(y.localeCompare("")!=0){let p=y;p=this._modelHomeDir+p,this._wavFileHandler.start(p)}return this._debugMode&&me.printMessage(`[APP]start motion: [${e}_${t}`),this._motionManager.startMotionPriority(c,f,s)}startRandomMotion(e,t,s){if(this._modelSetting.getMotionCount(e)==0)return es;const a=Math.floor(Math.random()*this._modelSetting.getMotionCount(e));return this.startMotion(e,a,t,s)}setExpression(e){const t=this._expressions.getValue(e);this._debugMode&&me.printMessage(`[APP]expression: [${e}]`),t!=null?this._expressionManager.startMotionPriority(t,!0,P.PriorityForce):this._debugMode&&me.printMessage(`[APP]expression[${e}] is null`)}setRandomExpression(){if(this._expressions.getSize()==0)return;const e=Math.floor(Math.random()*this._expressions.getSize()),t=this._expressions._keyValues[e].first;me.printMessage("set expression: "+t),this.setExpression(t)}motionEventFired(e){K("{0} is fired on LAppModel!!",e.s)}hitTest(e,t,s){if(this._opacity<1)return!1;const a=this._modelSetting.getHitAreasCount();for(let l=0;l<a;l++)if(this._modelSetting.getHitAreaName(l)==e){const g=this._modelSetting.getHitAreaId(l);return this.isHit(g,t,s)}return!1}preLoadMotionGroup(e){for(let t=0;t<this._modelSetting.getMotionCount(e);t++){const s=this._modelSetting.getMotionFileName(e,t),a=`${e}_${t}`;this._debugMode&&me.printMessage(`[APP]load motion: ${s} => [${a}]`),fetch(`${this._modelHomeDir}${s}`).then(l=>l.arrayBuffer()).then(l=>{const g=this.loadMotion(l,l.byteLength,a);let c=this._modelSetting.getMotionFadeInTimeValue(e,t);c>=0&&g.setFadeInTime(c),c=this._modelSetting.getMotionFadeOutTimeValue(e,t),c>=0&&g.setFadeOutTime(c),g.setEffectIds(this._eyeBlinkIds,this._lipSyncIds),this._motions.getValue(a)!=null&&si.delete(this._motions.getValue(a)),this._motions.setValue(a,g),this._motionCount++,this._motionCount>=this._allMotionCount&&(this._state=_e.LoadTexture,this._motionManager.stopAllMotions(),this._updating=!1,this._initialized=!0,this.createRenderer(),this.setupTextures(),this.getRenderer().startUp(U))})}}releaseMotions(){this._motions.clear()}releaseExpressions(){this._expressions.clear()}doDraw(){if(this._model==null)return;const e=[0,0,pe.width,pe.height];this.getRenderer().setRenderState(Gs,e),this.getRenderer().drawModel()}draw(e){this._model!=null&&this._state==_e.CompleteSetup&&(e.multiplyByMatrix(this._modelMatrix),this.getRenderer().setMvpMatrix(e),this.doDraw())}hasMocConsistencyFromFile(){return ha(this,void 0,void 0,function*(){if(Se(this._modelSetting.getModelFileName().localeCompare("")),this._modelSetting.getModelFileName()!=""){const e=this._modelSetting.getModelFileName(),t=yield fetch(`${this._modelHomeDir}${e}`),s=yield t.arrayBuffer();return this._consistency=Ei.hasMocConsistency(s),this._consistency?K("Consistent MOC3."):K("Inconsistent MOC3."),this._consistency}me.printMessage("Model data does not exist.")})}constructor(){super(),this._modelSetting=null,this._modelHomeDir=null,this._userTimeSeconds=0,this._eyeBlinkIds=new S,this._lipSyncIds=new S,this._motions=new Ee,this._expressions=new Ee,this._hitArea=new S,this._userArea=new S,this._idParamAngleX=_.getIdManager().getId(G.ParamAngleX),this._idParamAngleY=_.getIdManager().getId(G.ParamAngleY),this._idParamAngleZ=_.getIdManager().getId(G.ParamAngleZ),this._idParamEyeBallX=_.getIdManager().getId(G.ParamEyeBallX),this._idParamEyeBallY=_.getIdManager().getId(G.ParamEyeBallY),this._idParamBodyAngleX=_.getIdManager().getId(G.ParamBodyAngleX),this._mocConsistency=!0,this._state=_e.LoadAssets,this._expressionCount=0,this._textureCount=0,this._motionCount=0,this._allMotionCount=0,this._wavFileHandler=new Hs,this._consistency=!1}}let oi=null;class _t{static getInstance(){return oi==null&&(oi=new _t),oi}static releaseInstance(){oi!=null&&(oi=void 0),oi=null}getModel(e){return e<this._models.getSize()?this._models.at(e):null}get model(){return this.getModel(0)}releaseAllModel(){for(let e=0;e<this._models.getSize();e++)this._models.at(e).release(),this._models.set(e,null);this._models.clear()}onDrag(e,t){for(let s=0;s<this._models.getSize();s++){const a=this.getModel(s);a&&a.setDragging(e,t)}}onTap(e,t){me.printMessage(`[APP]tap point: {x: ${e.toFixed(2)} y: ${t.toFixed(2)}}`);for(let s=0;s<this._models.getSize();s++)this._models.at(s).hitTest(P.HitAreaNameHead,e,t)?(me.printMessage(`[APP]hit area: [${P.HitAreaNameHead}]`),this._models.at(s).setRandomExpression()):this._models.at(s).hitTest(P.HitAreaNameBody,e,t)&&(me.printMessage(`[APP]hit area: [${P.HitAreaNameBody}]`),this._models.at(s).startRandomMotion(P.MotionGroupTapBody,P.PriorityNormal,this._finishedMotion))}onUpdate(){const{width:e,height:t}=pe,s=this._models.getSize();for(let a=0;a<s;++a){const l=new ie,g=this.getModel(a);g.getModel()&&(g.getModel().getCanvasWidth()>1&&e<t?(g.getModelMatrix().setWidth(2),l.scale(1,e/t)):l.scale(t/e,1),this._viewMatrix!=null&&l.multiplyByMatrix(this._viewMatrix)),g.update(),g.draw(l)}}nextScene(){}getModelPath(e){if(!e.includes("/"))return".";const t=e.split("/");return t.pop(),t.join("/")+"/"}loadLive2dModel(){const e=P.ResourcesPath;if(!e.endsWith(".model3.json"))return void console.log("无法加载模型！模型资源路径的结尾必须是.model3.json！");const t=this.getModelPath(e);this.releaseAllModel(),this._models.pushBack(new ol),this._models.at(0).loadAssets(t,e)}setViewMatrix(e){for(let t=0;t<16;t++)this._viewMatrix.getArray()[t]=e.getArray()[t]}constructor(){this._finishedMotion=e=>{me.printMessage("Motion Finished:"),console.log(e)},this._viewMatrix=new ie,this._models=new S,this.loadLive2dModel()}}class ll{constructor(){this._textures=new S}release(){for(let e=this._textures.begin();e.notEqual(this._textures.end());e.preIncrement())U.deleteTexture(e.ptr().id);this._textures=null}createTextureFromPngFile(e,t,s){for(let l=this._textures.begin();l.notEqual(this._textures.end());l.preIncrement())if(l.ptr().fileName==e&&l.ptr().usePremultply==t)return l.ptr().img=new Image,l.ptr().img.onload=()=>s(l.ptr()),void(l.ptr().img.src=e);const a=new Image;a.onload=()=>{const l=U.createTexture();U.bindTexture(U.TEXTURE_2D,l),U.texParameteri(U.TEXTURE_2D,U.TEXTURE_MIN_FILTER,U.LINEAR_MIPMAP_LINEAR),U.texParameteri(U.TEXTURE_2D,U.TEXTURE_MAG_FILTER,U.LINEAR),t&&U.pixelStorei(U.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),U.texImage2D(U.TEXTURE_2D,0,U.RGBA,U.RGBA,U.UNSIGNED_BYTE,a),U.generateMipmap(U.TEXTURE_2D),U.bindTexture(U.TEXTURE_2D,null);const g=new ul;g!=null&&(g.fileName=e,g.width=a.width,g.height=a.height,g.id=l,g.img=a,g.usePremultply=t,this._textures.pushBack(g)),s(g)},a.src=e}releaseTextures(){for(let e=0;e<this._textures.getSize();e++)this._textures.set(e,null);this._textures.clear()}releaseTextureByTexture(e){for(let t=0;t<this._textures.getSize();t++)if(this._textures.at(t).id==e){this._textures.set(t,null),this._textures.remove(t);break}}releaseTextureByFilePath(e){for(let t=0;t<this._textures.getSize();t++)if(this._textures.at(t).fileName==e){this._textures.set(t,null),this._textures.remove(t);break}}}class ul{constructor(){this.id=null,this.width=0,this.height=0}}class ca extends ie{constructor(){super(),this._screenLeft=0,this._screenRight=0,this._screenTop=0,this._screenBottom=0,this._maxLeft=0,this._maxRight=0,this._maxTop=0,this._maxBottom=0,this._maxScale=0,this._minScale=0}adjustTranslate(e,t){this._tr[0]*this._maxLeft+(this._tr[12]+e)>this._screenLeft&&(e=this._screenLeft-this._tr[0]*this._maxLeft-this._tr[12]),this._tr[0]*this._maxRight+(this._tr[12]+e)<this._screenRight&&(e=this._screenRight-this._tr[0]*this._maxRight-this._tr[12]),this._tr[5]*this._maxTop+(this._tr[13]+t)<this._screenTop&&(t=this._screenTop-this._tr[5]*this._maxTop-this._tr[13]),this._tr[5]*this._maxBottom+(this._tr[13]+t)>this._screenBottom&&(t=this._screenBottom-this._tr[5]*this._maxBottom-this._tr[13]);const s=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,e,t,0,1]);ie.multiply(s,this._tr,this._tr)}adjustScale(e,t,s){const a=this.getMaxScale(),l=this.getMinScale(),g=s*this._tr[0];g<l?this._tr[0]>0&&(s=l/this._tr[0]):g>a&&this._tr[0]>0&&(s=a/this._tr[0]);const c=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,e,t,0,1]),f=new Float32Array([s,0,0,0,0,s,0,0,0,0,1,0,0,0,0,1]),y=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,-e,-t,0,1]);ie.multiply(y,this._tr,this._tr),ie.multiply(f,this._tr,this._tr),ie.multiply(c,this._tr,this._tr)}setScreenRect(e,t,s,a){this._screenLeft=e,this._screenRight=t,this._screenBottom=s,this._screenTop=a}setMaxScreenRect(e,t,s,a){this._maxLeft=e,this._maxRight=t,this._maxTop=a,this._maxBottom=s}setMaxScale(e){this._maxScale=e}setMinScale(e){this._minScale=e}getMaxScale(){return this._maxScale}getMinScale(){return this._minScale}isMaxScale(){return this.getScaleX()>=this._maxScale}isMinScale(){return this.getScaleX()<=this._minScale}getScreenLeft(){return this._screenLeft}getScreenRight(){return this._screenRight}getScreenBottom(){return this._screenBottom}getScreenTop(){return this._screenTop}getMaxLeft(){return this._maxLeft}getMaxRight(){return this._maxRight}getMaxBottom(){return this._maxBottom}getMaxTop(){return this._maxTop}}var da;(function(n){n.CubismViewMatrix=ca})(da||(da={}));class hl{constructor(){this._startX=0,this._startY=0,this._lastX=0,this._lastY=0,this._lastX1=0,this._lastY1=0,this._lastX2=0,this._lastY2=0,this._lastTouchDistance=0,this._deltaX=0,this._deltaY=0,this._scale=1,this._touchSingle=!1,this._flipAvailable=!1}getCenterX(){return this._lastX}getCenterY(){return this._lastY}getDeltaX(){return this._deltaX}getDeltaY(){return this._deltaY}getStartX(){return this._startX}getStartY(){return this._startY}getScale(){return this._scale}getX(){return this._lastX}getY(){return this._lastY}getX1(){return this._lastX1}getY1(){return this._lastY1}getX2(){return this._lastX2}getY2(){return this._lastY2}isSingleTouch(){return this._touchSingle}isFlickAvailable(){return this._flipAvailable}disableFlick(){this._flipAvailable=!1}touchesBegan(e,t){this._lastX=e,this._lastY=t,this._startX=e,this._startY=t,this._lastTouchDistance=-1,this._flipAvailable=!0,this._touchSingle=!0}touchesMoved(e,t){this._lastX=e,this._lastY=t,this._lastTouchDistance=-1,this._touchSingle=!0}getFlickDistance(){return this.calculateDistance(this._startX,this._startY,this._lastX,this._lastY)}calculateDistance(e,t,s,a){return Math.sqrt((e-s)*(e-s)+(t-a)*(t-a))}calculateMovingAmount(e,t){if(e>0!=t>0)return 0;const s=e>0?1:-1,a=Math.abs(e),l=Math.abs(t);return s*(a<l?a:l)}}class cl{constructor(){this._programId=null,this._touchManager=new hl,this._deviceToScreen=new ie,this._viewMatrix=new ca}initialize(){const{width:e,height:t}=pe,s=e/t,a=-s,l=s,g=P.ViewLogicalLeft,c=P.ViewLogicalRight;if(this._viewMatrix.setScreenRect(a,l,g,c),this._viewMatrix.scale(P.ViewScale,P.ViewScale),this._deviceToScreen.loadIdentity(),e>t){const f=Math.abs(l-a);this._deviceToScreen.scaleRelative(f/e,-f/e)}else{const f=Math.abs(c-g);this._deviceToScreen.scaleRelative(f/t,-f/t)}this._deviceToScreen.translateRelative(.5*-e,.5*-t),this._viewMatrix.setMaxScale(P.ViewMaxScale),this._viewMatrix.setMinScale(P.ViewMinScale),this._viewMatrix.setMaxScreenRect(P.ViewLogicalMaxLeft,P.ViewLogicalMaxRight,P.ViewLogicalMaxBottom,P.ViewLogicalMaxTop)}release(){this._viewMatrix=null,this._touchManager=null,this._deviceToScreen=null,U.deleteProgram(this._programId),this._programId=null}render(){U.useProgram(this._programId),U.flush();const e=_t.getInstance();e.setViewMatrix(this._viewMatrix),e.onUpdate()}initializeSprite(){pe.width,pe.height,Pe.getInstance().getTextureManager(),this._programId==null&&(this._programId=Pe.getInstance().createShader())}onTouchesBegan(e,t){this._touchManager.touchesBegan(e,t)}onTouchesMoved(e,t){const s=this.transformViewX(this._touchManager.getX()),a=this.transformViewY(this._touchManager.getY());this._touchManager.touchesMoved(e,t),_t.getInstance().onDrag(s,a)}onTouchesEnded(e,t){const s=_t.getInstance();s.onDrag(0,0);{const a=this._deviceToScreen.transformX(this._touchManager.getX()),l=this._deviceToScreen.transformY(this._touchManager.getY());s.onTap(a,l)}}transformViewX(e){const t=this._deviceToScreen.transformX(e);return this._viewMatrix.invertTransformX(t)}transformViewY(e){const t=this._deviceToScreen.transformY(e);return this._viewMatrix.invertTransformY(t)}transformScreenX(e){return this._deviceToScreen.transformX(e)}transformScreenY(e){return this._deviceToScreen.transformY(e)}}let Ys=null,Ze=null;class li{constructor(){this._messageBox=null}static getInstance(){return Ys==null&&(Ys=new li),Ys}getMessageBox(){return this._messageBox==null&&(this._messageBox=document.querySelector("#live2dMessageBox-content")),this._messageBox}initialize(e){return Ze=document.createElement("div"),Ze.id=P.MessageBoxId,Ze.style.position="fixed",Ze.style.padding="10px",Ze.style.zIndex="9999",Ze.style.display="flex",Ze.style.justifyContent="center",Ze.style.width=e.width+"px",Ze.style.height="20px",Ze.style.right="0",Ze.style.bottom=e.height+50+"px",Ze.innerHTML='<div id="live2dMessageBox-content"></div>',document.body.appendChild(Ze),this.hideMessageBox(),!0}setMessage(e,t=null){const s=this.getMessageBox();this.hideMessageBox(),s.textContent=e,document.querySelector("#"+P.MessageBoxId).style.bottom=500+s.offsetHeight+"px",this.revealMessageBox(),t!=null&&setTimeout(()=>{this.hideMessageBox()},t)}hideMessageBox(){const e=this.getMessageBox();e.classList.remove("live2dMessageBox-content-visible"),e.classList.add("live2dMessageBox-content-hidden")}revealMessageBox(){const e=this.getMessageBox();e.classList.remove("live2dMessageBox-content-hidden"),e.classList.add("live2dMessageBox-content-visible")}}let pe=null,Gt=null,U=null,Gs=null;class Pe{static getInstance(){return Gt==null&&(Gt=new Pe),Gt}static releaseInstance(){Gt!=null&&Gt.release(),Gt=null}initialize(){return pe=document.createElement("canvas"),pe.id=P.CanvasId,pe.style.position="fixed",pe.style.bottom="0",pe.style.right="0",pe.style.zIndex="9999",P.CanvasSize==="auto"?this._resizeCanvas():(pe.width=P.CanvasSize.width,pe.height=P.CanvasSize.height),U=pe.getContext("webgl")||pe.getContext("experimental-webgl"),U?(document.body.appendChild(pe),li.getInstance().initialize(pe),Gs||(Gs=U.getParameter(U.FRAMEBUFFER_BINDING)),U.enable(U.BLEND),U.blendFunc(U.SRC_ALPHA,U.ONE_MINUS_SRC_ALPHA),U.clear(U.COLOR_BUFFER_BIT|U.DEPTH_BUFFER_BIT),"ontouchend"in pe?(pe.ontouchstart=fl,pe.ontouchmove=ml,pe.ontouchend=pl,pe.ontouchcancel=yl):(pe.onmousedown=dl,pe.onmousemove=gl,pe.onmouseup=_l),this._view.initialize(),this.initializeCubism(),!0):(console.log("Cannot initialize WebGL. This browser does not support."),U=null,!1)}onResize(){this._resizeCanvas(),this._view.initialize(),this._view.initializeSprite();const e=[0,0,pe.width,pe.height];U.viewport(e[0],e[1],e[2],e[3])}release(){this._textureManager.release(),this._textureManager=null,this._view.release(),this._view=null,_t.releaseInstance(),_.dispose()}run(){const e=()=>{Gt!=null&&(me.updateTime(),U.clearColor(...P.BackgroundRGBA),U.enable(U.DEPTH_TEST),U.depthFunc(U.LEQUAL),U.clear(U.COLOR_BUFFER_BIT|U.DEPTH_BUFFER_BIT),U.clearDepth(1),U.enable(U.BLEND),U.blendFunc(U.SRC_ALPHA,U.ONE_MINUS_SRC_ALPHA),this._view.render(),requestAnimationFrame(e))};e()}createShader(){const e=U.createShader(U.VERTEX_SHADER);if(e==null)return me.printMessage("failed to create vertexShader"),null;U.shaderSource(e,"precision mediump float;attribute vec3 position;attribute vec2 uv;varying vec2 vuv;void main(void){   gl_Position = vec4(position, 1.0);   vuv = uv;}"),U.compileShader(e);const t=U.createShader(U.FRAGMENT_SHADER);if(t==null)return me.printMessage("failed to create fragmentShader"),null;U.shaderSource(t,"precision mediump float;varying vec2 vuv;uniform sampler2D texture;void main(void){   gl_FragColor = texture2D(texture, vuv);}"),U.compileShader(t);const s=U.createProgram();return U.attachShader(s,e),U.attachShader(s,t),U.deleteShader(e),U.deleteShader(t),U.linkProgram(s),U.useProgram(s),s}getView(){return this._view}getTextureManager(){return this._textureManager}constructor(){this._captured=!1,this._mouseX=0,this._mouseY=0,this._isEnd=!1,this._cubismOption=new x,this._view=new cl,this._textureManager=new ll}initializeCubism(){this._cubismOption.logFunction=me.printMessage,this._cubismOption.loggingLevel=P.CubismLoggingLevel,_.startUp(this._cubismOption),_.initialize(),_t.getInstance(),me.updateTime()}_resizeCanvas(){pe.width=window.innerWidth,pe.height=window.innerHeight}}function dl(n){Pe.getInstance()._view?_t.getInstance().model.setRandomExpression():me.printMessage("view notfound")}function gl(n){const e=Pe.getInstance();if(!e._view)return void me.printMessage("view notfound");const t=n.target.getBoundingClientRect(),s=n.clientX-t.left,a=n.clientY-t.top;e._view.onTouchesMoved(s,a)}function _l(n){if(Pe.getInstance()._captured=!1,!Pe.getInstance()._view)return void me.printMessage("view notfound");const e=n.target.getBoundingClientRect(),t=n.clientX-e.left,s=n.clientY-e.top;Pe.getInstance()._view.onTouchesEnded(t,s)}function fl(n){me.printMessage("touch event happens");const e=Pe.getInstance();if(!e._view)return void me.printMessage("view notfound");const t=n.changedTouches[0].pageX,s=n.changedTouches[0].pageY;e._view.onTouchesBegan(t,s)}function ml(n){if(!Pe.getInstance()._captured)return;if(!Pe.getInstance()._view)return void me.printMessage("view notfound");const e=n.target.getBoundingClientRect(),t=n.changedTouches[0].clientX-e.left,s=n.changedTouches[0].clientY-e.top;Pe.getInstance()._view.onTouchesMoved(t,s)}function pl(n){if(Pe.getInstance()._captured=!1,!Pe.getInstance()._view)return void me.printMessage("view notfound");const e=n.target.getBoundingClientRect(),t=n.changedTouches[0].clientX-e.left,s=n.changedTouches[0].clientY-e.top;Pe.getInstance()._view.onTouchesEnded(t,s)}function yl(n){if(Pe.getInstance()._captured=!1,!Pe.getInstance()._view)return void me.printMessage("view notfound");const e=n.target.getBoundingClientRect(),t=n.changedTouches[0].clientX-e.left,s=n.changedTouches[0].clientY-e.top;Pe.getInstance()._view.onTouchesEnded(t,s)}var ga=function(n,e,t,s){return new(t||(t=Promise))(function(a,l){function g(y){try{f(s.next(y))}catch(p){l(p)}}function c(y){try{f(s.throw(y))}catch(p){l(p)}}function f(y){var p;y.done?a(y.value):(p=y.value,p instanceof t?p:new t(function(I){I(p)})).then(g,c)}f((s=s.apply(n,e||[])).next())})};function xl(n){const e=_t.getInstance();e&&e.model.setExpression(n)}function Sl(){const n=_t.getInstance();n&&n.model.setRandomExpression()}function Cl(n,e){li.getInstance().setMessage(n,e)}function bl(){li.getInstance().hideMessageBox()}function Bl(){li.getInstance().revealMessageBox()}function Ml(n){return ga(this,void 0,void 0,function*(){return n.CanvasId&&(P.CanvasId=n.CanvasId),n.CanvasSize&&(P.CanvasSize=n.CanvasSize),n.BackgroundRGBA&&(P.BackgroundRGBA=n.BackgroundRGBA),n.ResourcesPath&&(P.ResourcesPath=n.ResourcesPath),function(){return ga(this,void 0,void 0,function*(){const e=Pe.getInstance();return e.initialize()?void e.run():void console.log("初始化失败，退出")})}()})}window.onbeforeunload=()=>{const n=Pe.getInstance();n&&n.release()},window.onresize=()=>{const n=Pe.getInstance();n&&P.CanvasSize==="auto"&&n.onResize()},Fo.exports=b})();var Qh=Fo.exports;const ec={name:"App",components:{},setup(){xo(async()=>{await Qh.initializeLive2D({BackgroundRGBA:[0,0,0,0],ResourcesPath:"./fumo/Neurofumov1Blink.model3.json",CanvasSize:{height:256,width:256},CanvasId:"fumo"}),console.log("finish loading")})}},tc=(i,r)=>{const o=i.__vccOpts||i;for(const[u,h]of r)o[u]=h;return o};function ic(i,r,o,u,h,d){return null}const sc=tc(ec,[["render",ic]]);Jh(sc).mount("#app");
